<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous" defer></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"chengming0916.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.26.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.json","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="Chemmy&#39;s Blog">
<meta property="og:url" content="http://chengming0916.github.io/page/5/index.html">
<meta property="og:site_name" content="Chemmy&#39;s Blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Chemmy">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://chengming0916.github.io/page/5/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/5/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Chemmy's Blog</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>





  <script src="/js/third-party/pace.js" defer></script>


  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Chemmy's Blog</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">chengming0916@outlook.com</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Chemmy"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Chemmy</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">194</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">26</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">183</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/chengming0916" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;chengming0916" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/chengming0916@outlook.com" title="E-Mail → chengming0916@outlook.com" rel="noopener me"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chengming0916.github.io/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/YOLOv8%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%EF%BC%9A%E4%BD%BF%E7%94%A8ONNX%E6%A8%A1%E5%9E%8B%E8%BF%9B%E8%A1%8C%E6%8E%A8%E7%90%86_onnx%E6%A8%A1%E5%9E%8B%E6%8E%A8%E7%90%86-CSDN%E5%8D%9A%E5%AE%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Chemmy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/YOLOv8%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%EF%BC%9A%E4%BD%BF%E7%94%A8ONNX%E6%A8%A1%E5%9E%8B%E8%BF%9B%E8%A1%8C%E6%8E%A8%E7%90%86_onnx%E6%A8%A1%E5%9E%8B%E6%8E%A8%E7%90%86-CSDN%E5%8D%9A%E5%AE%A2/" class="post-title-link" itemprop="url">YOLOv8目标检测：使用ONNX模型进行推理</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-09-04 09:56:40" itemprop="dateCreated datePublished" datetime="2024-09-04T09:56:40+08:00">2024-09-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-04 16:58:11" itemprop="dateModified" datetime="2025-12-04T16:58:11+08:00">2025-12-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">编程技术</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/" itemprop="url" rel="index"><span itemprop="name">YOLOv8</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="YOLOv8目标检测：使用ONNX模型进行推理-onnx模型推理-CSDN博客"><a href="#YOLOv8目标检测：使用ONNX模型进行推理-onnx模型推理-CSDN博客" class="headerlink" title="YOLOv8目标检测：使用ONNX模型进行推理_onnx模型推理-CSDN博客"></a>YOLOv8目标检测：使用ONNX模型进行推理_onnx模型推理-CSDN博客</h1><blockquote>
<h2 id="Excerpt"><a href="#Excerpt" class="headerlink" title="Excerpt"></a>Excerpt</h2><p>文章浏览阅读8.2k次，点赞46次，收藏119次。本文详细介绍了如何在COCO数据集上使用YOLOv8目标检测模型进行推理，涉及环境配置、代码实现（包括图像、视频和摄像头检测），以及展示ONNX模型在不同大小版本（YOLOv8n,YOLOv8s,YOLOv8m,YOLOv8l,YOLOv8x）上的实验结果。</p>
</blockquote>
<hr>
<h2 id="基于COCO数据集的YOLOv8目标检测onnx模型推理"><a href="#基于COCO数据集的YOLOv8目标检测onnx模型推理" class="headerlink" title="基于COCO数据集的YOLOv8目标检测onnx模型推理"></a>基于COCO数据集的YOLOv8目标检测onnx模型推理</h2><p>在本博客中，我们将探讨如何使用YOLOv8目标检测模型进行推理，包括图片，视频文件，摄像头实时检测，特别是ONNX在不同大小（YOLOv8n, YOLOv8s, YOLOv8m, YOLOv8l, YOLOv8x）的模型上进行的实验。我们还将讨论所需的环境配置，代码实现，以及如何展示推理结果。</p>
<h3 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h3><p>在详细描述环境配置和安装步骤之前，请确保您的系统已经安装了Python和pip。下面是详细的环境配置步骤，适用于基于YOLOv8模型进行目标检测的项目。</p>
<h4 id="1-安装必要的Python库"><a href="#1-安装必要的Python库" class="headerlink" title="1. 安装必要的Python库"></a>1. 安装必要的Python库</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install onnxruntime-gpu==1.13.1 opencv-python==4.7.0.68 numpy==1.24.1 Pillow==9.4.0 -i https://pypi.tuna.tsinghua.edu.cn/simple/</span><br></pre></td></tr></table></figure>

<p>如果您没有GPU或者不打算使用GPU，可以安装<code>onnxruntime</code>而不是<code>onnxruntime-gpu</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install onnxruntime==1.13.1 opencv-python==4.7.0.68 numpy==1.24.1 Pillow==9.4.0 -i https://pypi.tuna.tsinghua.edu.cn/simple/</span><br></pre></td></tr></table></figure>

<h4 id="2-验证安装"><a href="#2-验证安装" class="headerlink" title="2. 验证安装"></a>2. 验证安装</h4><p>安装完成后，您可以通过运行Python并尝试导入安装的包来验证是否成功安装了所有必要的库：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> onnxruntime <span class="keyword">import</span> cv2 <span class="keyword">import</span> numpy <span class="keyword">import</span> PIL</span><br></pre></td></tr></table></figure>

<p>如果上述命令没有引发任何错误，那么恭喜您，您已成功配置了运行环境。</p>
<h4 id="小贴士"><a href="#小贴士" class="headerlink" title="小贴士"></a>小贴士</h4><ul>
<li>如果您在安装过程中遇到任何问题，可能需要更新pip到最新版本：<code>pip install --upgrade pip</code>。</li>
<li>对于使用NVIDIA GPU的用户，确保您的系统已安装CUDA和cuDNN。<code>onnxruntime-gpu</code>要求系统预装这些NVIDIA库以利用GPU加速。</li>
</ul>
<p>按照这些步骤，您应该能够成功配置环境并运行基于YOLOv8的目标检测项目了。</p>
<h3 id="权重下载"><a href="#权重下载" class="headerlink" title="权重下载"></a>权重下载</h3><p>YOLOv8模型的权重可以通过以下百度网盘链接下载：</p>
<ul>
<li>链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1xpAdN7C9CS-L4XBLgBG8Kw">https://pan.baidu.com/s/1xpAdN7C9CS-L4XBLgBG8Kw</a></li>
<li>提取码：8dm8</li>
</ul>
<p>请确保下载适合您需求的模型版本。</p>
<h3 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h3><p>以下是进行目标检测的整体代码流程，包括模型加载、图像预处理、推理执行、后处理及结果展示的步骤。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2 <span class="keyword">import</span> onnxruntime <span class="keyword">as</span> ort <span class="keyword">from</span> PIL <span class="keyword">import</span> Image <span class="keyword">import</span> numpy <span class="keyword">as</span> np <span class="comment"># 置信度 confidence_thres = 0.35 # iou阈值 iou_thres = 0.5 # 类别 classes = &#123;0: &#x27;person&#x27;, 1: &#x27;bicycle&#x27;, 2: &#x27;car&#x27;, 3: &#x27;motorcycle&#x27;, 4: &#x27;airplane&#x27;, 5: &#x27;bus&#x27;, 6: &#x27;train&#x27;, 7: &#x27;truck&#x27;, 8: &#x27;boat&#x27;, 9: &#x27;traffic light&#x27;, 10: &#x27;fire hydrant&#x27;, 11: &#x27;stop sign&#x27;, 12: &#x27;parking meter&#x27;, 13: &#x27;bench&#x27;, 14: &#x27;bird&#x27;, 15: &#x27;cat&#x27;, 16: &#x27;dog&#x27;, 17: &#x27;horse&#x27;, 18: &#x27;sheep&#x27;, 19: &#x27;cow&#x27;, 20: &#x27;elephant&#x27;, 21: &#x27;bear&#x27;, 22: &#x27;zebra&#x27;, 23: &#x27;giraffe&#x27;, 24: &#x27;backpack&#x27;, 25: &#x27;umbrella&#x27;, 26: &#x27;handbag&#x27;, 27: &#x27;tie&#x27;, 28: &#x27;suitcase&#x27;, 29: &#x27;frisbee&#x27;, 30: &#x27;skis&#x27;, 31: &#x27;snowboard&#x27;, 32: &#x27;sports ball&#x27;, 33: &#x27;kite&#x27;, 34: &#x27;baseball bat&#x27;, 35: &#x27;baseball glove&#x27;, 36: &#x27;skateboard&#x27;, 37: &#x27;surfboard&#x27;, 38: &#x27;tennis racket&#x27;, 39: &#x27;bottle&#x27;, 40: &#x27;wine glass&#x27;, 41: &#x27;cup&#x27;, 42: &#x27;fork&#x27;, 43: &#x27;knife&#x27;, 44: &#x27;spoon&#x27;, 45: &#x27;bowl&#x27;, 46: &#x27;banana&#x27;, 47: &#x27;apple&#x27;, 48: &#x27;sandwich&#x27;, 49: &#x27;orange&#x27;, 50: &#x27;broccoli&#x27;, 51: &#x27;carrot&#x27;, 52: &#x27;hot dog&#x27;, 53: &#x27;pizza&#x27;, 54: &#x27;donut&#x27;, 55: &#x27;cake&#x27;, 56: &#x27;chair&#x27;, 57: &#x27;couch&#x27;, 58: &#x27;potted plant&#x27;, 59: &#x27;bed&#x27;, 60: &#x27;dining table&#x27;, 61: &#x27;toilet&#x27;, 62: &#x27;tv&#x27;, 63: &#x27;laptop&#x27;, 64: &#x27;mouse&#x27;, 65: &#x27;remote&#x27;, 66: &#x27;keyboard&#x27;, 67: &#x27;cell phone&#x27;, 68: &#x27;microwave&#x27;, 69: &#x27;oven&#x27;, 70: &#x27;toaster&#x27;, 71: &#x27;sink&#x27;, 72: &#x27;refrigerator&#x27;, 73: &#x27;book&#x27;, 74: &#x27;clock&#x27;, 75: &#x27;vase&#x27;, 76: &#x27;scissors&#x27;, 77: &#x27;teddy bear&#x27;, 78: &#x27;hair drier&#x27;, 79: &#x27;toothbrush&#x27;&#125; # 随机颜色 color_palette = np.random.uniform(100, 255, size=(len(classes), 3)) # 判断是使用GPU或CPU providers = [ (&#x27;CUDAExecutionProvider&#x27;, &#123; &#x27;device_id&#x27;: 0, # 可以选择GPU设备ID，如果你有多个GPU &#125;), &#x27;CPUExecutionProvider&#x27;, # 也可以设置CPU作为备选 ] def calculate_iou(box, other_boxes): &quot;&quot;&quot; 计算给定边界框与一组其他边界框之间的交并比（IoU）。 参数： - box: 单个边界框，格式为 [x1, y1, width, height]。 - other_boxes: 其他边界框的数组，每个边界框的格式也为 [x1, y1, width, height]。 返回值： - iou: 一个数组，包含给定边界框与每个其他边界框的IoU值。 &quot;&quot;&quot; # 计算交集的左上角坐标 x1 = np.maximum(box[0], np.array(other_boxes)[:, 0]) y1 = np.maximum(box[1], np.array(other_boxes)[:, 1]) # 计算交集的右下角坐标 x2 = np.minimum(box[0] + box[2], np.array(other_boxes)[:, 0] + np.array(other_boxes)[:, 2]) y2 = np.minimum(box[1] + box[3], np.array(other_boxes)[:, 1] + np.array(other_boxes)[:, 3]) # 计算交集区域的面积 intersection_area = np.maximum(0, x2 - x1) * np.maximum(0, y2 - y1) # 计算给定边界框的面积 box_area = box[2] * box[3] # 计算其他边界框的面积 other_boxes_area = np.array(other_boxes)[:, 2] * np.array(other_boxes)[:, 3] # 计算IoU值 iou = intersection_area / (box_area + other_boxes_area - intersection_area) return iou def custom_NMSBoxes(boxes, scores, confidence_threshold, iou_threshold): # 如果没有边界框，则直接返回空列表 if len(boxes) == 0: return [] # 将得分和边界框转换为NumPy数组 scores = np.array(scores) boxes = np.array(boxes) # 根据置信度阈值过滤边界框 mask = scores &gt; confidence_threshold filtered_boxes = boxes[mask] filtered_scores = scores[mask] # 如果过滤后没有边界框，则返回空列表 if len(filtered_boxes) == 0: return [] # 根据置信度得分对边界框进行排序 sorted_indices = np.argsort(filtered_scores)[::-1] # 初始化一个空列表来存储选择的边界框索引 indices = [] # 当还有未处理的边界框时，循环继续 while len(sorted_indices) &gt; 0: # 选择得分最高的边界框索引 current_index = sorted_indices[0] indices.append(current_index) # 如果只剩一个边界框，则结束循环 if len(sorted_indices) == 1: break # 获取当前边界框和其他边界框 current_box = filtered_boxes[current_index] other_boxes = filtered_boxes[sorted_indices[1:]] # 计算当前边界框与其他边界框的IoU iou = calculate_iou(current_box, other_boxes) # 找到IoU低于阈值的边界框，即与当前边界框不重叠的边界框 non_overlapping_indices = np.where(iou &lt;= iou_threshold)[0] # 更新sorted_indices以仅包含不重叠的边界框 sorted_indices = sorted_indices[non_overlapping_indices + 1] # 返回选择的边界框索引 return indices def draw_detections(img, box, score, class_id): &quot;&quot;&quot; 在输入图像上绘制检测到的对象的边界框和标签。 参数: img: 要在其上绘制检测结果的输入图像。 box: 检测到的边界框。 score: 对应的检测得分。 class_id: 检测到的对象的类别ID。 返回: 无 &quot;&quot;&quot; # 提取边界框的坐标 x1, y1, w, h = box # 根据类别ID检索颜色 color = color_palette[class_id] # 在图像上绘制边界框 cv2.rectangle(img, (int(x1), int(y1)), (int(x1 + w), int(y1 + h)), color, 2) # 创建标签文本，包括类名和得分 label = f&#x27;&#123;classes[class_id]&#125;: &#123;score:.2f&#125;&#x27; # 计算标签文本的尺寸 (label_width, label_height), _ = cv2.getTextSize(label, cv2.FONT_HERSHEY_SIMPLEX, 0.5, 1) # 计算标签文本的位置 label_x = x1 label_y = y1 - 10 if y1 - 10 &gt; label_height else y1 + 10 # 绘制填充的矩形作为标签文本的背景 cv2.rectangle(img, (label_x, label_y - label_height), (label_x + label_width, label_y + label_height), color, cv2.FILLED) # 在图像上绘制标签文本 cv2.putText(img, label, (label_x, label_y), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 0, 0), 1, cv2.LINE_AA) def preprocess(img, input_width, input_height): &quot;&quot;&quot; 在执行推理之前预处理输入图像。 返回: image_data: 为推理准备好的预处理后的图像数据。 &quot;&quot;&quot; # 获取输入图像的高度和宽度 img_height, img_width = img.shape[:2] # 将图像颜色空间从BGR转换为RGB img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB) # 将图像大小调整为匹配输入形状 img = cv2.resize(img, (input_width, input_height)) # 通过除以255.0来归一化图像数据 image_data = np.array(img) / 255.0 # 转置图像，使通道维度为第一维 image_data = np.transpose(image_data, (2, 0, 1)) # 通道首 # 扩展图像数据的维度以匹配预期的输入形状 image_data = np.expand_dims(image_data, axis=0).astype(np.float32) # 返回预处理后的图像数据 return image_data, img_height, img_width def postprocess(input_image, output, input_width, input_height, img_width, img_height): &quot;&quot;&quot; 对模型输出进行后处理，提取边界框、得分和类别ID。 参数: input_image (numpy.ndarray): 输入图像。 output (numpy.ndarray): 模型的输出。 input_width (int): 模型输入宽度。 input_height (int): 模型输入高度。 img_width (int): 原始图像宽度。 img_height (int): 原始图像高度。 返回: numpy.ndarray: 绘制了检测结果的输入图像。 &quot;&quot;&quot; # 转置和压缩输出以匹配预期的形状 outputs = np.transpose(np.squeeze(output[0])) # 获取输出数组的行数 rows = outputs.shape[0] # 用于存储检测的边界框、得分和类别ID的列表 boxes = [] scores = [] class_ids = [] # 计算边界框坐标的缩放因子 x_factor = img_width / input_width y_factor = img_height / input_height # 遍历输出数组的每一行 for i in range(rows): # 从当前行提取类别得分 classes_scores = outputs[i][4:] # 找到类别得分中的最大得分 max_score = np.amax(classes_scores) # 如果最大得分高于置信度阈值 if max_score &gt;= confidence_thres: # 获取得分最高的类别ID class_id = np.argmax(classes_scores) # 从当前行提取边界框坐标 x, y, w, h = outputs[i][0], outputs[i][1], outputs[i][2], outputs[i][3] # 计算边界框的缩放坐标 left = int((x - w / 2) * x_factor) top = int((y - h / 2) * y_factor) width = int(w * x_factor) height = int(h * y_factor) # 将类别ID、得分和框坐标添加到各自的列表中 class_ids.append(class_id) scores.append(max_score) boxes.append([left, top, width, height]) # 应用非最大抑制过滤重叠的边界框 indices = custom_NMSBoxes(boxes, scores, confidence_thres, iou_thres) # 遍历非最大抑制后的选定索引 for i in indices: # 根据索引获取框、得分和类别ID box = boxes[i] score = scores[i] class_id = class_ids[i] # 在输入图像上绘制检测结果 draw_detections(input_image, box, score, class_id) # 返回修改后的输入图像 return input_image def init_detect_model(model_path): # 使用ONNX模型文件创建一个推理会话，并指定执行提供者 session = ort.InferenceSession(model_path, providers=providers) # 获取模型的输入信息 model_inputs = session.get_inputs() # 获取输入的形状，用于后续使用 input_shape = model_inputs[0].shape # 从输入形状中提取输入宽度 input_width = input_shape[2] # 从输入形状中提取输入高度 input_height = input_shape[3] # 返回会话、模型输入信息、输入宽度和输入高度 return session, model_inputs, input_width, input_height def detect_object(image, session, model_inputs, input_width, input_height): # 如果输入的图像是PIL图像对象，将其转换为NumPy数组 if isinstance(image, Image.Image): result_image = np.array(image) else: # 否则，直接使用输入的图像（假定已经是NumPy数组） result_image = image # 预处理图像数据，调整图像大小并可能进行归一化等操作 img_data, img_height, img_width = preprocess(result_image, input_width, input_height) # 使用预处理后的图像数据进行推理 outputs = session.run(None, &#123;model_inputs[0].name: img_data&#125;) # 对推理结果进行后处理，例如解码检测框，过滤低置信度的检测等 output_image = postprocess(result_image, outputs, input_width, input_height, img_width, img_height) # 返回处理后的图像 return output_image if __name__ == &#x27;__main__&#x27;: # 模型文件的路径 model_path = &quot;yolov8n.onnx&quot; # 初始化检测模型，加载模型并获取模型输入节点信息和输入图像的宽度、高度 session, model_inputs, input_width, input_height = init_detect_model(model_path) # 三种模式 1为图片预测，并显示结果图片；2为摄像头检测，并实时显示FPS； 3为视频检测，并保存结果视频 mode = 1 if mode == 1: # 读取图像文件 image_data = cv2.imread(&quot;street.jpg&quot;) # 使用检测模型对读入的图像进行对象检测 result_image = detect_object(image_data, session, model_inputs, input_width, input_height) # 将检测后的图像保存到文件 cv2.imwrite(&quot;output_image.jpg&quot;, result_image) # 在窗口中显示检测后的图像 cv2.imshow(&#x27;Output&#x27;, result_image) # 等待用户按键，然后关闭显示窗口 cv2.waitKey(0) elif mode == 2: # 打开摄像头 cap = cv2.VideoCapture() # 0表示默认摄像头，如果有多个摄像头可以尝试使用1、2等 # 检查摄像头是否成功打开 if not cap.isOpened(): print(&quot;Error: Could not open camera.&quot;) exit() # 初始化帧数计数器和起始时间 frame_count = 0 start_time = time.time() # 循环读取摄像头视频流 while True: # 读取一帧 ret, frame = cap.read() # 检查帧是否成功读取 if not ret: print(&quot;Error: Could not read frame.&quot;) break # 使用检测模型对读入的帧进行对象检测 output_image = detect_object(frame, session, model_inputs, input_width, input_height) # 计算帧速率 frame_count += 1 end_time = time.time() elapsed_time = end_time - start_time fps = frame_count / elapsed_time print(f&quot;FPS: &#123;fps:.2f&#125;&quot;) # 将FPS绘制在图像上 cv2.putText(output_image, f&quot;FPS: &#123;fps:.2f&#125;&quot;, (10, 30), cv2.FONT_HERSHEY_SIMPLEX, 1, (255, 255, 255), 2, cv2.LINE_AA) # 在窗口中显示当前帧 cv2.imshow(&quot;Video&quot;, output_image) # 按下 &#x27;q&#x27; 键退出循环 if cv2.waitKey(1) &amp; 0xFF == ord(&#x27;q&#x27;): break # 释放摄像头资源 cap.release() # 关闭窗口 cv2.destroyAllWindows() elif mode == 3: # 输入视频路径 input_video_path = &#x27;kun.mp4&#x27; # 输出视频路径 output_video_path = &#x27;kun_det.mp4&#x27; # 打开视频文件 cap = cv2.VideoCapture(input_video_path) # 检查视频是否成功打开 if not cap.isOpened(): print(&quot;Error: Could not open video.&quot;) exit() # 读取视频的基本信息 frame_width = int(cap.get(3)) frame_height = int(cap.get(4)) fps = cap.get(cv2.CAP_PROP_FPS) # 定义视频编码器和创建VideoWriter对象 fourcc = cv2.VideoWriter_fourcc(*&#x27;mp4v&#x27;) # 根据文件名后缀使用合适的编码器 out = cv2.VideoWriter(output_video_path, fourcc, fps, (frame_width, frame_height)) # 初始化帧数计数器和起始时间 frame_count = 0 start_time = time.time() while True: ret, frame = cap.read() if not ret: print(&quot;Info: End of video file.&quot;) break # 对读入的帧进行对象检测 output_image = detect_object(frame, session, model_inputs, input_width, input_height) # 计算并打印帧速率 frame_count += 1 end_time = time.time() elapsed_time = end_time - start_time if elapsed_time &gt; 0: fps = frame_count / elapsed_time print(f&quot;FPS: &#123;fps:.2f&#125;&quot;) # 将处理后的帧写入输出视频 out.write(output_image) #（可选）实时显示处理后的视频帧 cv2.imshow(&quot;Output Video&quot;, output_image) if cv2.waitKey(1) &amp; 0xFF == ord(&#x27;q&#x27;): break # 释放资源 cap.release() out.release() cv2.destroyAllWindows() else: print(&quot;输入错误，请检查mode的赋值&quot;)</span></span><br></pre></td></tr></table></figure>

<p>请根据您的需求调整置信度阈值、IOU阈值以及模型和mode的值（1为图片预测；2为摄像头检测； 3为视频检测）。</p>
<h3 id="结果展示"><a href="#结果展示" class="headerlink" title="结果展示"></a>结果展示</h3><p>推理完成后，您可以查看处理后的图像，如下所示：</p>
<ul>
<li><p>原始图片：<img src="/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/YOLOv8%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%EF%BC%9A%E4%BD%BF%E7%94%A8ONNX%E6%A8%A1%E5%9E%8B%E8%BF%9B%E8%A1%8C%E6%8E%A8%E7%90%86_onnx%E6%A8%A1%E5%9E%8B%E6%8E%A8%E7%90%86-CSDN%E5%8D%9A%E5%AE%A2/IMG-20250804110742712.jpeg" alt="待检测图片"></p>
</li>
<li><p>检测后的图片：<img src="/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/YOLOv8%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%EF%BC%9A%E4%BD%BF%E7%94%A8ONNX%E6%A8%A1%E5%9E%8B%E8%BF%9B%E8%A1%8C%E6%8E%A8%E7%90%86_onnx%E6%A8%A1%E5%9E%8B%E6%8E%A8%E7%90%86-CSDN%E5%8D%9A%E5%AE%A2/IMG-20250804110742889.jpeg" alt="检测后的图片"></p>
</li>
</ul>
<p>请替换为您自己的图像路径来查看效果；或者其他两种模式（摄像头实时检测、视频文件检测）进行尝试。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>通过以上步骤，我们展示了如何使用YOLOv8进行目标检测的完整流程，从环境配置到代码实现和结果展示。此过程适用于YOLOv8目标检测任意模型进行检测任务。</p>
<hr>
<p>希望这篇博客能够帮助您理解和实现基于YOLOv8的目标检测项目。如果有任何问题或需要进一步的帮助，请随时留言讨论。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chengming0916.github.io/2024/09/04/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/CSharp%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84%E6%AF%94%E8%BE%83/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Chemmy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/09/04/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/CSharp%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84%E6%AF%94%E8%BE%83/" class="post-title-link" itemprop="url">C#排序算法的比较</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-09-04 00:00:00" itemprop="dateCreated datePublished" datetime="2024-09-04T00:00:00+08:00">2024-09-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-04 16:58:11" itemprop="dateModified" datetime="2025-12-04T16:58:11+08:00">2025-12-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">排序算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="C-排序算法的比较"><a href="#C-排序算法的比较" class="headerlink" title="C#排序算法的比较"></a>C#排序算法的比较</h1><p><strong>首先通过图表比较不同排序算法的时间复杂度和稳定性。</strong></p>
<table><tbody><tr><td><p><strong>排序方法</strong></p></td><td><p><strong>平均时间</strong></p></td><td><p><strong>最坏情况</strong></p></td><td><p><strong>最好情况</strong></p></td><td><p><strong>辅助空间</strong></p></td><td><p><strong>稳定性</strong></p></td></tr><tr><td>直接插入排序</td><td><p>O(n<sup>2</sup>)</p></td><td><p>O(n<sup>2</sup>)</p></td><td><p>O(n)</p></td><td><p>O(1)</p></td><td>是</td></tr><tr><td>冒泡排序</td><td><p>O(n<sup>2</sup>)</p></td><td><p>O(n<sup>2</sup>)</p></td><td><p>O(n)</p></td><td><p>O(1)</p></td><td>是</td></tr><tr><td>简单选择排序</td><td><p>O(n<sup>2</sup>)</p></td><td><p>O(n<sup>2</sup>)</p></td><td><p>O(n<sup>2</sup>)</p></td><td><p>O(1)</p></td><td>是</td></tr><tr><td>希尔排序</td><td>-</td><td><p>O(nlog<sub>2</sub>n)~O(n<sup>2</sup>)</p></td><td><p>O(nlog<sub>2</sub>n)~O(n<sup>2</sup>)</p></td><td><p>O(1)</p></td><td>否</td></tr><tr><td>快速排序</td><td><p>O(nlog<sub>2</sub>n)</p></td><td><p>O(n<sup>2</sup>)</p></td><td><p>O(nlog<sub>2</sub>n)</p></td><td><p>O(log<sub>2</sub>n)</p></td><td>否</td></tr><tr><td>堆排序</td><td><p>O(nlog<sub>2</sub>n)</p></td><td><p>O(nlog<sub>2</sub>n)</p></td><td><p>O(nlog<sub>2</sub>n)</p></td><td><p>O(1)</p></td><td>否</td></tr><tr><td>2-路归并排序</td><td><p>O(nlog<sub>2</sub>n)</p></td><td><p>O(nlog<sub>2</sub>n)</p></td><td><p>O(nlog<sub>2</sub>n)</p></td><td><p>O(n)</p></td><td>是</td></tr><tr><td>基数排序</td><td>O(d(n + rd))</td><td>O(d(n + rd))</td><td>O(d(n + rd))</td><td>O(rd)</td><td>是</td></tr></tbody></table>

<p>注：1. 算法的时间复杂度一般情况下指最坏情况下的渐近时间复杂度。</p>
<p>        2. 排序算法的稳定性会对多关键字排序产生影响。</p>
<p><strong>下面通过C#代码说明不同的排序算法</strong></p>
<p><strong>插入排序</strong></p>
<p><strong>时间复杂度：平均情况—O(n<sup><span>2</span></sup>) 最坏情况—O(n<sup><span>2</span></sup>) 辅助空间：O(1) 稳定性：稳定</strong></p>
<p>插入排序是在一个已经有序的小序列的基础上，一次插入一个元素。当然，刚开始这个有序的小序列只有1个元素，就是第一个元素。比较是从有序序列的末尾开始，也就是想要插入的元素和已经有序的最大者开始比起，如果比它大则直接插入在其后面，否则一直往前找直到找到它该插入的位置。如果碰见一个和插入元素相等的，那么插入元素把想插入的元素放在相等元素的后面。所以，相等元素的前后顺序没有改变，从原无序序列出去的顺序就是排好序后的顺序，所以插入排序是稳定的。</p>
<p><strong>希尔排序(shell)</strong></p>
<p><strong>时间复杂度：理想情况—O(nlog<sub><span>2</span></sub>n) 最坏情况—O(n<sup><span>2</span></sup>) 稳定性：不稳定</strong></p>
<p>希尔排序是按照不同步长对元素进行插入排序，当刚开始元素很无序的时候，步长最大，所以插入排序的元素个数很少，速度很快；当元素基本有序了，步长很小，插入排序对于有序的序列效率很高。所以，希尔排序的时间复杂度会比o(n^2)好一些。由于多次插入排序，我们知道一次插入排序是稳定的，不会改变相同元素的相对顺序，但在不同的插入排序过程中，相同的元素可能在各自的插入排序中移动，最后其稳定性就会被打乱，所以shell排序是不稳定的。</p>
<p><strong>冒泡排序</strong></p>
<p><strong>时间复杂度：平均情况—O(n<sup><span>2</span></sup>) 最坏情况—O(n<sup><span>2</span></sup>) 辅助空间：O(1) 稳定性：稳定</strong></p>
<p>冒泡排序就是把小的元素往前调或者把大的元素往后调。比较是相邻的两个元素比较，交换也发生在这两个元素之间。所以，如果两个元素相等，我想你是不会再无聊地把他们俩交换一下的；如果两个相等的元素没有相邻，那么即使通过前面的两两交换把两个相邻起来，这时候也不会交换，所以相同元素的前后顺序并没有改变，所以冒泡排序是一种稳定排序算法。</p>
<p><strong>快速排序</strong></p>
<p><strong>时间复杂度：平均情况—O(nlog<sub><span>2</span></sub>n) 最坏情况—O(n<sup><span>2</span></sup>) 辅助空间：O(log<sub><span>2</span></sub>n) 稳定性：不稳定</strong></p>
<p>快速排序有两个方向，左边的i下标一直往右走，当a[i] &lt;&#x3D; a[center_index]，其中center_index是中枢元素的数组下标，一般取为数组第0个元素。而右边的j下标一直往左走，当a[j] &gt; a[center_index]。如果i和j都走不动了，i &lt;&#x3D; j, 交换a[i]和a[j],重复上面的过程，直到i&gt;j。 交换a[j]和a[center_index]，完成一趟快速排序。在中枢元素和a[j]交换的时候，很有可能把前面的元素的稳定性打乱，比如序列为 5 3 3 4 3 8 9 10 11， 现在中枢元素5和3(第5个元素，下标从1开始计)交换就会把元素3的稳定性打乱，所以快速排序是一个不稳定的排序算法，不稳定发生在中枢元素和a[j]交换的时刻。</p>
<p><strong>选择排序</strong></p>
<p><strong>时间复杂度：平均情况—O(n<sup><span>2</span></sup>) 最坏情况—O(n<sup><span>2</span></sup>) 辅助空间：O(1) 稳定性：不稳定</strong></p>
<p>选择排序是给每个位置选择当前元素最小的，比如给第一个位置选择最小的，在剩余元素里面给第二个元素选择第二小的，依次类推，直到第n-1个元素，第n个元素不用选择了，因为只剩下它一个最大的元素了。那么，在一趟选择，如果当前元素比一个元素小，而该小的元素又出现在一个和当前元素相等的元素后面，那么交换后稳定性就被破坏了。比较拗口，举个例子，序列5 8 5 2 9， 我们知道第一遍选择第1个元素5会和2交换，那么原序列中2个5的相对前后顺序就被破坏了，所以选择排序不是一个稳定的排序算法。</p>
<p><strong>堆排序</strong></p>
<p><strong>时间复杂度：平均情况—O(nlog<sub><span>2</span></sub>n) 最坏情况—O(nlog<sub><span>2</span></sub>n) 辅助空间：O(1) 稳定性：不稳定</strong></p>
<p>我们知道堆的结构是节点i的孩子为2*i和2*i+1节点，大顶堆要求父节点大于等于其2个子节点，小顶堆要求父节点小于等于其2个子节点。在一个长为n的序列，堆排序的过程是从第n&#x2F;2开始和其子节点共3个值选择最大(大顶堆)或者最小(小顶堆),这3个元素之间的选择当然不会破坏稳定性。但当为n&#x2F;2-1, n&#x2F;2-2, …1这些个父节点选择元素时，就会破坏稳定性。有可能第n&#x2F;2个父节点交换把后面一个元素交换过去了，而第n&#x2F;2-1个父节点把后面一个相同的元素没有交换，那么这2个相同的元素之间的稳定性就被破坏了。所以，堆排序不是稳定的排序算法</p>
<p><strong>归并排序</strong></p>
<p><strong>时间复杂度：平均情况—O(nlog<sub><span>2</span></sub>n) 最坏情况—O(nlog<sub><span>2</span></sub>n) 辅助空间：O(n) 稳定性：稳定</strong></p>
<p>归并排序是把序列递归地分成短序列，递归出口是短序列只有1个元素(认为直接有序)或者2个序列(1次比较和交换),然后把各个有序的段序列合并成一个有序的长序列，不断合并直到原序列全部排好序。可以发现，在1个或2个元素时，1个元素不会交换，2个元素如果大小相等也没有人故意交换，这不会破坏稳定性。那么，在短的有序序列合并的过程中，稳定是是否受到破坏？没有，合并过程中我们可以保证如果两个当前元素相等时，我们把处在前面的序列的元素保存在结果序列的前面，这样就保证了稳定性。所以，归并排序也是稳定的排序算法。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chengming0916.github.io/2024/09/04/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/CSharp%E7%BB%8F%E5%85%B8%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E5%A4%A7%E5%85%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Chemmy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/09/04/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/CSharp%E7%BB%8F%E5%85%B8%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E5%A4%A7%E5%85%A8/" class="post-title-link" itemprop="url">C#经典排序算法大全</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-09-04 00:00:00" itemprop="dateCreated datePublished" datetime="2024-09-04T00:00:00+08:00">2024-09-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-04 16:58:11" itemprop="dateModified" datetime="2025-12-04T16:58:11+08:00">2025-12-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">排序算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="C-经典排序算法大全"><a href="#C-经典排序算法大全" class="headerlink" title="C# 经典排序算法大全"></a>C# 经典排序算法大全</h1><blockquote>
<h2 id="Excerpt"><a href="#Excerpt" class="headerlink" title="Excerpt"></a>Excerpt</h2><p>文章浏览阅读84次。C# 经典排序算法大全选择排序using System;using System.Collections.Generic;using System.Linq;using System.Text;namespace sorter{    public class SelectionSorter    {        private int min;       …_c# case复杂排序</p>
</blockquote>
<hr>
<h2 id="C-经典排序算法大全-1"><a href="#C-经典排序算法大全-1" class="headerlink" title="C# 经典排序算法大全"></a>C# 经典排序算法大全</h2><h3 id="选择排序"><a href="#选择排序" class="headerlink" title="选择排序"></a>选择排序</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">sorter</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">SelectionSorter</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="built_in">int</span> min;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Sort</span>(<span class="params"><span class="built_in">int</span>[] arr</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; arr.Length - <span class="number">1</span>; ++i)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">min = i;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> j = i + <span class="number">1</span>; j &lt; arr.Length; ++j)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (arr[j] &lt; arr[min])</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">min = j;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> t = arr[min];</span><br><span class="line"></span><br><span class="line">arr[min] = arr[i];</span><br><span class="line"></span><br><span class="line">arr[i] = t;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>[] arrInt = <span class="keyword">new</span> <span class="built_in">int</span>[] &#123; <span class="number">4</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">6</span> &#125;;</span><br><span class="line"></span><br><span class="line">SelectionSorter selSor = <span class="keyword">new</span> SelectionSorter();</span><br><span class="line"></span><br><span class="line">selSor.Sort(arrInt);</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="built_in">int</span> i <span class="keyword">in</span> arrInt)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Console.WriteLine(i);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Console.ReadKey();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">sorter</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">EbullitionSorter</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Sort</span>(<span class="params"><span class="built_in">int</span>[] arr</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> i, j, temp;</span><br><span class="line"></span><br><span class="line"><span class="built_in">bool</span> done = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">j = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> ((j &lt; arr.Length) &amp;&amp; (!done))</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">done = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; arr.Length - j; i++)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (arr[i] &gt; arr[i + <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">done = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">temp = arr[i];</span><br><span class="line"></span><br><span class="line">arr[i] = arr[i + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">arr[i + <span class="number">1</span>] = temp;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">j++;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>[] arrInt = <span class="keyword">new</span> <span class="built_in">int</span>[] &#123; <span class="number">4</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">6</span> &#125;;</span><br><span class="line"></span><br><span class="line">EbullitionSorter selSor = <span class="keyword">new</span> EbullitionSorter();</span><br><span class="line"></span><br><span class="line">selSor.Sort(arrInt);</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="built_in">int</span> i <span class="keyword">in</span> arrInt)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Console.WriteLine(i);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Console.ReadKey();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="高速排序"><a href="#高速排序" class="headerlink" title="高速排序"></a>高速排序</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">sorter</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">QuickSorter</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">swap</span>(<span class="params"><span class="keyword">ref</span> <span class="built_in">int</span> l, <span class="keyword">ref</span> <span class="built_in">int</span> r</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> temp;</span><br><span class="line"></span><br><span class="line">temp = l;</span><br><span class="line"></span><br><span class="line">l = r;</span><br><span class="line"></span><br><span class="line">r = temp;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Sort</span>(<span class="params"><span class="built_in">int</span>[] list, <span class="built_in">int</span> low, <span class="built_in">int</span> high</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> pivot;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> l, r;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> mid;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (high &lt;= low)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (high == low + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (list[low] &gt; list[high])</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">swap(<span class="keyword">ref</span> list[low], <span class="keyword">ref</span> list[high]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mid = (low + high) &gt;&gt; <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">pivot = list[mid];</span><br><span class="line"></span><br><span class="line">swap(<span class="keyword">ref</span> list[low], <span class="keyword">ref</span> list[mid]);</span><br><span class="line"></span><br><span class="line">l = low + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">r = high;</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (l &lt;= r &amp;&amp; list[l] &lt; pivot)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">l++;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (list[r] &gt;= pivot)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">r--;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (l &lt; r)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">swap(<span class="keyword">ref</span> list[l], <span class="keyword">ref</span> list[r]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">while</span> (l &lt; r);</span><br><span class="line"></span><br><span class="line">list[low] = list[r];</span><br><span class="line"></span><br><span class="line">list[r] = pivot;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (low + <span class="number">1</span> &lt; r)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Sort(list, low, r - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (r + <span class="number">1</span> &lt; high)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Sort(list, r + <span class="number">1</span>, high);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>[] arrInt = <span class="keyword">new</span> <span class="built_in">int</span>[] &#123; <span class="number">4</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">6</span> &#125;;</span><br><span class="line"></span><br><span class="line">QuickSorter selSor = <span class="keyword">new</span> QuickSorter();</span><br><span class="line"></span><br><span class="line">selSor.Sort(arrInt, <span class="number">0</span>, arrInt.Length - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="built_in">int</span> i <span class="keyword">in</span> arrInt)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Console.WriteLine(i);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Console.ReadKey();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="插入排序"><a href="#插入排序" class="headerlink" title="插入排序"></a>插入排序</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">sorter</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">InsertionSorter</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Sort</span>(<span class="params"><span class="built_in">int</span>[] arr</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">1</span>; i &lt; arr.Length; i++)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> t = arr[i];</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> j = i;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> ((j &gt; <span class="number">0</span>) &amp;&amp; (arr[j - <span class="number">1</span>] &gt; t))</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">arr[j] = arr[j - <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">--j;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">arr[j] = t;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>[] arrInt = <span class="keyword">new</span> <span class="built_in">int</span>[] &#123; <span class="number">4</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">6</span> &#125;;</span><br><span class="line"></span><br><span class="line">InsertionSorter selSor = <span class="keyword">new</span> InsertionSorter();</span><br><span class="line"></span><br><span class="line">selSor.Sort(arrInt);</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="built_in">int</span> i <span class="keyword">in</span> arrInt)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Console.WriteLine(i);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Console.ReadKey();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="希尔排序"><a href="#希尔排序" class="headerlink" title="希尔排序"></a>希尔排序</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">sorter</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ShellSorter</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Sort</span>(<span class="params"><span class="built_in">int</span>[] arr</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> inc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (inc = <span class="number">1</span>; inc &lt;= arr.Length / <span class="number">9</span>; inc = <span class="number">3</span> * inc + <span class="number">1</span>) ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (; inc &gt; <span class="number">0</span>; inc /= <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = inc + <span class="number">1</span>; i &lt;= arr.Length; i += inc)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> t = arr[i - <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> j = i;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> ((j &gt; inc) &amp;&amp; (arr[j - inc - <span class="number">1</span>] &gt; t))</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">arr[j - <span class="number">1</span>] = arr[j - inc - <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">j -= inc;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">arr[j - <span class="number">1</span>] = t;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>[] arrInt = <span class="keyword">new</span> <span class="built_in">int</span>[] &#123; <span class="number">4</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">6</span> &#125;;</span><br><span class="line"></span><br><span class="line">ShellSorter selSor = <span class="keyword">new</span> ShellSorter();</span><br><span class="line"></span><br><span class="line">selSor.Sort(arrInt);</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="built_in">int</span> i <span class="keyword">in</span> arrInt)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Console.WriteLine(i);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Console.ReadKey();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="归并排序"><a href="#归并排序" class="headerlink" title="归并排序"></a>归并排序</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Merge</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Function</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="built_in">int</span> Groups;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="built_in">int</span> CopyGroups;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="built_in">int</span> mergerows;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="built_in">int</span>[] Array27;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> Random ran = <span class="keyword">new</span> Random();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Function</span>(<span class="params"><span class="built_in">int</span> length</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Array27 = <span class="keyword">new</span> <span class="built_in">int</span>[length];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; length; i++)</span><br><span class="line"></span><br><span class="line">Array27[i] = ran.Next(<span class="number">1</span>, <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ToMergeSort</span>()</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">MergeSort(Array27);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ToRecursiveMergeSort</span>()</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">RecursiveMergeSort(Array27, <span class="number">0</span>, Array27.Length - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ToNaturalMergeSort</span>()</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">NaturalMergeSort(Array27);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">RecursiveMergeSort</span>(<span class="params"><span class="built_in">int</span>[] Array, <span class="built_in">int</span> left, <span class="built_in">int</span> right</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> middle = (left + right) / <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (left &lt; right)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">RecursiveMergeSort(Array, left, middle);</span><br><span class="line"></span><br><span class="line">RecursiveMergeSort(Array, middle + <span class="number">1</span>, right);</span><br><span class="line"></span><br><span class="line">MergeOne(Array, left, middle, right);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">MergeOne</span>(<span class="params"><span class="built_in">int</span>[] Array, <span class="built_in">int</span> left, <span class="built_in">int</span> middle, <span class="built_in">int</span> right</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> leftindex = left;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> rightindex = middle + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>[] merge = <span class="keyword">new</span> <span class="built_in">int</span>[right + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> index = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (leftindex &lt;= middle &amp;&amp; rightindex &lt;= right)</span><br><span class="line"></span><br><span class="line">merge[index++] = (Array[leftindex] - Array[rightindex]) &gt;= <span class="number">0</span> ? Array[rightindex++] : Array[leftindex++];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (leftindex &lt;= middle)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = leftindex; i &lt;= middle; i++)</span><br><span class="line"></span><br><span class="line">merge[index++] = Array[i];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (rightindex &lt;= right)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = rightindex; i &lt;= right; i++)</span><br><span class="line"></span><br><span class="line">merge[index++] = Array[i];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">index = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = left; i &lt;= right; i++)</span><br><span class="line"></span><br><span class="line">Array[i] = merge[index++];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">MergeSort</span>(<span class="params"><span class="built_in">int</span>[] Array</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>[] merge = <span class="keyword">new</span> <span class="built_in">int</span>[Array.Length];</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> P = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> index = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> ENumb = (<span class="built_in">int</span>)Math.Pow(<span class="number">2</span>, P);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (ENumb &lt; Array.Length)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> TorFAndrightindex = index;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (TorFAndrightindex &lt;= Array.Length - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">MergeTwo(Array, merge, index, ENumb);</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">index += <span class="number">2</span> * ENumb;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">P++;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">MergeTwo</span>(<span class="params"><span class="built_in">int</span>[] Array, <span class="built_in">int</span>[] merge, <span class="built_in">int</span> index, <span class="built_in">int</span> ENumb</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> left = index;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> middle = left + ENumb - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (middle &gt;= Array.Length)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">middle = index;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> mergeindex = index;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> right;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> middleTwo = (index + ENumb - <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">right = index + ENumb + ENumb - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (right &gt;= Array.Length - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">right = Array.Length - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (left &lt;= middle &amp;&amp; middleTwo &lt;= right)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">merge[mergeindex++] = Array[left] &gt;= Array[middleTwo] ? Array[middleTwo++] : Array[left++];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (left &lt;= middle)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (left &lt;= middle &amp;&amp; mergeindex &lt; merge.Length)</span><br><span class="line"></span><br><span class="line">merge[mergeindex++] = Array[left++];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (middleTwo &lt;= right)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (middleTwo &lt;= right)</span><br><span class="line"></span><br><span class="line">merge[mergeindex++] = Array[middleTwo++];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (right + <span class="number">1</span> &gt;= Array.Length)</span><br><span class="line"></span><br><span class="line">Copy(Array, merge);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">NaturalMergeSort</span>(<span class="params"><span class="built_in">int</span>[] Array</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>[,] PointsSymbol = LinearPoints(Array);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (PointsSymbol[<span class="number">0</span>, <span class="number">1</span>] == Array.Length - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"></span><br><span class="line">NaturalMerge(Array, PointsSymbol);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">NaturalMerge</span>(<span class="params"><span class="built_in">int</span>[] Array, <span class="built_in">int</span>[,] PointsSymbol</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> left;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> right;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> leftend;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> rightend;</span><br><span class="line"></span><br><span class="line">mergerows = GNumberTwo(Groups);</span><br><span class="line"></span><br><span class="line">CopyGroups = Groups;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>[] TempArray = <span class="keyword">new</span> <span class="built_in">int</span>[Array.Length];</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>[,] TempPointsSymbol = <span class="keyword">new</span> <span class="built_in">int</span>[mergerows, <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> row = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (row != CopyGroups - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">left = PointsSymbol[row, <span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">leftend = PointsSymbol[row, <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">right = PointsSymbol[row + <span class="number">1</span>, <span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">rightend = PointsSymbol[row + <span class="number">1</span>, <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">MergeThree(Array, TempArray, left, leftend, right, rightend);</span><br><span class="line"></span><br><span class="line">MergePointSymbol(PointsSymbol, TempPointsSymbol, row);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">默认剩下的单独一个子数组已经虚拟合并。然后Copy进TempArray。</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> TempRow = PointsSymbol[row, <span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> TempCol = PointsSymbol[row, <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (TempRow &lt;= TempCol)</span><br><span class="line"></span><br><span class="line">TempArray[TempRow] = Array[TempRow++];</span><br><span class="line"></span><br><span class="line">TempPointsSymbol[row / <span class="number">2</span>, <span class="number">0</span>] = PointsSymbol[row, <span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">TempPointsSymbol[row / <span class="number">2</span>, <span class="number">1</span>] = PointsSymbol[row, <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">row += <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (TempPointsSymbol[<span class="number">0</span>, <span class="number">1</span>] == Array.Length - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (row &lt;= CopyGroups - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">Copy(Array, TempArray);</span><br><span class="line"></span><br><span class="line">UpdatePointSymbol(PointsSymbol, TempPointsSymbol, row);</span><br><span class="line"></span><br><span class="line">mergerows = GNumber(mergerows);</span><br><span class="line"></span><br><span class="line">CopyGroups = GNumberTwo(CopyGroups);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (PointsSymbol[<span class="number">0</span>, <span class="number">1</span>] == Array.Length - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">GNumber</span>(<span class="params"><span class="built_in">int</span> Value</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (Value % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">Value /= <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"></span><br><span class="line">Value -= <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> Value;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">GNumberTwo</span>(<span class="params"><span class="built_in">int</span> Value</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (Value % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">mergerows = Value / <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"></span><br><span class="line">mergerows = Value / <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> mergerows;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">MergeThree</span>(<span class="params"><span class="built_in">int</span>[] Array, <span class="built_in">int</span>[] Temp, <span class="built_in">int</span> left, <span class="built_in">int</span> leftend, <span class="built_in">int</span> right, <span class="built_in">int</span> rightend</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> index = left;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (left &lt;= leftend &amp;&amp; right &lt;= rightend)</span><br><span class="line"></span><br><span class="line">Temp[index++] = Array[left] &gt;= Array[right] ? Array[right++] : Array[left++];</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (left &lt;= leftend)</span><br><span class="line"></span><br><span class="line">Temp[index++] = Array[left++];</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (right &lt;= rightend)</span><br><span class="line"></span><br><span class="line">Temp[index++] = Array[right++];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">MergePointSymbol</span>(<span class="params"><span class="built_in">int</span>[,] PointsSymbol, <span class="built_in">int</span>[,] TempPointsSymbol, <span class="built_in">int</span> row</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> rowindex = row / <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">TempPointsSymbol[rowindex, <span class="number">0</span>] = PointsSymbol[row, <span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">TempPointsSymbol[rowindex, <span class="number">1</span>] = PointsSymbol[row + <span class="number">1</span>, <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">UpdatePointSymbol</span>(<span class="params"><span class="built_in">int</span>[,] PointsSymbol, <span class="built_in">int</span>[,] TempPointsSymbol, <span class="built_in">int</span> rows</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> row = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (; row &lt; TempPointsSymbol.GetLength(<span class="number">0</span>); row++)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> col = <span class="number">0</span>; col &lt; <span class="number">2</span>; col++)</span><br><span class="line"></span><br><span class="line">PointsSymbol[row, col] = TempPointsSymbol[row, col];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (; row &lt; PointsSymbol.GetLength(<span class="number">0</span>); row++)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> col2 = <span class="number">0</span>; col2 &lt; <span class="number">2</span>; col2++)</span><br><span class="line"></span><br><span class="line">PointsSymbol[row, col2] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">补剩下的index组，</span><br></pre></td></tr></table></figure>

<p>&#x2F;&#x2F; int row3 &#x3D; TempPointsSymbol.GetLength(0); &#x2F;&#x2F; PointsSymbol[row3, 0] &#x3D; PointsSymbol[rows, 0]; &#x2F;&#x2F; PointsSymbol[row3, 1] &#x3D; PointsSymbol[rows, 1]; &#x2F;&#x2F; &#x2F;&#x2F;后面的清零 &#x2F;&#x2F; for (int row4 &#x3D; row3 + 1; row4 &lt; PointsSymbol.GetLength(0); row4++) &#x2F;&#x2F; { &#x2F;&#x2F; for (int col4 &#x3D; 0; col4 &lt; 2; col4++) &#x2F;&#x2F; PointsSymbol[row4, col4] &#x3D; 0; &#x2F;&#x2F; } &#x2F;&#x2F;} } public int[,] LinearPoints(int[] Array) { Groups &#x3D; 1; int StartPoint &#x3D; 0; int row &#x3D; 0; int col &#x3D; 0; &#x2F;&#x2F;最糟糕的情况就是有Array.Length行。 int[,] PointsSet &#x3D; new int[Array.Length, 2]; &#x2F;&#x2F;线性扫描Array，划分数组 &#x2F;&#x2F;初始前index&#x3D;0 PointsSet[row, col] &#x3D; 0; do { &#x2F;&#x2F;推断升序子数组终于的index开关 bool Judge &#x3D; false; &#x2F;&#x2F;从Array第二个数推断是否要结束或者是否是升序子数组. while (++StartPoint &lt; Array.Length &amp;&amp; Array[StartPoint] &lt; Array[StartPoint - 1]) { &#x2F;&#x2F;打开第一个升序子数组结束的index开关 Judge &#x3D; true; &#x2F;&#x2F;又一次開始第二个升序子数组的前index PointsSet[row, col + 1] &#x3D; StartPoint - 1; &#x2F;&#x2F;计算子数组个数 Groups++; &#x2F;&#x2F;换行记录自然子数组的index row++; break; &#x2F;&#x2F;–StartPoint; } &#x2F;&#x2F;升序子数组结束index if (Judge) PointsSet[row, col] &#x3D; StartPoint; &#x2F;&#x2F;else &#x2F;&#x2F; –StartPoint; } while (StartPoint &lt; Array.Length); &#x2F;&#x2F;终于index&#x3D;StartPoint - 1，可是糟糕情况下还有剩余若干行为： 0,0 … PointsSet[row, col + 1] &#x3D; StartPoint - 1; &#x2F;&#x2F;调用展示方法 DisplaySubarray(Array, PointsSet, Groups); return PointsSet; } public void DisplaySubarray(int[] Array, int[,] PointsSet, int Groups) { Console.WriteLine(“Subarray is {0}:”, Groups); &#x2F;&#x2F;展示子数组的前后index for (int r &#x3D; 0; r &lt; Groups; r++) { for (int c &#x3D; 0; c &lt; PointsSet.GetLength(1); c++) { Console.Write(PointsSet[r, c]); if (c &lt; PointsSet.GetLength(1) - 1) Console.Write(“,”); } Console.Write(“\t\t”); } Console.WriteLine(); &#x2F;&#x2F;展示分出的子数组 for (int v &#x3D; 0; v &lt; Groups; v++) { int i &#x3D; 1; for (int r &#x3D; PointsSet[v, 0]; r &lt;&#x3D; PointsSet[v, 1]; r++) { Console.Write(Array[r] + “ “); i++; } if (i &lt;&#x3D; 3) Console.Write(“\t\t”); else Console.Write(“\t”); if (PointsSet[v, 1] &#x3D;&#x3D; Array.Length) break; } } public void Copy(int[] Array, int[] merge) { &#x2F;&#x2F;一部分排好序的元素替换掉原来Array中的元素 for (int i &#x3D; 0; i &lt; Array.Length; i++) { Array[i] &#x3D; merge[i]; } } &#x2F;&#x2F;输出 public override string ToString() { string temporary &#x3D; string.Empty; foreach (var element in Array27) temporary +&#x3D; element + “ “; temporary +&#x3D; “\n”; return temporary; } } class Program { static void Main(string[] args) { while (true) { Console.WriteLine(“请选择：”); Console.WriteLine(“1.归并排序（非递归）”); Console.WriteLine(“2.归并排序（递归）”); Console.WriteLine(“3.归并排序（自然合并）”); Console.WriteLine(“4.退出”); int Arraynum &#x3D; Convert.ToInt32(Console.ReadLine()); switch (Arraynum) { case 4: Environment.Exit(0); break; case 1: Console.WriteLine(“Please Input Array Length”); int Leng271 &#x3D; Convert.ToInt32(Console.ReadLine()); Function obj1 &#x3D; new Function(Leng271); Console.WriteLine(“The original sequence:”); Console.WriteLine(obj1); Console.WriteLine(“‘MergeSort’ Finaly Sorting Result:”); obj1.ToMergeSort(); Console.WriteLine(obj1); break; case 2: Console.WriteLine(“Please Input Array Length”); int Leng272 &#x3D; Convert.ToInt32(Console.ReadLine()); Function obj2 &#x3D; new Function(Leng272); Console.WriteLine(“The original sequence:”); Console.WriteLine(obj2); Console.WriteLine(“‘RecursiveMergeSort’ Finaly Sorting Result:”); obj2.ToRecursiveMergeSort(); Console.WriteLine(obj2); break; case 3: Console.WriteLine(“Please Input Array Length”); int Leng273 &#x3D; Convert.ToInt32(Console.ReadLine()); Function obj3 &#x3D; new Function(Leng273); Console.WriteLine(“The original sequence:”); Console.WriteLine(obj3); obj3.ToNaturalMergeSort(); Console.WriteLine(); Console.WriteLine(); Console.WriteLine(“‘NaturalMergeSort’ Finaly Sorting Result:”); Console.WriteLine(obj3); break; } } } } }</p>
<h3 id="基数排序"><a href="#基数排序" class="headerlink" title="基数排序"></a>基数排序</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Merge</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">RadixSorter</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">int</span>[] <span class="title">RadixSort</span>(<span class="params"><span class="built_in">int</span>[] ArrayToSort, <span class="built_in">int</span> digit</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> k = <span class="number">1</span>; k &lt;= digit; k++)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>[] tmpArray = <span class="keyword">new</span> <span class="built_in">int</span>[ArrayToSort.Length];</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>[] tmpCountingSortArray = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">10</span>] &#123; <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; ArrayToSort.Length; i++)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> tmpSplitDigit = ArrayToSort[i] / (<span class="built_in">int</span>)Math.Pow(<span class="number">10</span>, k - <span class="number">1</span>) - (ArrayToSort[i] / (<span class="built_in">int</span>)Math.Pow(<span class="number">10</span>, k)) * <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">tmpCountingSortArray[tmpSplitDigit] += <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> m = <span class="number">1</span>; m &lt; <span class="number">10</span>; m++)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">tmpCountingSortArray[m] += tmpCountingSortArray[m -</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> n = ArrayToSort.Length - <span class="number">1</span>; n &gt;= <span class="number">0</span>; n--)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> tmpSplitDigit = ArrayToSort[n] / (<span class="built_in">int</span>)Math.Pow(<span class="number">10</span>, k - <span class="number">1</span>) -</span><br><span class="line"></span><br><span class="line">(ArrayToSort[n] / (<span class="built_in">int</span>)Math.Pow(<span class="number">10</span>, k)) * <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">tmpArray[tmpCountingSortArray[tmpSplitDigit] - <span class="number">1</span>] = ArrayToSort</span><br><span class="line"></span><br><span class="line">[<span class="meta">n</span>];</span><br><span class="line"></span><br><span class="line">tmpCountingSortArray[tmpSplitDigit] -= <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> p = <span class="number">0</span>; p &lt; ArrayToSort.Length; p++)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">ArrayToSort[p] = tmpArray[p];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> ArrayToSort;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>[] intArray = <span class="keyword">new</span> <span class="built_in">int</span>[] &#123; <span class="number">5</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">6</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>[] newIntArray = intArray;</span><br><span class="line"></span><br><span class="line">RadixSorter rS=<span class="keyword">new</span> RadixSorter();</span><br><span class="line"></span><br><span class="line">newIntArray = rS.RadixSort(intArray, intArray.Length);</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="built_in">int</span> i <span class="keyword">in</span> intArray)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Console.Write(i + <span class="string">&quot; &quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Console.ReadKey();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="计数排序"><a href="#计数排序" class="headerlink" title="计数排序"></a>计数排序</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Merge</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br></pre></td></tr></table></figure>

<p>&#x2F;&#x2F;&#x2F; 要求: &#x2F;&#x2F;&#x2F; arrayToSort的元素必须大于等于0。或者经过一定的转换使其元素在 &#x2F;&#x2F;&#x2F; 大于等于0范围内。比如有例如以下序列(-1,-8,10,11),那么依据最小值8, &#x2F;&#x2F;&#x2F; 将各个数字加8转化为(7,0,18,19),然后进行计数排序。结果为(0,7,18,19), &#x2F;&#x2F;&#x2F; 然后再将结果个数字减8即为(-8,-1,10,11) &#x2F;&#x2F;&#x2F; </summary> &#x2F;&#x2F;&#x2F; <param name="arrayToSort">要排序的数组</param> &#x2F;&#x2F;&#x2F; <param name="maxValue">数组的最大值加一</param> &#x2F;&#x2F;&#x2F; <returns>计数排序后的结果</returns> public static int[] CountingSort(int[] arrayToSort, int k) { &#x2F;&#x2F; 排序后的结果存储 int[] sortedArray &#x3D; new int[arrayToSort.Length]; &#x2F;&#x2F; 计数数组 int[] countingArray &#x3D; new int[k]; &#x2F;&#x2F; 计数数组初始化 for (int i &#x3D; 0; i &lt; countingArray.Length; i++) { countingArray[i] &#x3D; 0; } &#x2F;&#x2F; 单个元素计数(经过该步骤countingArray[i]的含义为数字i的个数为countingArray[i]) for (int i &#x3D; 0; i &lt; arrayToSort.Length; i++) { countingArray[arrayToSort[i]] &#x3D; countingArray[arrayToSort[i]] + 1; } &#x2F;&#x2F; 计算小于等于某数的个数(经过该步骤countingArray[i]的含义为小于等于数字i的元素个数为countingArray[i]) for (int i &#x3D; 1; i &lt; countingArray.Length; i++) { countingArray[i] +&#x3D; countingArray[i - 1]; } &#x2F;&#x2F; 得到排序后的结果 for (int i &#x3D; 0; i &lt; sortedArray.Length; i++) { int numIndex &#x3D; countingArray[arrayToSort[i]] - 1; sortedArray[numIndex] &#x3D; arrayToSort[i]; countingArray[arrayToSort[i]] &#x3D; countingArray[arrayToSort[i]] - 1; } return sortedArray; } static void Main(string[] args) { int[] intArray &#x3D; new int[] { 5, 3, 7, 4, 8, 2, 9, 1, 0, 6 }; int[] intNewArray &#x3D; intArray; intNewArray &#x3D; CountingSort(intArray, intArray.Length); foreach (int i in intNewArray) { Console.Write(i + “ “); } Console.ReadKey(); } } }</p>
<h3 id="堆排序"><a href="#堆排序" class="headerlink" title="堆排序"></a>堆排序</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Merge</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">HeapSortFunction</span>(<span class="params"><span class="built_in">int</span>[] array</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">BuildMaxHeap(array);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = array.Length - <span class="number">1</span>; i &gt; <span class="number">0</span>; i--)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Swap(<span class="keyword">ref</span> array[<span class="number">0</span>], <span class="keyword">ref</span> array[i]);</span><br><span class="line"></span><br><span class="line">MaxHeapify(array, <span class="number">0</span>, i);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">catch</span> (Exception ex)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Console.Write(ex.Message);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">BuildMaxHeap</span>(<span class="params"><span class="built_in">int</span>[] array</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = array.Length / <span class="number">2</span> - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">MaxHeapify(array, i, array.Length);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">catch</span> (Exception ex)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Console.Write(ex.Message);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">MaxHeapify</span>(<span class="params"><span class="built_in">int</span>[] array, <span class="built_in">int</span> currentIndex, <span class="built_in">int</span> heapSize</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> left = <span class="number">2</span> * currentIndex + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> right = <span class="number">2</span> * currentIndex + <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> large = currentIndex;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (left &lt; heapSize &amp;&amp; array[left] &gt; array[large])</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">large = left;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (right &lt; heapSize &amp;&amp; array[right] &gt; array[large])</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">large = right;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (currentIndex != large)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Swap(<span class="keyword">ref</span> array[currentIndex], <span class="keyword">ref</span> array[large]);</span><br><span class="line"></span><br><span class="line">MaxHeapify(array, large, heapSize);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">catch</span> (Exception ex)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Console.Write(ex.Message);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Swap</span>(<span class="params"><span class="keyword">ref</span> <span class="built_in">int</span> a, <span class="keyword">ref</span> <span class="built_in">int</span> b</span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> temp = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">temp = a;</span><br><span class="line"></span><br><span class="line">a = b;</span><br><span class="line"></span><br><span class="line">b = temp;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>[] intArray = <span class="keyword">new</span> <span class="built_in">int</span>[] &#123; <span class="number">5</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">6</span> &#125;;</span><br><span class="line"></span><br><span class="line">HeapSortFunction(intArray);</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="built_in">int</span> i <span class="keyword">in</span> intArray)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Console.Write(i + <span class="string">&quot; &quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Console.ReadKey();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="排序的分类-稳定性-时间复杂度和空间复杂度总结"><a href="#排序的分类-稳定性-时间复杂度和空间复杂度总结" class="headerlink" title="排序的分类&#x2F;稳定性&#x2F;时间复杂度和空间复杂度总结"></a>排序的分类&#x2F;稳定性&#x2F;时间复杂度和空间复杂度总结</h3><p><img src="/2024/09/04/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/CSharp%E7%BB%8F%E5%85%B8%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E5%A4%A7%E5%85%A8/IMG-20250704185625088.png">  </p>
<p>版权声明：本文博客原创文章。博客，未经同意，不得转载。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chengming0916.github.io/2024/09/04/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95CSharp%E5%AE%9E%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Chemmy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/09/04/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95CSharp%E5%AE%9E%E7%8E%B0/" class="post-title-link" itemprop="url">冒泡排序算法CSharp实现</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-09-04 00:00:00" itemprop="dateCreated datePublished" datetime="2024-09-04T00:00:00+08:00">2024-09-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-04 16:58:11" itemprop="dateModified" datetime="2025-12-04T16:58:11+08:00">2025-12-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">排序算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="冒泡排序算法（C-实现）-Eric-Sun-博客园"><a href="#冒泡排序算法（C-实现）-Eric-Sun-博客园" class="headerlink" title="冒泡排序算法（C#实现） - Eric Sun - 博客园"></a>冒泡排序算法（C#实现） - Eric Sun - 博客园</h1><blockquote>
<h2 id="Excerpt"><a href="#Excerpt" class="headerlink" title="Excerpt"></a>Excerpt</h2><p>简单的冒泡排序算法，代码如下：&#x2F;&#x2F;冒泡排序（从数组的起始位置开始遍历，以大数为基准：大的数向下沉一位）privatestaticvoid BubbleSortFunction(int[] array) { try { int length &#x3D; array.Length; int temp; bool</p>
</blockquote>
<hr>
<p>简单的冒泡排序算法，代码如下：</p>
<p><img src="/2024/09/04/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95CSharp%E5%AE%9E%E7%8E%B0/IMG-20250704185625090.gif" alt="复制代码"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt;//&lt;/span&gt;&lt;span&gt;冒泡排序（从数组的起始位置开始遍历，以大数为基准：大的数向下沉一位）&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;private&lt;/span&gt;&lt;span&gt;static&lt;/span&gt;&lt;span&gt;void&lt;/span&gt;&lt;span&gt; BubbleSortFunction(&lt;/span&gt;&lt;span&gt;int&lt;/span&gt;&lt;span&gt;[] array)&lt;br&gt;        &#123;&lt;br&gt;            &lt;/span&gt;&lt;span&gt;try&lt;/span&gt;&lt;span&gt;&lt;br&gt;            &#123;&lt;br&gt;                &lt;/span&gt;&lt;span&gt;int&lt;/span&gt;&lt;span&gt; length &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; array.Length;&lt;br&gt;                &lt;/span&gt;&lt;span&gt;int&lt;/span&gt;&lt;span&gt; temp;&lt;br&gt;                &lt;/span&gt;&lt;span&gt;bool&lt;/span&gt;&lt;span&gt; hasExchangeAction; &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;记录此次大循环中相邻的两个数是否发生过互换（如果没有互换，则数组已经是有序的）&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;&lt;br&gt;                &lt;/span&gt;&lt;span&gt;for&lt;/span&gt;&lt;span&gt; (&lt;/span&gt;&lt;span&gt;int&lt;/span&gt;&lt;span&gt; i &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;; i &lt;/span&gt;&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt; length &lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;; i&lt;/span&gt;&lt;span&gt;++&lt;/span&gt;&lt;span&gt;)    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;数组有N个数，那么用N-1次大循环就可以排完&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;                &#123;&lt;br&gt;                    hasExchangeAction &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;false&lt;/span&gt;&lt;span&gt;;  &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;每次大循环都假设数组有序&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;&lt;br&gt;                    &lt;/span&gt;&lt;span&gt;for&lt;/span&gt;&lt;span&gt; (&lt;/span&gt;&lt;span&gt;int&lt;/span&gt;&lt;span&gt; j &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;; j &lt;/span&gt;&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt; length &lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt; i &lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;; j&lt;/span&gt;&lt;span&gt;++&lt;/span&gt;&lt;span&gt;)    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;从数组下标0处开始遍历，（length - i - 1 是刨除已经排好的大数）&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;                    &#123;&lt;br&gt;                        &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; (array[j] &lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;span&gt; array[j &lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;])    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;相邻两个数进行比较，如果前面的数大于后面的数，则将这相邻的两个数进行互换&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;                        &#123;&lt;br&gt;                            temp &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; array[j];&lt;br&gt;                            array[j] &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; array[j &lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;];&lt;br&gt;                            array[j &lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;] &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; temp;&lt;br&gt;                            hasExchangeAction &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;true&lt;/span&gt;&lt;span&gt;;   &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;发生过互换&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;                        &#125;&lt;br&gt;                    &#125;&lt;br&gt;&lt;br&gt;                    &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; (&lt;/span&gt;&lt;span&gt;!&lt;/span&gt;&lt;span&gt;hasExchangeAction) &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;如果没有发生过互换，则数组已经是有序的了，跳出循环&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;                    &#123;&lt;br&gt;                        &lt;/span&gt;&lt;span&gt;break&lt;/span&gt;&lt;span&gt;;&lt;br&gt;                    &#125;&lt;br&gt;                &#125;&lt;br&gt;            &#125;&lt;br&gt;            &lt;/span&gt;&lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (Exception ex)&lt;br&gt;            &#123; &#125;&lt;br&gt;        &#125;&lt;/span&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/09/04/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95CSharp%E5%AE%9E%E7%8E%B0/IMG-20250704185625090.gif" alt="复制代码"></p>
<p>。。。。。</p>
<p>posted @ 2011-08-17 16:02  <a target="_blank" rel="noopener" href="https://www.cnblogs.com/mingmingruyuedlut">Eric Sun</a>  阅读(7637)  评论()  <a target="_blank" rel="noopener" href="https://i.cnblogs.com/EditPosts.aspx?postid=2143231">编辑</a>  收藏  举报</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chengming0916.github.io/2024/09/04/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95CSharp%E5%AE%9E%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Chemmy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/09/04/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95CSharp%E5%AE%9E%E7%8E%B0/" class="post-title-link" itemprop="url">归并排序算法CSharp实现</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-09-04 00:00:00" itemprop="dateCreated datePublished" datetime="2024-09-04T00:00:00+08:00">2024-09-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-04 16:58:11" itemprop="dateModified" datetime="2025-12-04T16:58:11+08:00">2025-12-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">排序算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="归并排序算法（C-实现）"><a href="#归并排序算法（C-实现）" class="headerlink" title="归并排序算法（C#实现）"></a>归并排序算法（C#实现）</h1><blockquote>
<h2 id="Excerpt"><a href="#Excerpt" class="headerlink" title="Excerpt"></a>Excerpt</h2><p>自顶向下的归并排序：是利用递归和分而治之的技术将数据序列划分成为越来越小的半子表，再对半子表排序，最后再用递归步骤将排好序的半子表合并成为越来越大的有序序列，归并排序包括两个步骤，分别为：1）划分子表  2）合并半子表</p>
</blockquote>
<hr>
<p>     归并排序(Merge Sort)是利用”归并”技术来进行排序。归并是指将若干个已排序的子文件合并成一个有序的文件。归并排序有两种方式：1): <strong>自底向上的方法</strong> 2):<strong>自顶向下的方法</strong></p>
<p> <strong>1、 自底向上的方法</strong><br>（1） 自底向上的基本思想<br>     自底向上的基本思想是：第1趟归并排序时，将待排序的文件R[1..n]看作是n个长度为1的有序子文件，将这些子文件两两归并，若n为偶数，则得到n&#x2F;2个长度为2的有序子文件；若n为奇数，则最后一个子文件轮空(不参与归并)。故本趟归并完成后，前n&#x2F;2 - 1个有序子文件长度为2，但最后一个子文件长度仍为1；第2趟归并则是将第1趟归并所得到的n&#x2F;2个有序的子文件两两归并，如此反复，直到最后得到一个长度为n的有序文件为止。<br>     上述的每次归并操作，均是将两个有序的子文件合并成一个有序的子文件，故称其为”二路归并排序”。类似地有k(k&gt;2)路归并排序。   </p>
<p><strong>2、自顶向下的方法(本文主要介绍此种方法，下面的文字都是对此种方法的解读)</strong></p>
<p>（1） 自顶向下的基本思想<br>     采用分治法进行自顶向下的算法设计，形式更为简洁。<br>     自顶向下的归并排序：是利用递归和分而治之的技术将数据序列划分成为越来越小的半子表，再对半子表排序，最后再用递归步骤将排好序的半子表合并成为越来越大的有序序列，归并排序包括两个步骤，分别为：</p>
<p>      1）划分子表</p>
<p>      2）合并半子表</p>
<p>（1）分治法的三个步骤<br>     设归并排序的当前区间是R[low..high]，分治法的三个步骤是：<br>①分解：将当前区间一分为二，即求分裂点<br>②求解：递归地对两个子区间R[low..mid]和R[mid+1..high]进行归并排序；<br>③组合：将已排序的两个子区间R[low..mid]和R[mid+1..high]归并为一个有序的区间R[low..high]。<br>  递归的终结条件：子区间长度为1（一个记录自然有序）。</p>
<p><strong>如下演示递归的整个过程：</strong></p>
<p>递归便是深度遍历（如下由左至右进行遍历）：假设有这样的一列数组{9,8,7,6,5,4,3,2,1}进行划分的顺序如下：</p>
<p>{9,8,7,6,5,4,3,2,1} –&gt; {9,8,7,6,5}，{4,3,2,1}</p>
<p>{9,8,7,6,5} –&gt; {9,8,7}，{6,5}</p>
<p>                        {9,8,7} –&gt; {9,8}，{7}</p>
<p>                                          {9,8} –&gt; {9}，{8}</p>
<p>                        {6,5} –&gt;{6}，{5}</p>
<p>{4,3,2,1} –&gt; {4,3}，{2,1}</p>
<p>                      {4,3} –&gt;{4}，{3}</p>
<p>                      {2,1} –&gt;{2}，{1}</p>
<p>当深度划分到左右数组都只剩1个元素的时候，进行上述逆序的合并：</p>
<p>{9}，{8} –&gt; {8,9} 然后和 {7} –&gt; {7,8,9}</p>
<p>                                {6}，{5} –&gt; {5,6}    然后 {7,8,9}和{5,6} –&gt; {5,6,7,8,9}</p>
<p>                                     {2}，{1} –&gt; {1,2}</p>
<p>                                     {4}，{3} –&gt; {3,4}   然后 {1,2}和 {3,4} –&gt; {1,2,3,4}</p>
<p>                                                                                                                         最终{5,6,7,8,9}和{1,2,3,4} –&gt; {1,2,3,4,5,6,7,8,9}</p>
<p><strong>具体实现代码如下所示：</strong></p>
<p><img src="/2024/09/04/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95CSharp%E5%AE%9E%E7%8E%B0/IMG-20250704185625092.gif" alt="复制代码"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt;//&lt;/span&gt;&lt;span&gt;归并排序（目标数组，子表的起始位置，子表的终止位置）&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;        &lt;span&gt;private&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; MergeSortFunction(&lt;span&gt;int&lt;/span&gt;[] array, &lt;span&gt;int&lt;/span&gt; first, &lt;span&gt;int&lt;/span&gt; last)&lt;br&gt;        &#123;&lt;br&gt;            &lt;span&gt;try&lt;/span&gt;&lt;br&gt;            &#123;&lt;br&gt;                &lt;span&gt;if&lt;/span&gt; (first &amp;lt; last)   &lt;span&gt;//&lt;/span&gt;&lt;span&gt;子表的长度大于1，则进入下面的递归处理&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;                &#123;&lt;br&gt;                    &lt;span&gt;int&lt;/span&gt; mid = (first + last) / &lt;span&gt;2&lt;/span&gt;;   &lt;span&gt;//&lt;/span&gt;&lt;span&gt;子表划分的位置&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;                    MergeSortFunction(array, first, mid);   &lt;span&gt;//&lt;/span&gt;&lt;span&gt;对划分出来的左侧子表进行递归划分&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;                    MergeSortFunction(array, mid + &lt;span&gt;1&lt;/span&gt;, last);    &lt;span&gt;//&lt;/span&gt;&lt;span&gt;对划分出来的右侧子表进行递归划分&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;                    MergeSortCore(array, first, mid, last); &lt;span&gt;//&lt;/span&gt;&lt;span&gt;对左右子表进行有序的整合（归并排序的核心部分）&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;                &#125;&lt;br&gt;            &#125;&lt;br&gt;            &lt;span&gt;catch&lt;/span&gt; (Exception ex)&lt;br&gt;            &#123; &#125;&lt;br&gt;        &#125;&lt;br&gt;&lt;br&gt;        &lt;span&gt;//&lt;/span&gt;&lt;span&gt;归并排序的核心部分：将两个有序的左右子表（以mid区分），合并成一个有序的表&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;        &lt;span&gt;private&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; MergeSortCore(&lt;span&gt;int&lt;/span&gt;[] array, &lt;span&gt;int&lt;/span&gt; first, &lt;span&gt;int&lt;/span&gt; mid, &lt;span&gt;int&lt;/span&gt; last)&lt;br&gt;        &#123;&lt;br&gt;            &lt;span&gt;try&lt;/span&gt;&lt;br&gt;            &#123;&lt;br&gt;                &lt;span&gt;int&lt;/span&gt; indexA = first; &lt;span&gt;//&lt;/span&gt;&lt;span&gt;左侧子表的起始位置&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;                &lt;span&gt;int&lt;/span&gt; indexB = mid + &lt;span&gt;1&lt;/span&gt;;   &lt;span&gt;//&lt;/span&gt;&lt;span&gt;右侧子表的起始位置&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;                &lt;span&gt;int&lt;/span&gt;[] temp = &lt;span&gt;new&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;[last + &lt;span&gt;1&lt;/span&gt;]; &lt;span&gt;//&lt;/span&gt;&lt;span&gt;声明数组（暂存左右子表的所有有序数列）：长度等于左右子表的长度之和。&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;                &lt;span&gt;int&lt;/span&gt; tempIndex = &lt;span&gt;0&lt;/span&gt;;&lt;br&gt;                &lt;span&gt;while&lt;/span&gt; (indexA &amp;lt;= mid &amp;amp;&amp;amp; indexB &amp;lt;= last) &lt;span&gt;//&lt;/span&gt;&lt;span&gt;进行左右子表的遍历，如果其中有一个子表遍历完，则跳出循环&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;                &#123;&lt;br&gt;                    &lt;span&gt;if&lt;/span&gt; (array[indexA] &amp;lt;= array[indexB]) &lt;span&gt;//&lt;/span&gt;&lt;span&gt;此时左子表的数 &amp;lt;= 右子表的数&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;                    &#123;&lt;br&gt;                        temp[tempIndex++] = array[indexA++];    &lt;span&gt;//&lt;/span&gt;&lt;span&gt;将左子表的数放入暂存数组中，遍历左子表下标++&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;                    &#125;&lt;br&gt;                    &lt;span&gt;else&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;此时左子表的数 &amp;gt; 右子表的数&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;                    &#123;&lt;br&gt;                        temp[tempIndex++] = array[indexB++];    &lt;span&gt;//&lt;/span&gt;&lt;span&gt;将右子表的数放入暂存数组中，遍历右子表下标++&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;                    &#125;&lt;br&gt;                &#125;&lt;br&gt;                &lt;span&gt;//&lt;/span&gt;&lt;span&gt;有一侧子表遍历完后，跳出循环，将另外一侧子表剩下的数一次放入暂存数组中（有序）&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;                &lt;span&gt;while&lt;/span&gt; (indexA &amp;lt;= mid)&lt;br&gt;                &#123;&lt;br&gt;                    temp[tempIndex++] = array[indexA++];&lt;br&gt;                &#125;&lt;br&gt;                &lt;span&gt;while&lt;/span&gt; (indexB &amp;lt;= last)&lt;br&gt;                &#123;&lt;br&gt;                    temp[tempIndex++] = array[indexB++];&lt;br&gt;                &#125;&lt;br&gt;&lt;br&gt;                &lt;span&gt;//&lt;/span&gt;&lt;span&gt;将暂存数组中有序的数列写入目标数组的制定位置，使进行归并的数组段有序&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;                tempIndex = &lt;span&gt;0&lt;/span&gt;;&lt;br&gt;                &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = first; i &amp;lt;= last; i++)&lt;br&gt;                &#123;&lt;br&gt;                    array[i] = temp[tempIndex++];&lt;br&gt;                &#125;&lt;br&gt;            &#125;&lt;br&gt;            &lt;span&gt;catch&lt;/span&gt; (Exception ex)&lt;br&gt;            &#123; &#125;&lt;br&gt;        &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/09/04/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95CSharp%E5%AE%9E%E7%8E%B0/IMG-20250704185625092.gif" alt="复制代码"></p>
<p>       对于N个元素的数组来说, 如此划分需要的层数是以2为底N的对数, 每一层中, 每一个元素都要复制到结果数组中, 并复制回来, 所以复制2N次, 那么对于归并排序,它的时间复杂度为O(N*logN), 而比较次数会少得多, 最少需要N&#x2F;2次,最多为N-1次, 所以平均比较次数在两者之间. 它的主要问题还是在于在内存中需要双倍的空间.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chengming0916.github.io/2024/09/04/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95CSharp%E5%AE%9E%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Chemmy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/09/04/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95CSharp%E5%AE%9E%E7%8E%B0/" class="post-title-link" itemprop="url">插入排序算法CSharp实现</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-09-04 00:00:00" itemprop="dateCreated datePublished" datetime="2024-09-04T00:00:00+08:00">2024-09-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-04 16:58:11" itemprop="dateModified" datetime="2025-12-04T16:58:11+08:00">2025-12-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">排序算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="插入排序算法C-实现"><a href="#插入排序算法C-实现" class="headerlink" title="插入排序算法C#实现"></a>插入排序算法C#实现</h1><blockquote>
<h2 id="Excerpt"><a href="#Excerpt" class="headerlink" title="Excerpt"></a>Excerpt</h2><p>插入排序算法主要分为：直接插入算法，折半排序算法（二分插入算法），希尔排序算法，后两种是直接插入算法的改良。因此直接插入算法是基础，这里先进行直接插入算法的分析与编码。直接插入算法的排序思想：假设有序数组从小到大为array[0],array[1],array[2],….,array[n-2],</p>
</blockquote>
<hr>
<p>插入排序算法主要分为：直接插入算法，折半排序算法（二分插入算法），希尔排序算法，后两种是直接插入算法的改良。因此直接插入算法是基础，这里先进行直接插入算法的分析与编码。</p>
<p>直接插入算法的排序思想：假设有序数组从小到大为array[0],array[1],array[2],….,array[n-2],array[n-1]，那么将待排数值array[n]与前面的有序数组从后向前依次比较，直到在有序数组中找到小于待排数值array[n]的位置，将array[n]插入到此位置，并入组合成新的有序数组。</p>
<p><strong>直接插入算法</strong>--代码如下所示：</p>
<p><img src="/2024/09/04/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95CSharp%E5%AE%9E%E7%8E%B0/IMG-20250704185625093.gif" alt="复制代码"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt;　　　　　//&lt;/span&gt;&lt;span&gt;直接插入排序算法（传递待排数组名，即：数组的地址。故形参数组的各种操作反应到实参数组上）&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;　　　　　private &lt;/span&gt;&lt;span&gt;static &lt;/span&gt;&lt;span&gt;void&lt;/span&gt;&lt;span&gt; InsertSortionFunction(&lt;/span&gt;&lt;span&gt;int&lt;/span&gt;&lt;span&gt;[] array)&lt;br&gt;        &#123;&lt;br&gt;            &lt;/span&gt;&lt;span&gt;try&lt;/span&gt;&lt;span&gt;&lt;br&gt;            &#123;&lt;br&gt;                &lt;/span&gt;&lt;span&gt;int&lt;/span&gt;&lt;span&gt; temp &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;;   &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;临时变量，存储待排的数值&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;　　　　　　　　　for&lt;/span&gt;&lt;span&gt; (&lt;/span&gt;&lt;span&gt;int&lt;/span&gt;&lt;span&gt; i &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;; i &lt;/span&gt;&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt; array.Length; i&lt;/span&gt;&lt;span&gt;++&lt;/span&gt;&lt;span&gt;)  &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;将无序的所有数值依次插入到有序数组中，注：下标从1开始，因为操作的是同一个数组&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;                &#123;&lt;br&gt;                    temp &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; array[i];    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;记录待插入前面有序数组的数值&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;　　　　　　　　　　　 int&lt;/span&gt;&lt;span&gt; index &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; i &lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;;  &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;记录前方有序数组的末尾位置&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;　　　　　　　　　　　 while&lt;/span&gt;&lt;span&gt; (index &lt;/span&gt;&lt;span&gt;&amp;gt;=&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span&gt; array[index] &lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;span&gt; temp)   &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;循环遍历前面的有序数组，并且从大到小依次与待排数值进行比较&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;                    &#123;&lt;br&gt;                        array[index &lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;] &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; array[index];    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;如果index&amp;gt;=0并且此时的值大于待排数值，将此处的值向后移动一位&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;                        index&lt;/span&gt;&lt;span&gt;--&lt;/span&gt;&lt;span&gt;;    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;index--向前遍历有序数组&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;                    &#125;&lt;br&gt;                    array[index &lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;] &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; temp;    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;由于前面的index--，所以temp插入的位置是index+1&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;                &#125;&lt;br&gt;            &#125;&lt;br&gt;            &lt;/span&gt;&lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (Exception ex)&lt;br&gt;            &#123; &#125;&lt;br&gt;        &#125;&lt;/span&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/09/04/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95CSharp%E5%AE%9E%E7%8E%B0/IMG-20250704185625093.gif" alt="复制代码"></p>
<p>折半排序算法是对直接插入算法的一种优化，优化的核心是：通过折半查看有序数组中间位置的数值（a）与待插入的数值（temp）的大小，如果a&gt;&#x3D;temp，则转向折半的左区间继续折半查找； 如果a&lt;temp，则转向折半后的右区间继续折半查找。直到左右下标相同时，此时折半的下标也指向相同的位置，再做最后一次循环，最终的结果是：左右下标相差1，并且原来左侧的下标指向大于temp的位置，原来右侧的下标指向了小于temp的位置，即：array[biggerIndex] &lt; temp &lt; array[smallerIndex]。</p>
<p><strong>折半排序算法</strong>--代码如下：</p>
<p><img src="/2024/09/04/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95CSharp%E5%AE%9E%E7%8E%B0/IMG-20250704185625093.gif" alt="复制代码"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt;  &amp;nbsp;　　　&lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;折半排序算法（传递待排数组名，即：数组的地址。故形参数组的各种操作反应到实参数组上）&lt;/span&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt;        private &lt;/span&gt;&lt;span&gt;static &lt;/span&gt;&lt;span&gt;void&lt;/span&gt;&lt;span&gt; BinaryInsertionSortFunction(&lt;/span&gt;&lt;span&gt;int&lt;/span&gt;&lt;span&gt;[] array)&lt;br&gt;        &#123;&lt;br&gt;            &lt;/span&gt;&lt;span&gt;try&lt;/span&gt;&lt;span&gt;&lt;br&gt;            &#123;&lt;br&gt;                &lt;/span&gt;&lt;span&gt;int&lt;/span&gt;&lt;span&gt; smallerIndex &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;; &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;记录有序数组的起始位置&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;　　　　　　　　　 int&lt;/span&gt;&lt;span&gt; biggerIndex &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;; &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;记录有序数组的终止位置&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;　　　　　　　　　 int&lt;/span&gt;&lt;span&gt; midIndex &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;; &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;记录获取有序数组的中间位置（折半法的关键：折半的位置）&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;　　　　　　　　　 int&lt;/span&gt;&lt;span&gt; temp;  &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;记录带排的数值&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;　　　　　　　　　 for&lt;/span&gt;&lt;span&gt; (&lt;/span&gt;&lt;span&gt;int&lt;/span&gt;&lt;span&gt; i &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;; i &lt;/span&gt;&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt; array.Length; i&lt;/span&gt;&lt;span&gt;++&lt;/span&gt;&lt;span&gt;)  &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;循环向有序数组中插入数值（i从1开始，因为操作的是同一个数组）&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;                &#123;&lt;br&gt;                    temp &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; array[i];   &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;记录待插入有序数组的数值&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;                    biggerIndex &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; i &lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;;&lt;br&gt;                    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;当smallerIndex==biggerIndex时，进入最后一次循环：smallerIndex指向大于temp的数组位置，biggerIndex指向小于temp的数组位置&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;　　　　　　　　　　　 while&lt;/span&gt;&lt;span&gt; (smallerIndex &lt;/span&gt;&lt;span&gt;&amp;lt;=&lt;/span&gt;&lt;span&gt; biggerIndex)   &lt;br&gt;                    &#123;&lt;br&gt;                        midIndex &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; (smallerIndex &lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt; biggerIndex) &lt;/span&gt;&lt;span&gt;/&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;&lt;span&gt;; &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;确定折半的位置&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;　　　　　　　　　　　　　　if&lt;/span&gt;&lt;span&gt;(array[midIndex] &lt;/span&gt;&lt;span&gt;&amp;gt;=&lt;/span&gt;&lt;span&gt; temp)  &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;折半位置的数值 &amp;gt;= temp&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;                        &#123;&lt;br&gt;                            biggerIndex &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; midIndex &lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;;    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;biggerIndex以midIndex为基础向前移动一位&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;                        &#125;&lt;br&gt;                        &lt;/span&gt;&lt;span&gt;else&lt;/span&gt;&lt;span&gt;&lt;br&gt;                        &#123;&lt;br&gt;                            smallerIndex &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; midIndex &lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;;  &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;smallerIndex以midIndex为基础向后移动一位&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;                        &#125;&lt;br&gt;                    &#125;&lt;br&gt;                    &lt;/span&gt;&lt;span&gt;for&lt;/span&gt;&lt;span&gt; (&lt;/span&gt;&lt;span&gt;int&lt;/span&gt;&lt;span&gt; j &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; i &lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;; j &lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;span&gt;biggerIndex; j&lt;/span&gt;&lt;span&gt;--&lt;/span&gt;&lt;span&gt;) &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;将有序数组中大于temp的数值分别向后移动一位&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;                    &#123;&lt;br&gt;                        array[j &lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;] &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; array[j];  &lt;/span&gt;&lt;span&gt;//&lt;br&gt;&lt;/span&gt;&lt;span&gt;                    &#125;&lt;br&gt;                    array[biggerIndex &lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;] &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; temp;   &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;将temp插入biggerIndex + 1，因为此时array[biggerIndex]&amp;lt;temp&amp;lt;array[smallerIndex]&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;                &#125;&lt;br&gt;            &#125;&lt;br&gt;            &lt;/span&gt;&lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (Exception ex)&lt;br&gt;            &#123; &#125;&lt;br&gt;        &#125;&lt;/span&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/09/04/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95CSharp%E5%AE%9E%E7%8E%B0/IMG-20250704185625093.gif" alt="复制代码"></p>
<p>希尔排序同样是直接插入排序算法的一种改进，基本思想是：将无序的数列划分为若干小的子序列，然后对子序列进行直接插入排序。<br>时间性能优于直接插入排序算法，但是一种不稳定的排序，时间复杂度为O(nlogn)。<br>希尔排序算法主要分为3重循环：<br>第一重循环–&gt;按照gap的大小进行分组，初始化从array.Length&#x2F;2开始，依次递减到1<br>第二重循环–&gt;对所有分组进行排序<br>第三重循环–&gt;组内进行直接插入排序</p>
<p><strong>希尔排序算法</strong>--代码如下：</p>
<p><img src="/2024/09/04/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95CSharp%E5%AE%9E%E7%8E%B0/IMG-20250704185625093.gif" alt="复制代码"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt;　　　　  private &lt;/span&gt;&lt;span&gt;static &lt;/span&gt;&lt;span&gt;void&lt;/span&gt;&lt;span&gt; ShellSortFunction(&lt;/span&gt;&lt;span&gt;int&lt;/span&gt;&lt;span&gt;[] array)&lt;br&gt;        &#123;&lt;br&gt;            &lt;/span&gt;&lt;span&gt;try&lt;/span&gt;&lt;span&gt;&lt;br&gt;            &#123;&lt;br&gt;                &lt;/span&gt;&lt;span&gt;int&lt;/span&gt;&lt;span&gt; length &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; array.Length;&lt;br&gt;                &lt;/span&gt;&lt;span&gt;int&lt;/span&gt;&lt;span&gt; temp &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;;&lt;br&gt;                &lt;/span&gt;&lt;span&gt;for&lt;/span&gt;&lt;span&gt; (&lt;/span&gt;&lt;span&gt;int&lt;/span&gt;&lt;span&gt; gap &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; length &lt;/span&gt;&lt;span&gt;/&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;&lt;span&gt;; gap &lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;; gap&lt;/span&gt;&lt;span&gt;--&lt;/span&gt;&lt;span&gt;)  &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;第一重循环，按照gap的大小进行分组&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;                &#123;&lt;br&gt;                    &lt;/span&gt;&lt;span&gt;for&lt;/span&gt;&lt;span&gt; (&lt;/span&gt;&lt;span&gt;int&lt;/span&gt;&lt;span&gt; i &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;; i &lt;/span&gt;&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt; gap; i&lt;/span&gt;&lt;span&gt;++&lt;/span&gt;&lt;span&gt;)   &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;第二重循环，对所有分组进行排序&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;                    &#123;&lt;br&gt;                        &lt;/span&gt;&lt;span&gt;for&lt;/span&gt;&lt;span&gt; (&lt;/span&gt;&lt;span&gt;int&lt;/span&gt;&lt;span&gt; j &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; i; j &lt;/span&gt;&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt; length; j &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; j &lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt; gap)    &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt;第三重循环，组内进行直接插入排序&lt;/span&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;                        &#123;&lt;br&gt;                            temp &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; array[j];&lt;br&gt;                            &lt;/span&gt;&lt;span&gt;int&lt;/span&gt;&lt;span&gt; index &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; j &lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt; gap;&lt;br&gt;                            &lt;/span&gt;&lt;span&gt;while&lt;/span&gt;&lt;span&gt; (index &lt;/span&gt;&lt;span&gt;&amp;gt;=&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span&gt; array[index] &lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;span&gt; temp)&lt;br&gt;                            &#123;&lt;br&gt;                                array[index &lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt; gap] &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; array[index];&lt;br&gt;                                index &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; index &lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt; gap;&lt;br&gt;                            &#125;&lt;br&gt;                            array[index &lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt; gap] &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; temp;&lt;br&gt;                        &#125;&lt;br&gt;                    &#125;&lt;br&gt;                &#125;&lt;br&gt;            &#125;&lt;br&gt;            &lt;/span&gt;&lt;span&gt;catch&lt;/span&gt;&lt;span&gt; (Exception ex)&lt;br&gt;            &#123; &#125;&lt;br&gt;        &#125;&lt;/span&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/09/04/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95CSharp%E5%AE%9E%E7%8E%B0/IMG-20250704185625093.gif" alt="复制代码"></p>
<p>。。。。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chengming0916.github.io/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/Qt%E4%BD%BF%E7%94%A8ONNX%E8%B0%83%E7%94%A8YOLOv8%E6%A8%A1%E5%9E%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Chemmy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/Qt%E4%BD%BF%E7%94%A8ONNX%E8%B0%83%E7%94%A8YOLOv8%E6%A8%A1%E5%9E%8B/" class="post-title-link" itemprop="url">Qt使用ONNX调用YOLOv8模型</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-09-04 00:00:00" itemprop="dateCreated datePublished" datetime="2024-09-04T00:00:00+08:00">2024-09-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-04 16:58:11" itemprop="dateModified" datetime="2025-12-04T16:58:11+08:00">2025-12-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">编程技术</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/" itemprop="url" rel="index"><span itemprop="name">YOLOv8</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Qt配置onnx-runtime"><a href="#Qt配置onnx-runtime" class="headerlink" title="Qt配置onnx_runtime"></a>Qt配置onnx_runtime</h2><p>首先，onnx_runtime官方也给编译好的release版本，下载即可。但是在qt中配置有一个坑。<br><img src="/%E3%80%90%E9%A1%B9%E7%9B%AE%E3%80%91yolov8+qt+onnx_yolov8%20onnx%20qt-CSDN%E5%8D%9A%E5%AE%A2/f285649ef971a256a02a12c80d3121c0.pngpic_center" alt="在这里插入图片描述"><br>在Qt Creator中正常添加外部库，但是你会发现构建会找不到onnxruntime.lib，这是如果你替换成全路径，即把注释的部分换成下面的lib路径，直接指明onnxruntime.lib。这时构建成功，可以include &lt;onnxruntime_cxx_api.h&gt;，但是在运行你会遇到应用程序无法启动。<br><img src="/%E3%80%90%E9%A1%B9%E7%9B%AE%E3%80%91yolov8+qt+onnx_yolov8%20onnx%20qt-CSDN%E5%8D%9A%E5%AE%A2/9998c7279c23cb3384a6682c150d6eb5.pngpic_center" alt="在这里插入图片描述"><br>根据百度把onnxruntime.dll复制到.exe目录下。<br><img src="/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/Qt%E4%BD%BF%E7%94%A8ONNX%E8%B0%83%E7%94%A8YOLOv8%E6%A8%A1%E5%9E%8B/IMG-20250804110742710.png" alt="在这里插入图片描述"><br>OK，启动成功。</p>
<h2 id="opencv读取视频流"><a href="#opencv读取视频流" class="headerlink" title="opencv读取视频流"></a>opencv读取视频流</h2><p>居中显示，随意拉伸。<br><img src="/%E3%80%90%E9%A1%B9%E7%9B%AE%E3%80%91yolov8+qt+onnx_yolov8%20onnx%20qt-CSDN%E5%8D%9A%E5%AE%A2/c85d6456e082a061090d525060d438ef.pngpic_center" alt="在这里插入图片描述"><br><img src="/%E3%80%90%E9%A1%B9%E7%9B%AE%E3%80%91yolov8+qt+onnx_yolov8%20onnx%20qt-CSDN%E5%8D%9A%E5%AE%A2/03731735e1a578e9586e4907e895b56d.pngpic_center" alt="在这里插入图片描述"><br>实现居中的逻辑：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 调整QImage的大小以匹配QLabel的大小 QPixmap scaledPixmap = QPixmap::fromImage(qimg).scaled(ui-&gt;Origin_Video-&gt;size(), Qt::KeepAspectRatio, Qt::FastTransformation);</span></span><br></pre></td></tr></table></figure>

<p>而在界面当中需要对窗口随意拉伸，这是就需要界面允许缩放。修改QLabel的属性：<br><img src="/%E3%80%90%E9%A1%B9%E7%9B%AE%E3%80%91yolov8+qt+onnx_yolov8%20onnx%20qt-CSDN%E5%8D%9A%E5%AE%A2/ffea42604dabb996f785e64e414b6d74.pngpic_center" alt="在这里插入图片描述"><br>修改成minimum，并给定最小宽度和高度。（还不知道原因，等有空学习一下）</p>
<p>最后opencv读取视频流并拉取每一帧显示在QLabel中，这里采用的是用一个Qtimer，定时去获取视频帧。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建定时器，每隔一定时间显示下一帧 timer = new QTimer(this); connect(timer, &amp;QTimer::timeout, this, &amp;MainWindow::showNextFrame); timer-&gt;start(33); // 设置帧率为30FPS，即每隔33毫秒显示一帧</span></span><br></pre></td></tr></table></figure>

<p>完整代码如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在槽函数中处理视频的加载和显示 void MainWindow::on_actionvideo_triggered() &#123; camera-&gt;stop(); viewfinder-&gt;close(); QString curPath = QDir::homePath(); QString dlgTitle = &quot;选择视频文件&quot;; QString filter = &quot;视频文件(*.wmv *.mp4);;所有文件(*.*)&quot;; QString aFile = QFileDialog::getOpenFileName(this, dlgTitle, curPath, filter); if (aFile.isEmpty()) &#123; return; &#125; ui-&gt;dir_Edit-&gt;setText(aFile); currentSource = File; // 更新当前视频源为视频文件 displayVideo(); // 显示视频 &#125; // 根据当前视频源显示视频的函数 void MainWindow::displayVideo() &#123; if (currentSource == File) &#123; std::string video_path = ui-&gt;dir_Edit-&gt;text().toLocal8Bit().constData(); cap.open(video_path); if (!cap.isOpened()) &#123; qDebug() &lt;&lt; &quot;Error: Unable to open the video file&quot;; return; &#125; // 创建定时器，每隔一定时间显示下一帧 timer = new QTimer(this); connect(timer, &amp;QTimer::timeout, this, &amp;MainWindow::showNextFrame); timer-&gt;start(33); // 设置帧率为30FPS，即每隔33毫秒显示一帧 &#125; else if (currentSource == Camera) &#123; // 创建定时器，每隔一定时间显示下一帧 timer = new QTimer(this); connect(timer, &amp;QTimer::timeout, this, &amp;MainWindow::viewfinderchange); timer-&gt;start(33); // 设置帧率为30FPS，即每隔33毫秒显示一帧 // cameras = QCameraInfo::availableCameras(); //获取所有相机的列表 // camera = new QCamera(cameras[0]); //camera指向指定的摄像头 camera-&gt;setCaptureMode(QCamera::CaptureStillImage); //设定捕获模式 camera-&gt;setViewfinder(viewfinder); //设置取景器 camera-&gt;start(); &#125; &#125; // 显示下一帧的槽函数 void MainWindow::showNextFrame() &#123; cv::Mat frame; cap &gt;&gt; frame; // 从视频流中获取一帧 if (frame.empty()) &#123; cap.set(cv::CAP_PROP_POS_FRAMES, 0); // 如果视频结束，重新开始播放 cap &gt;&gt; frame; &#125; currentFrame = frame; // 保存当前帧 displayCurrentFrame(); // 显示当前帧 &#125; void MainWindow::displayCurrentFrame() &#123; // 将OpenCV帧转换为QImage QImage qimg(currentFrame.data, currentFrame.cols, currentFrame.rows, currentFrame.step, QImage::Format_RGB888); qimg = qimg.rgbSwapped(); // 将格式从BGR转换为RGB // 调整QImage的大小以匹配QLabel的大小 QPixmap scaledPixmap = QPixmap::fromImage(qimg).scaled(ui-&gt;Origin_Video-&gt;size(), Qt::KeepAspectRatio, Qt::FastTransformation); // 将调整大小后的图像居中显示在QLabel中 centerImageInLabel(ui-&gt;Origin_Video, scaledPixmap); &#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="QCamra"><a href="#QCamra" class="headerlink" title="QCamra"></a>QCamra</h2><p>居中显示，随意拉伸<br><img src="/%E3%80%90%E9%A1%B9%E7%9B%AE%E3%80%91yolov8+qt+onnx_yolov8%20onnx%20qt-CSDN%E5%8D%9A%E5%AE%A2/be2ce60fe3c19cd759a0b07821799600.pngpic_center" alt="在这里插入图片描述"><br>QCamera其实同理，中间拉伸也用了一个QTimer定时获取QLabel的size。<br>QCamera的使用包括初始化一个camera和设置取景器viewfinder，viewfinder的作用就是控制图像在空间中的展示。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">MainWindow::on_actioncamera_triggered</span><span class="params">()</span> &#123; cameras = QCameraInfo::availableCameras(); <span class="comment">//获取所有相机的列表 //qDebug() &lt;&lt; &quot;this is camera: &quot;; if (cameras.count() &gt; 0) &#123; for(const QCameraInfo &amp;cameraInfo:cameras) &#123; qDebug() &lt;&lt; cameraInfo.description(); &#125; camera = new QCamera(cameras.at(0)); //初始化实例化一个相机对象 &#125; //设置取景器 viewfinder = new QCameraViewfinder(ui-&gt;Origin_Video); camera-&gt;setViewfinder(viewfinder); centerCameraViewfinderInLabel(viewfinder, ui-&gt;Origin_Video); camera-&gt;start(); //开启相机 //设置默认摄像头参数 QCameraViewfinderSettings set; // set.setResolution(640, 480); //设置显示分辨率 set.setMaximumFrameRate(30); //设置帧率 camera-&gt;setViewfinderSettings(set); stopVideo(); ui-&gt;Origin_Video-&gt;setPixmap(QPixmap(&quot;&quot;)); currentSource = Camera; // 更新当前视频源为摄像头 viewfinder-&gt;show(); displayVideo(); // 显示视频 &#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="yolov8-onnx-推理"><a href="#yolov8-onnx-推理" class="headerlink" title="yolov8 onnx 推理"></a>yolov8 onnx 推理</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">MainWindow::on_actionTest_triggered</span><span class="params">()</span> &#123; <span class="comment">// std::string projectBasePath = &quot;./&quot;; // Set your ultralytics base path QString qs = QCoreApplication::applicationDirPath(); std::string projectBasePath = qs.toLocal8Bit().constData(); bool runOnGPU = false; // Note that in this example the classes are hard-coded and &#x27;classes.txt&#x27; is a place holder. Inference inf(projectBasePath + &quot;/moust_best.onnx&quot;, cv::Size(640, 640), &quot;mouse.txt&quot;, runOnGPU); std::string video_path = ui-&gt;dir_Edit-&gt;text().toLocal8Bit().constData(); // 读取视频文件 // cv::VideoCapture cap(projectBasePath + &quot;/video/video.mp4&quot;); cv::VideoCapture cap(video_path); if (!cap.isOpened()) &#123; std::cout &lt;&lt; &quot;Error opening video file&quot; &lt;&lt; std::endl; return ; &#125; cv::Mat frame; while (cap.read(frame)) &#123; // 推断开始... std::vector&lt;Detection&gt; output = inf.runInference(frame); int detections = output.size(); std::cout &lt;&lt; &quot;Number of detections:&quot; &lt;&lt; detections &lt;&lt; std::endl; for (int i = 0; i &lt; detections; ++i) &#123; Detection detection = output[i]; cv::Rect box = detection.box; cv::Scalar color = detection.color; // Detection box cv::rectangle(frame, box, color, 2); // Detection box text std::string classString = detection.className + &#x27; &#x27; + std::to_string(detection.confidence).substr(0, 4); cv::Size textSize = cv::getTextSize(classString, cv::FONT_HERSHEY_DUPLEX, 1, 2, 0); cv::Rect textBox(box.x, box.y - 40, textSize.width + 10, textSize.height + 20); cv::rectangle(frame, textBox, color, cv::FILLED); cv::putText(frame, classString, cv::Point(box.x + 5, box.y - 10), cv::FONT_HERSHEY_DUPLEX, 1, cv::Scalar(0, 0, 0), 2, 0); &#125; // 推断结束... // 仅用于预览 float scale = 0.8; cv::resize(frame, frame, cv::Size(frame.cols*scale, frame.rows*scale)); cv::imshow(&quot;Inference&quot;, frame); if (cv::waitKey(1) == 27) &#123; break; &#125; &#125; cap.release(); cv::destroyAllWindows(); &#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="多线程（onnx推理线程和界面主线程）"><a href="#多线程（onnx推理线程和界面主线程）" class="headerlink" title="多线程（onnx推理线程和界面主线程）"></a>多线程（onnx推理线程和界面主线程）</h2><p><img src="/%E3%80%90%E9%A1%B9%E7%9B%AE%E3%80%91yolov8+qt+onnx_yolov8%20onnx%20qt-CSDN%E5%8D%9A%E5%AE%A2/97d0a21ce1306722fe5c6726ec18e730.pngpic_center" alt="在这里插入图片描述"><br>摄像头与onnx互不干扰，说明主界面线程与onnx推理是分开线程进行的，ok！</p>
<p>######################### 2024 05 09 更新 ##############################################<br><img src="/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/Qt%E4%BD%BF%E7%94%A8ONNX%E8%B0%83%E7%94%A8YOLOv8%E6%A8%A1%E5%9E%8B/IMG-20250804110742884.png" alt="在这里插入图片描述"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chengming0916.github.io/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/YOLOv8%E8%AE%AD%E7%BB%83%E5%B9%B6%E6%B5%8B%E8%AF%95VisDrone%E6%95%B0%E6%8D%AE%E9%9B%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Chemmy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/YOLOv8%E8%AE%AD%E7%BB%83%E5%B9%B6%E6%B5%8B%E8%AF%95VisDrone%E6%95%B0%E6%8D%AE%E9%9B%86/" class="post-title-link" itemprop="url">YOLOv8训练并测试VisDrone数据集</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-09-04 00:00:00" itemprop="dateCreated datePublished" datetime="2024-09-04T00:00:00+08:00">2024-09-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-04 16:58:11" itemprop="dateModified" datetime="2025-12-04T16:58:11+08:00">2025-12-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">编程技术</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/" itemprop="url" rel="index"><span itemprop="name">YOLOv8</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="1-环境准备"><a href="#1-环境准备" class="headerlink" title="1.环境准备"></a>1.环境准备</h2><p>在这之前，需要先准备主机的环境，环境如下：</p>
<p>Ubuntu18.04<br>cuda11.3<br>pytorch:1.11.0<br>torchvision:0.12.0<br>在服务器上执行以下命令，</p>
<h3 id="创建yolov8虚拟环境"><a href="#创建yolov8虚拟环境" class="headerlink" title="创建yolov8虚拟环境"></a>创建yolov8虚拟环境</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda create -n yolov8 python=<span class="number">3.8</span></span><br></pre></td></tr></table></figure>

<h3 id="进入虚拟环境"><a href="#进入虚拟环境" class="headerlink" title="进入虚拟环境"></a>进入虚拟环境</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda activate yolov8</span><br></pre></td></tr></table></figure>

<h3 id="安装pytorch-v1-11-0"><a href="#安装pytorch-v1-11-0" class="headerlink" title="安装pytorch v1.11.0"></a>安装pytorch v1.11.0</h3><p>pytorch v1.11.0（torch1.11.0+cu1113 ，torchvision0.12.0+cu113）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># CUDA 11.3 pip install torch==1.11.0+cu113 torchvision==0.12.0+cu113 torchaudio==0.11.0 --extra-index-url https://download.pytorch.org/whl/cu113</span></span><br></pre></td></tr></table></figure>

<h3 id="下载yolov8的代码"><a href="#下载yolov8的代码" class="headerlink" title="下载yolov8的代码"></a>下载yolov8的代码</h3><p>先创建yolov8文件夹，存放等会要下载的yolov8代码<code>mkdir yolov8</code><br>进入yolov8文件夹，<code>cd yolov8</code><br>下载yolov8代码<code>git clone https://github.com/ultralytics/ultralytics.git</code></p>
<h3 id="其他配置"><a href="#其他配置" class="headerlink" title="其他配置"></a>其他配置</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install ultralytics</span><br></pre></td></tr></table></figure>

<h2 id="2-VisDrone数据集准备"><a href="#2-VisDrone数据集准备" class="headerlink" title="2.VisDrone数据集准备"></a>2.VisDrone数据集准备</h2><h3 id="数据集下载"><a href="#数据集下载" class="headerlink" title="数据集下载"></a>数据集下载</h3><p>github链接上下载：<a target="_blank" rel="noopener" href="https://github.com/VisDrone/VisDrone-Dataset">官方链接</a><br>下载Task1：Object Detectino in Images下面的四个VisDrone-DET dataset数据集<br><img src="/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/YOLOv8%E8%AE%AD%E7%BB%83%E5%B9%B6%E6%B5%8B%E8%AF%95VisDrone%E6%95%B0%E6%8D%AE%E9%9B%86/IMG-20250804110742713.png" alt="在这里插入图片描述"><br>下载好zip文件后，使用winscp将zip文件传输到远程服务器上。<br>在服务器上进入到zip文件所在的文件夹中使用unzip命令解压zip文件。<br>如： <code>unzip VisDrone2019-DET-val.zip</code></p>
<h3 id="数据集处理"><a href="#数据集处理" class="headerlink" title="数据集处理"></a>数据集处理</h3><p>和yolov5所需要的格式一致。参考yolov5数据处理方法。<br>主要是labels的生成，可以在yolov8下面新建一个visdrone2yolov.py文件。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> utils.general <span class="keyword">import</span> download, os, Path <span class="keyword">def</span> <span class="title function_">visdrone2yolo</span>(<span class="params"><span class="built_in">dir</span></span>): <span class="keyword">from</span> PIL <span class="keyword">import</span> Image <span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm <span class="keyword">def</span> <span class="title function_">convert_box</span>(<span class="params">size, box</span>): <span class="comment"># Convert VisDrone box to YOLO xywh box dw = 1. / size[0] dh = 1. / size[1] return (box[0] + box[2] / 2) * dw, (box[1] + box[3] / 2) * dh, box[2] * dw, box[3] * dh (dir / &#x27;labels&#x27;).mkdir(parents=True, exist_ok=True) # make labels directory pbar = tqdm((dir / &#x27;annotations&#x27;).glob(&#x27;*.txt&#x27;), desc=f&#x27;Converting &#123;dir&#125;&#x27;) for f in pbar: img_size = Image.open((dir / &#x27;images&#x27; / f.name).with_suffix(&#x27;.jpg&#x27;)).size lines = [] with open(f, &#x27;r&#x27;) as file: # read annotation.txt for row in [x.split(&#x27;,&#x27;) for x in file.read().strip().splitlines()]: if row[4] == &#x27;0&#x27;: # VisDrone &#x27;ignored regions&#x27; class 0 continue cls = int(row[5]) - 1 # 类别号-1 box = convert_box(img_size, tuple(map(int, row[:4]))) lines.append(f&quot;&#123;cls&#125; &#123;&#x27; &#x27;.join(f&#x27;&#123;x:.6f&#125;&#x27; for x in box)&#125;\n&quot;) with open(str(f).replace(os.sep + &#x27;annotations&#x27; + os.sep, os.sep + &#x27;labels&#x27; + os.sep), &#x27;w&#x27;) as fl: fl.writelines(lines) # write label.txt dir = Path(&#x27;/home/yolov5/datasets/VisDrone2019&#x27;) # datasets文件夹下Visdrone2019文件夹目录 # Convert for d in &#x27;VisDrone2019-DET-train&#x27;, &#x27;VisDrone2019-DET-val&#x27;, &#x27;VisDrone2019-DET-test-dev&#x27;: visdrone2yolo(dir / d) # convert VisDrone annotations to YOLO labels</span></span><br></pre></td></tr></table></figure>

<p>正确执行代码后，会在’VisDrone2019-DET-train’, ‘VisDrone2019-DET-val’, ‘VisDrone2019-DET-test-dev三个文件夹内新生成labels文件夹，用以存放将VisDrone数据集处理成YoloV8格式后的数据标</p>
<h3 id="修改数据配置文件"><a href="#修改数据配置文件" class="headerlink" title="修改数据配置文件"></a>修改数据配置文件</h3><p>记事本或notepad++打开ultralytics-main\ultralytics\datasets\文件夹下的VisDrone.yaml文件，将其中path参数修改为VisDrone2019文件夹所在的路径。<br><img src="/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/YOLOv8%E8%AE%AD%E7%BB%83%E5%B9%B6%E6%B5%8B%E8%AF%95VisDrone%E6%95%B0%E6%8D%AE%E9%9B%86/IMG-20250804110742890.png" alt="在这里插入图片描述"></p>
<h2 id="3-训练-验证-导出"><a href="#3-训练-验证-导出" class="headerlink" title="3.训练&#x2F;验证&#x2F;导出"></a>3.训练&#x2F;验证&#x2F;导出</h2><h3 id="训练"><a href="#训练" class="headerlink" title="训练"></a>训练</h3><p>打开终端（或者pycharm等IDE），进入虚拟环境，随后进入yolov8文件夹，在终端中输入下面命令，即可开始训练。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yolo task=detect mode=train model=yolov8s.pt data=datasets/VisDrone.yaml batch=<span class="number">16</span> epochs=<span class="number">100</span> imgsz=<span class="number">640</span> workers=<span class="number">0</span> device=<span class="number">0</span></span><br></pre></td></tr></table></figure>

<h3 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h3><ol>
<li>val数据集上验证<br>激活yolov8虚拟环境<code>conda activate yolov8</code><br>进入yolov8文件夹<code>cd pyCode/yolov8/ultralytics/ultralytics/</code><br>使用如下命令，即可完成对验证数据的评估。<br>开始验证</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yolo task=detect mode=val model=runs/detect/train4/weights/best.pt data=datasets/VisDrone.yaml device=<span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>验证结果如下。<br><img src="/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/YOLOv8%E8%AE%AD%E7%BB%83%E5%B9%B6%E6%B5%8B%E8%AF%95VisDrone%E6%95%B0%E6%8D%AE%E9%9B%86/IMG-20250804110743361.png" alt="在这里插入图片描述"></p>
<ol start="2">
<li>在test数据集上验证<br>将datasets&#x2F;VisDrone.yaml文件中的val路径修改为：VisDrone2019-DET-test-dev&#x2F;images</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Train/val/test sets as 1) dir: path/to/imgs, 2) file: path/to/imgs.txt, or 3) list: [path/to/imgs1, path/to/imgs2, ..] # path: ../datasets/VisDrone # dataset root dir path: /home/xxx/yolov5/datasets/VisDrone # dataset root dir train: VisDrone2019-DET-train/images # train images (relative to &#x27;path&#x27;) 6471 images val: VisDrone2019-DET-test-dev/images # val images (relative to &#x27;path&#x27;) 548 images VisDrone2019-DET-val/images test: VisDrone2019-DET-test-dev/images # test images (optional) 1610 images</span></span><br></pre></td></tr></table></figure>

<p><img src="/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/YOLOv8%E8%AE%AD%E7%BB%83%E5%B9%B6%E6%B5%8B%E8%AF%95VisDrone%E6%95%B0%E6%8D%AE%E9%9B%86/IMG-20250804110743603.png" alt="在这里插入图片描述"></p>
<p>使用如下命令，即可完成在VisDrone2019-DET-test-dev数据集上的评估。<br>开始验证</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yolo task=detect mode=val model=runs/detect/train4/weights/best.pt data=datasets/VisDrone.yaml device=<span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>结果如下<br><img src="/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/YOLOv8%E8%AE%AD%E7%BB%83%E5%B9%B6%E6%B5%8B%E8%AF%95VisDrone%E6%95%B0%E6%8D%AE%E9%9B%86/IMG-20250804110743630.png" alt="在这里插入图片描述"></p>
<h3 id="导出"><a href="#导出" class="headerlink" title="导出"></a>导出</h3><p>使用如下命令即可导出</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yolo task=detect mode=<span class="keyword">export</span> model=runs/detect/train4/weights/best.pt</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chengming0916.github.io/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/YOLO%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E7%95%8C%E9%9D%A2%E7%A8%8B%E5%BA%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Chemmy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/YOLO%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E7%95%8C%E9%9D%A2%E7%A8%8B%E5%BA%8F/" class="post-title-link" itemprop="url">YOLO数据处理界面程序</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-09-04 00:00:00" itemprop="dateCreated datePublished" datetime="2024-09-04T00:00:00+08:00">2024-09-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-04 16:58:11" itemprop="dateModified" datetime="2025-12-04T16:58:11+08:00">2025-12-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">编程技术</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/" itemprop="url" rel="index"><span itemprop="name">YOLOv8</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Wj421d78y/">点击这里，观看项目说明视频讲解</a></p>
<p>本案例 使用 <code>YOLOv8</code> 结合 <code>Python Qt</code> ，开发一个图形界面的 AI实时物品监测程序。</p>
<p>注意</p>
<p>如果你使用其它版本YOLO（比如YOLOv5）训练的模型，请修改相应的导入和检测代码。</p>
<h3 id="您需要高效学习，找工作？-点击咨询-报名实战班"><a href="#您需要高效学习，找工作？-点击咨询-报名实战班" class="headerlink" title="您需要高效学习，找工作？ 点击咨询 报名实战班"></a>您需要高效学习，找工作？ <a target="_blank" rel="noopener" href="https://www.byhy.net/adv/vipcourse/">点击咨询</a> 报名实战班</h3><h3 id="点击查看学员就业情况"><a href="#点击查看学员就业情况" class="headerlink" title="点击查看学员就业情况"></a><a target="_blank" rel="noopener" href="https://www.bilibili.com/read/readlist/rl416500">点击查看学员就业情况</a></h3><h2 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码"></a>示例代码</h2><p>下面示例代码实现了摄像头实时视频流的YOLO检测。</p>
<p>如果还需要 包含 <code>视频文件实时检测</code> 的功能代码, 请将<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Wj421d78y/">这个YOLO+Qt视频分享到朋友圈（点击打开）</a>，截屏发微给 <code>byhy44</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span id=&quot;__span-0-1&quot;&gt;&lt;span&gt;from&lt;/span&gt; &lt;span&gt;PySide6&lt;/span&gt; &lt;span&gt;import&lt;/span&gt; &lt;span&gt;QtWidgets&lt;/span&gt;&lt;span&gt;,&lt;/span&gt; &lt;span&gt;QtCore&lt;/span&gt;&lt;span&gt;,&lt;/span&gt; &lt;span&gt;QtGui&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-2&quot;&gt;&lt;span&gt;import&lt;/span&gt; &lt;span&gt;cv2&lt;/span&gt;&lt;span&gt;,&lt;/span&gt; &lt;span&gt;os&lt;/span&gt;&lt;span&gt;,&lt;/span&gt; &lt;span&gt;time&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-3&quot;&gt;&lt;span&gt;from&lt;/span&gt; &lt;span&gt;threading&lt;/span&gt; &lt;span&gt;import&lt;/span&gt; &lt;span&gt;Thread&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-4&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-5&quot;&gt;&lt;span&gt;# 不然每次YOLO处理都会输出调试信息&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-6&quot;&gt;&lt;span&gt;os&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;environ&lt;/span&gt;&lt;span&gt;[&lt;/span&gt;&lt;span&gt;&#x27;YOLO_VERBOSE&#x27;&lt;/span&gt;&lt;span&gt;]&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;&#x27;False&#x27;&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-7&quot;&gt;&lt;span&gt;from&lt;/span&gt; &lt;span&gt;ultralytics&lt;/span&gt; &lt;span&gt;import&lt;/span&gt; &lt;span&gt;YOLO&lt;/span&gt; </span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-8&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-9&quot;&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;MWindow&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;QtWidgets&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;QMainWindow&lt;/span&gt;&lt;span&gt;):&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-10&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-11&quot;&gt;    &lt;span&gt;def&lt;/span&gt; &lt;span&gt;__init__&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;self&lt;/span&gt;&lt;span&gt;):&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-12&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-13&quot;&gt;        &lt;span&gt;super&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;__init__&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-14&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-15&quot;&gt;        &lt;span&gt;# 设置界面&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-16&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;setupUI&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-17&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-18&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;camBtn&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;clicked&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;connect&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;startCamera&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-19&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;stopBtn&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;clicked&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;connect&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;stop&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-20&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-21&quot;&gt;        &lt;span&gt;# 定义定时器，用于控制显示视频的帧率&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-22&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;timer_camera&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;QtCore&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;QTimer&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-23&quot;&gt;        &lt;span&gt;# 定时到了，回调 self.show_camera&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-24&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;timer_camera&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;timeout&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;connect&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;show_camera&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-25&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-26&quot;&gt;        &lt;span&gt;# 加载 YOLO nano 模型，第一次比较耗时，要20秒左右&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-27&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;model&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;YOLO&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;&#x27;yolov8n.pt&#x27;&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-28&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-29&quot;&gt;        &lt;span&gt;# 要处理的视频帧图片队列，目前就放1帧图片&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-30&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;frameToAnalyze&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;[]&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-31&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-32&quot;&gt;        &lt;span&gt;# 启动处理视频帧独立线程&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-33&quot;&gt;        &lt;span&gt;Thread&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;target&lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;frameAnalyzeThreadFunc&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;daemon&lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;True&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;start&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-34&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-35&quot;&gt;    &lt;span&gt;def&lt;/span&gt; &lt;span&gt;setupUI&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;self&lt;/span&gt;&lt;span&gt;):&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-36&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-37&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;resize&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;1200&lt;/span&gt;&lt;span&gt;,&lt;/span&gt; &lt;span&gt;800&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-38&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-39&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;setWindowTitle&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;&#x27;白月黑羽 YOLO-Qt 演示&#x27;&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-40&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-41&quot;&gt;        &lt;span&gt;# central Widget&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-42&quot;&gt;        &lt;span&gt;centralWidget&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;QtWidgets&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;QWidget&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;self&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-43&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;setCentralWidget&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;centralWidget&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-44&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-45&quot;&gt;        &lt;span&gt;# central Widget 里面的 主 layout&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-46&quot;&gt;        &lt;span&gt;mainLayout&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;QtWidgets&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;QVBoxLayout&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;centralWidget&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-47&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-48&quot;&gt;        &lt;span&gt;# 界面的上半部分 : 图形展示部分&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-49&quot;&gt;        &lt;span&gt;topLayout&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;QtWidgets&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;QHBoxLayout&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-50&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;label_ori_video&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;QtWidgets&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;QLabel&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;self&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-51&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;label_treated&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;QtWidgets&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;QLabel&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;self&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-52&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;label_ori_video&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;setMinimumSize&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;520&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;400&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-53&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;label_treated&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;setMinimumSize&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;520&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;400&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-54&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;label_ori_video&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;setStyleSheet&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;&#x27;border:1px solid #D7E2F9;&#x27;&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-55&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;label_treated&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;setStyleSheet&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;&#x27;border:1px solid #D7E2F9;&#x27;&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-56&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-57&quot;&gt;        &lt;span&gt;topLayout&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;addWidget&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;label_ori_video&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-58&quot;&gt;        &lt;span&gt;topLayout&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;addWidget&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;label_treated&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-59&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-60&quot;&gt;        &lt;span&gt;mainLayout&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;addLayout&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;topLayout&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-61&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-62&quot;&gt;        &lt;span&gt;# 界面下半部分： 输出框 和 按钮&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-63&quot;&gt;        &lt;span&gt;groupBox&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;QtWidgets&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;QGroupBox&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;self&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-64&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-65&quot;&gt;        &lt;span&gt;bottomLayout&lt;/span&gt; &lt;span&gt;=&lt;/span&gt;  &lt;span&gt;QtWidgets&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;QHBoxLayout&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;groupBox&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-66&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;textLog&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;QtWidgets&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;QTextBrowser&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-67&quot;&gt;        &lt;span&gt;bottomLayout&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;addWidget&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;textLog&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-68&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-69&quot;&gt;        &lt;span&gt;mainLayout&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;addWidget&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;groupBox&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-70&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-71&quot;&gt;        &lt;span&gt;btnLayout&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;QtWidgets&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;QVBoxLayout&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-72&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;videoBtn&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;QtWidgets&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;QPushButton&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;&#x27;🎞️视频文件&#x27;&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-73&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;camBtn&lt;/span&gt;   &lt;span&gt;=&lt;/span&gt; &lt;span&gt;QtWidgets&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;QPushButton&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;&#x27;📹摄像头&#x27;&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-74&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;stopBtn&lt;/span&gt;  &lt;span&gt;=&lt;/span&gt; &lt;span&gt;QtWidgets&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;QPushButton&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;&#x27;🛑停止&#x27;&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-75&quot;&gt;        &lt;span&gt;btnLayout&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;addWidget&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;videoBtn&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-76&quot;&gt;        &lt;span&gt;btnLayout&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;addWidget&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;camBtn&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-77&quot;&gt;        &lt;span&gt;btnLayout&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;addWidget&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;stopBtn&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-78&quot;&gt;        &lt;span&gt;bottomLayout&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;addLayout&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;btnLayout&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-79&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-80&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-81&quot;&gt;    &lt;span&gt;def&lt;/span&gt; &lt;span&gt;startCamera&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;self&lt;/span&gt;&lt;span&gt;):&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-82&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-83&quot;&gt;        &lt;span&gt;# 参考 https://docs.opencv.org/3.4/dd/d43/tutorial_py_video_display.html&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-84&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-85&quot;&gt;        &lt;span&gt;# 在 windows上指定使用 cv2.CAP_DSHOW 会让打开摄像头快很多， &lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-86&quot;&gt;        &lt;span&gt;# 在 Linux/Mac上 指定 V4L, FFMPEG 或者 GSTREAMER&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-87&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;cap&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;cv2&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;VideoCapture&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;,&lt;/span&gt; &lt;span&gt;cv2&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;CAP_DSHOW&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-88&quot;&gt;        &lt;span&gt;if&lt;/span&gt; &lt;span&gt;not&lt;/span&gt; &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;cap&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;isOpened&lt;/span&gt;&lt;span&gt;():&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-89&quot;&gt;            &lt;span&gt;print&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;&quot;1号摄像头不能打开&quot;&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-90&quot;&gt;            &lt;span&gt;return&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-91&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-92&quot;&gt;        &lt;span&gt;if&lt;/span&gt; &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;timer_camera&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;isActive&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;span&gt;==&lt;/span&gt; &lt;span&gt;False&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;  &lt;span&gt;# 若定时器未启动&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-93&quot;&gt;            &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;timer_camera&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;start&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;50&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-94&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-95&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-96&quot;&gt;    &lt;span&gt;def&lt;/span&gt; &lt;span&gt;show_camera&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;self&lt;/span&gt;&lt;span&gt;):&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-97&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-98&quot;&gt;        &lt;span&gt;ret&lt;/span&gt;&lt;span&gt;,&lt;/span&gt; &lt;span&gt;frame&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;cap&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;read&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;  &lt;span&gt;# 从视频流中读取&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-99&quot;&gt;        &lt;span&gt;if&lt;/span&gt; &lt;span&gt;not&lt;/span&gt; &lt;span&gt;ret&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-100&quot;&gt;            &lt;span&gt;return&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-101&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-102&quot;&gt;        &lt;span&gt;# 把读到的16:10帧的大小重新设置 &lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-103&quot;&gt;        &lt;span&gt;frame&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;cv2&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;resize&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;frame&lt;/span&gt;&lt;span&gt;,&lt;/span&gt; &lt;span&gt;(&lt;/span&gt;&lt;span&gt;520&lt;/span&gt;&lt;span&gt;,&lt;/span&gt; &lt;span&gt;400&lt;/span&gt;&lt;span&gt;))&lt;/span&gt;          </span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-104&quot;&gt;        &lt;span&gt;# 视频色彩转换回RGB，OpenCV images as BGR&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-105&quot;&gt;        &lt;span&gt;frame&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;cv2&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;cvtColor&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;frame&lt;/span&gt;&lt;span&gt;,&lt;/span&gt; &lt;span&gt;cv2&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;COLOR_BGR2RGB&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;  </span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-106&quot;&gt;        &lt;span&gt;qImage&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;QtGui&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;QImage&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;frame&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;data&lt;/span&gt;&lt;span&gt;,&lt;/span&gt; &lt;span&gt;frame&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;shape&lt;/span&gt;&lt;span&gt;[&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;],&lt;/span&gt; &lt;span&gt;frame&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;shape&lt;/span&gt;&lt;span&gt;[&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;],&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-107&quot;&gt;                                 &lt;span&gt;QtGui&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;QImage&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Format_RGB888&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;  &lt;span&gt;# 变成QImage形式&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-108&quot;&gt;        &lt;span&gt;# 往显示视频的Label里 显示QImage&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-109&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;label_ori_video&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;setPixmap&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;QtGui&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;QPixmap&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;fromImage&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;qImage&lt;/span&gt;&lt;span&gt;))&lt;/span&gt; </span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-110&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-111&quot;&gt;        &lt;span&gt;# 如果当前没有处理任务&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-112&quot;&gt;        &lt;span&gt;if&lt;/span&gt; &lt;span&gt;not&lt;/span&gt; &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;frameToAnalyze&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-113&quot;&gt;            &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;frameToAnalyze&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;append&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;frame&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-114&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-115&quot;&gt;    &lt;span&gt;def&lt;/span&gt; &lt;span&gt;frameAnalyzeThreadFunc&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;self&lt;/span&gt;&lt;span&gt;):&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-116&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-117&quot;&gt;        &lt;span&gt;while&lt;/span&gt; &lt;span&gt;True&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-118&quot;&gt;            &lt;span&gt;if&lt;/span&gt; &lt;span&gt;not&lt;/span&gt; &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;frameToAnalyze&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-119&quot;&gt;                &lt;span&gt;time&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;sleep&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;0.01&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-120&quot;&gt;                &lt;span&gt;continue&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-121&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-122&quot;&gt;            &lt;span&gt;frame&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;frameToAnalyze&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;pop&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-123&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-124&quot;&gt;            &lt;span&gt;results&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;model&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;frame&lt;/span&gt;&lt;span&gt;)[&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;]&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-125&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-126&quot;&gt;            &lt;span&gt;img&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;results&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;plot&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;line_width&lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;    </span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-127&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-128&quot;&gt;            &lt;span&gt;qImage&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;QtGui&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;QImage&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;img&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;data&lt;/span&gt;&lt;span&gt;,&lt;/span&gt; &lt;span&gt;img&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;shape&lt;/span&gt;&lt;span&gt;[&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;],&lt;/span&gt; &lt;span&gt;img&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;shape&lt;/span&gt;&lt;span&gt;[&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;],&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-129&quot;&gt;                                    &lt;span&gt;QtGui&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;QImage&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;Format_RGB888&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;  &lt;span&gt;# 变成QImage形式&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-130&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-131&quot;&gt;            &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;label_treated&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;setPixmap&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;QtGui&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;QPixmap&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;fromImage&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;qImage&lt;/span&gt;&lt;span&gt;))&lt;/span&gt;  &lt;span&gt;# 往显示Label里 显示QImage&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-132&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-133&quot;&gt;            &lt;span&gt;time&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;sleep&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;0.5&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-134&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-135&quot;&gt;    &lt;span&gt;def&lt;/span&gt; &lt;span&gt;stop&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;self&lt;/span&gt;&lt;span&gt;):&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-136&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;timer_camera&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;stop&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;  &lt;span&gt;# 关闭定时器&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-137&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;cap&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;release&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;  &lt;span&gt;# 释放视频流&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-138&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;label_ori_video&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;clear&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;  &lt;span&gt;# 清空视频显示区域        &lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-139&quot;&gt;        &lt;span&gt;self&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;label_treated&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;clear&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;  &lt;span&gt;# 清空视频显示区域&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-140&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-141&quot;&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-142&quot;&gt;&lt;span&gt;app&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;QtWidgets&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;QApplication&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-143&quot;&gt;&lt;span&gt;window&lt;/span&gt; &lt;span&gt;=&lt;/span&gt; &lt;span&gt;MWindow&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-144&quot;&gt;&lt;span&gt;window&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;show&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;span id=&quot;__span-0-145&quot;&gt;&lt;span&gt;app&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;exec&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;&lt;/code&gt;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chengming0916.github.io/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/Yolov8%E8%AE%AD%E7%BB%83%E8%87%AA%E5%B7%B1%E7%9A%84%E6%95%B0%E6%8D%AE%E9%9B%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Chemmy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/Yolov8%E8%AE%AD%E7%BB%83%E8%87%AA%E5%B7%B1%E7%9A%84%E6%95%B0%E6%8D%AE%E9%9B%86/" class="post-title-link" itemprop="url">YOLOv8训练自己的数据集</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-09-04 00:00:00" itemprop="dateCreated datePublished" datetime="2024-09-04T00:00:00+08:00">2024-09-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-04 16:58:11" itemprop="dateModified" datetime="2025-12-04T16:58:11+08:00">2025-12-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">编程技术</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/" itemprop="url" rel="index"><span itemprop="name">YOLOv8</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="一、Yolov8简介"><a href="#一、Yolov8简介" class="headerlink" title="一、Yolov8简介"></a>一、Yolov8简介</h2><h3 id="1、yolov8-源码地址："><a href="#1、yolov8-源码地址：" class="headerlink" title="1、yolov8 源码地址："></a>1、yolov8 源码地址：</h3><p>工程链接：<a target="_blank" rel="noopener" href="https://github.com/ultralytics/ultralytics" title="https://github.com/ultralytics/ultralytics">https://github.com/ultralytics/ultralytics</a></p>
<h3 id="2、官方文档："><a href="#2、官方文档：" class="headerlink" title="2、官方文档："></a>2、官方文档：</h3><p><a target="_blank" rel="noopener" href="https://docs.ultralytics.com/usage/cli/#train" title="CLI - Ultralytics YOLOv8 Docs">CLI - Ultralytics YOLOv8 Docs</a></p>
<h3 id="3、预训练模型百度网盘地址："><a href="#3、预训练模型百度网盘地址：" class="headerlink" title="3、预训练模型百度网盘地址："></a>3、<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E9%A2%84%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B&spm=1001.2101.3001.7020">预训练模型</a>百度网盘地址：</h3><p>训练时需要用到，下载的网址较慢：</p>
<p>如果模型下载不了，加QQ：187100248.</p>
<p>链接: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1YfMxRPGk8LF75a4cbgYxGg">https://pan.baidu.com/s/1YfMxRPGk8LF75a4cbgYxGg</a> 提取码: rd7b</p>
<h2 id="二、模型训练"><a href="#二、模型训练" class="headerlink" title="二、模型训练"></a>二、<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83&spm=1001.2101.3001.7020">模型训练</a></h2><h3 id="1、标定红绿灯数据："><a href="#1、标定红绿灯数据：" class="headerlink" title="1、标定红绿灯数据："></a>1、标定红绿灯数据：</h3><p>         类别为23类，分别为：</p>
<table><caption>红绿灯类别</caption><tbody><tr><td>red_light</td><td>green_light</td><td>yellow_light</td><td>off_light</td><td>part_ry_light</td><td>part_rg_light</td></tr><tr><td>part_yg_light</td><td>ryg_light</td><td>countdown_off_light</td><td>countdown_on_light</td><td>shade_light</td><td>zero</td></tr><tr><td>one</td><td>two</td><td>three</td><td>four</td><td>five</td><td>six</td></tr><tr><td>seven</td><td>eight</td><td>nine</td><td>brokeNumber</td><td>brokenLight</td><td></td></tr></tbody></table>

<p>        标注工具地址：<a target="_blank" rel="noopener" href="https://blog.csdn.net/zhulong1984/article/details/129676318" title="AI标注工具Labelme和LabelImage Labelme和LabelImage集成工具_labelimage与labelme-CSDN博客">AI标注工具Labelme和LabelImage Labelme和LabelImage集成工具_labelimage与labelme-CSDN博客</a></p>
<p><img src="/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/Yolov8%E8%AE%AD%E7%BB%83%E8%87%AA%E5%B7%B1%E7%9A%84%E6%95%B0%E6%8D%AE%E9%9B%86/IMG-20250804110742715.jpeg"></p>
<p>标注后图像格式</p>
<h3 id="2、训练环境："><a href="#2、训练环境：" class="headerlink" title="2、训练环境："></a>2、训练环境：</h3><p>1）、Ubuntu18.04；</p>
<p>2）、Cuda11.7 + CUDNN8.0.6；</p>
<p>3）、opencv4.5.5；</p>
<p>4）、PyTorch1.8.1-GPU；</p>
<p>5）、python3.9</p>
<h3 id="3、数据转化："><a href="#3、数据转化：" class="headerlink" title="3、数据转化："></a>3、数据转化：</h3><p> 1）、需要把上面标定的数据集中的.xml文件转换为.txt，转换代码为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line"></span><br><span class="line">import shutil</span><br><span class="line"></span><br><span class="line">import xml.etree.ElementTree as ET</span><br><span class="line"></span><br><span class="line">from xml.etree.ElementTree import Element, SubElement</span><br><span class="line"></span><br><span class="line">from PIL import Image</span><br><span class="line"></span><br><span class="line">import cv2</span><br><span class="line"></span><br><span class="line">classes = [&#x27;red_light&#x27;, &#x27;green_light&#x27;, &#x27;yellow_light&#x27;, &#x27;off_light&#x27;, &#x27;part_ry_light&#x27;, &#x27;part_rg_light&#x27;, &#x27;part_yg_light&#x27;, &#x27;ryg_light&#x27;,</span><br><span class="line"></span><br><span class="line">&#x27;countdown_off_light&#x27;, &#x27;countdown_on_light&#x27;,&#x27;shade_light&#x27;,&#x27;zero&#x27;,&#x27;one&#x27;,&#x27;two&#x27;,&#x27;three&#x27;,&#x27;four&#x27;,&#x27;five&#x27;,&#x27;six&#x27;,&#x27;seven&#x27;,</span><br><span class="line"></span><br><span class="line">&#x27;eight&#x27;,&#x27;nine&#x27;,&#x27;brokeNumber&#x27;,&#x27;brokenLight&#x27;]</span><br><span class="line"></span><br><span class="line">class Xml_make(object):</span><br><span class="line"></span><br><span class="line">def __init__(self):</span><br><span class="line"></span><br><span class="line">super().__init__()</span><br><span class="line"></span><br><span class="line">def __indent(self, elem, level=0):</span><br><span class="line"></span><br><span class="line">i = &quot;\n&quot; + level * &quot;\t&quot;</span><br><span class="line"></span><br><span class="line">if len(elem):</span><br><span class="line"></span><br><span class="line">if not elem.text or not elem.text.strip():</span><br><span class="line"></span><br><span class="line">elem.text = i + &quot;\t&quot;</span><br><span class="line"></span><br><span class="line">if not elem.tail or not elem.tail.strip():</span><br><span class="line"></span><br><span class="line">elem.tail = i</span><br><span class="line"></span><br><span class="line">for elem in elem:</span><br><span class="line"></span><br><span class="line">self.__indent(elem, level + 1)</span><br><span class="line"></span><br><span class="line">if not elem.tail or not elem.tail.strip():</span><br><span class="line"></span><br><span class="line">elem.tail = i</span><br><span class="line"></span><br><span class="line">else:</span><br><span class="line"></span><br><span class="line">if level and (not elem.tail or not elem.tail.strip()):</span><br><span class="line"></span><br><span class="line">elem.tail = i</span><br><span class="line"></span><br><span class="line">def _imageinfo(self, list_top):</span><br><span class="line"></span><br><span class="line">annotation_root = ET.Element(&#x27;annotation&#x27;)</span><br><span class="line"></span><br><span class="line">annotation_root.set(&#x27;verified&#x27;, &#x27;no&#x27;)</span><br><span class="line"></span><br><span class="line">tree = ET.ElementTree(annotation_root)</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">0:xml_savepath 1:folder,2:filename,3:path</span><br><span class="line"></span><br><span class="line">4:checked,5:width,6:height,7:depth</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">folder_element = ET.Element(&#x27;folder&#x27;)</span><br><span class="line"></span><br><span class="line">folder_element.text = list_top[1]</span><br><span class="line"></span><br><span class="line">annotation_root.append(folder_element)</span><br><span class="line"></span><br><span class="line">filename_element = ET.Element(&#x27;filename&#x27;)</span><br><span class="line"></span><br><span class="line">filename_element.text = list_top[2]</span><br><span class="line"></span><br><span class="line">annotation_root.append(filename_element)</span><br><span class="line"></span><br><span class="line">path_element = ET.Element(&#x27;path&#x27;)</span><br><span class="line"></span><br><span class="line">path_element.text = list_top[3]</span><br><span class="line"></span><br><span class="line">annotation_root.append(path_element)</span><br><span class="line"></span><br><span class="line"># checked_element = ET.Element(&#x27;checked&#x27;)</span><br><span class="line"></span><br><span class="line"># checked_element.text = list_top[4]</span><br><span class="line"></span><br><span class="line"># annotation_root.append(checked_element)</span><br><span class="line"></span><br><span class="line">source_element = ET.Element(&#x27;source&#x27;)</span><br><span class="line"></span><br><span class="line">database_element = SubElement(source_element, &#x27;database&#x27;)</span><br><span class="line"></span><br><span class="line">database_element.text = &#x27;Unknown&#x27;</span><br><span class="line"></span><br><span class="line">annotation_root.append(source_element)</span><br><span class="line"></span><br><span class="line">size_element = ET.Element(&#x27;size&#x27;)</span><br><span class="line"></span><br><span class="line">width_element = SubElement(size_element, &#x27;width&#x27;)</span><br><span class="line"></span><br><span class="line">width_element.text = str(list_top[5])</span><br><span class="line"></span><br><span class="line">height_element = SubElement(size_element, &#x27;height&#x27;)</span><br><span class="line"></span><br><span class="line">height_element.text = str(list_top[6])</span><br><span class="line"></span><br><span class="line">depth_element = SubElement(size_element, &#x27;depth&#x27;)</span><br><span class="line"></span><br><span class="line">depth_element.text = str(list_top[7])</span><br><span class="line"></span><br><span class="line">annotation_root.append(size_element)</span><br><span class="line"></span><br><span class="line">segmented_person_element = ET.Element(&#x27;segmented&#x27;)</span><br><span class="line"></span><br><span class="line">segmented_person_element.text = &#x27;0&#x27;</span><br><span class="line"></span><br><span class="line">annotation_root.append(segmented_person_element)</span><br><span class="line"></span><br><span class="line">return tree, annotation_root</span><br><span class="line"></span><br><span class="line">def _bndbox(self, annotation_root, list_bndbox):</span><br><span class="line"></span><br><span class="line">for i in range(0, len(list_bndbox), 9):</span><br><span class="line"></span><br><span class="line">object_element = ET.Element(&#x27;object&#x27;)</span><br><span class="line"></span><br><span class="line">name_element = SubElement(object_element, &#x27;name&#x27;)</span><br><span class="line"></span><br><span class="line">name_element.text = list_bndbox[i]</span><br><span class="line"></span><br><span class="line"># flag_element = SubElement(object_element, &#x27;flag&#x27;)</span><br><span class="line"></span><br><span class="line"># flag_element.text = list_bndbox[i + 1]</span><br><span class="line"></span><br><span class="line">pose_element = SubElement(object_element, &#x27;pose&#x27;)</span><br><span class="line"></span><br><span class="line">pose_element.text = list_bndbox[i + 2]</span><br><span class="line"></span><br><span class="line">truncated_element = SubElement(object_element, &#x27;truncated&#x27;)</span><br><span class="line"></span><br><span class="line">truncated_element.text = list_bndbox[i + 3]</span><br><span class="line"></span><br><span class="line">difficult_element = SubElement(object_element, &#x27;difficult&#x27;)</span><br><span class="line"></span><br><span class="line">difficult_element.text = list_bndbox[i + 4]</span><br><span class="line"></span><br><span class="line">bndbox_element = SubElement(object_element, &#x27;bndbox&#x27;)</span><br><span class="line"></span><br><span class="line">xmin_element = SubElement(bndbox_element, &#x27;xmin&#x27;)</span><br><span class="line"></span><br><span class="line">xmin_element.text = str(list_bndbox[i + 5])</span><br><span class="line"></span><br><span class="line">ymin_element = SubElement(bndbox_element, &#x27;ymin&#x27;)</span><br><span class="line"></span><br><span class="line">ymin_element.text = str(list_bndbox[i + 6])</span><br><span class="line"></span><br><span class="line">xmax_element = SubElement(bndbox_element, &#x27;xmax&#x27;)</span><br><span class="line"></span><br><span class="line">xmax_element.text = str(list_bndbox[i + 7])</span><br><span class="line"></span><br><span class="line">ymax_element = SubElement(bndbox_element, &#x27;ymax&#x27;)</span><br><span class="line"></span><br><span class="line">ymax_element.text = str(list_bndbox[i + 8])</span><br><span class="line"></span><br><span class="line">annotation_root.append(object_element)</span><br><span class="line"></span><br><span class="line">return annotation_root</span><br><span class="line"></span><br><span class="line">def txt_to_xml(self, list_top, list_bndbox):</span><br><span class="line"></span><br><span class="line">tree, annotation_root = self._imageinfo(list_top)</span><br><span class="line"></span><br><span class="line">annotation_root = self._bndbox(annotation_root, list_bndbox)</span><br><span class="line"></span><br><span class="line">self.__indent(annotation_root)</span><br><span class="line"></span><br><span class="line">tree.write(list_top[0], encoding=&#x27;utf-8&#x27;, xml_declaration=True)</span><br><span class="line"></span><br><span class="line">def txt_2_xml(source_path, xml_save_dir, jpg_save_dir,txt_dir):</span><br><span class="line"></span><br><span class="line">COUNT = 0</span><br><span class="line"></span><br><span class="line">for folder_path_tuple, folder_name_list, file_name_list in os.walk(source_path):</span><br><span class="line"></span><br><span class="line">for file_name in file_name_list:</span><br><span class="line"></span><br><span class="line">file_suffix = os.path.splitext(file_name)[-1]</span><br><span class="line"></span><br><span class="line">if file_suffix != &#x27;.jpg&#x27;:</span><br><span class="line"></span><br><span class="line">continue</span><br><span class="line"></span><br><span class="line">list_top = []</span><br><span class="line"></span><br><span class="line">list_bndbox = []</span><br><span class="line"></span><br><span class="line">path = os.path.join(folder_path_tuple, file_name)</span><br><span class="line"></span><br><span class="line">xml_save_path = os.path.join(xml_save_dir, file_name.replace(file_suffix, &#x27;.xml&#x27;))</span><br><span class="line"></span><br><span class="line">txt_path = os.path.join(txt_dir, file_name.replace(file_suffix, &#x27;.txt&#x27;))</span><br><span class="line"></span><br><span class="line">filename = file_name#os.path.splitext(file_name)[0]</span><br><span class="line"></span><br><span class="line">checked = &#x27;NO&#x27;</span><br><span class="line"></span><br><span class="line">#print(file_name)</span><br><span class="line"></span><br><span class="line">im = Image.open(path)</span><br><span class="line"></span><br><span class="line">im_w = im.size[0]</span><br><span class="line"></span><br><span class="line">im_h = im.size[1]</span><br><span class="line"></span><br><span class="line">shutil.copy(path, jpg_save_dir)</span><br><span class="line"></span><br><span class="line">if im_w*im_h &gt; 34434015:</span><br><span class="line"></span><br><span class="line">print(file_name)</span><br><span class="line"></span><br><span class="line">if im_w &lt; 100:</span><br><span class="line"></span><br><span class="line">print(file_name)</span><br><span class="line"></span><br><span class="line">width = str(im_w)</span><br><span class="line"></span><br><span class="line">height = str(im_h)</span><br><span class="line"></span><br><span class="line">depth = &#x27;3&#x27;</span><br><span class="line"></span><br><span class="line">flag = &#x27;rectangle&#x27;</span><br><span class="line"></span><br><span class="line">pose = &#x27;Unspecified&#x27;</span><br><span class="line"></span><br><span class="line">truncated = &#x27;0&#x27;</span><br><span class="line"></span><br><span class="line">difficult = &#x27;0&#x27;</span><br><span class="line"></span><br><span class="line">list_top.extend([xml_save_path, folder_path_tuple, filename, path, checked, width, height, depth])</span><br><span class="line"></span><br><span class="line">for line in open(txt_path, &#x27;r&#x27;):</span><br><span class="line"></span><br><span class="line">line = line.strip()</span><br><span class="line"></span><br><span class="line">info = line.split(&#x27; &#x27;)</span><br><span class="line"></span><br><span class="line">name = classes[int(info[0])]</span><br><span class="line"></span><br><span class="line">x_cen = float(info[1]) * im_w</span><br><span class="line"></span><br><span class="line">y_cen = float(info[2]) * im_h</span><br><span class="line"></span><br><span class="line">w = float(info[3]) * im_w</span><br><span class="line"></span><br><span class="line">h = float(info[4]) * im_h</span><br><span class="line"></span><br><span class="line">xmin = int(x_cen - w / 2) - 1</span><br><span class="line"></span><br><span class="line">ymin = int(y_cen - h / 2) - 1</span><br><span class="line"></span><br><span class="line">xmax = int(x_cen + w / 2) + 3</span><br><span class="line"></span><br><span class="line">ymax = int(y_cen + h / 2) + 3</span><br><span class="line"></span><br><span class="line">if xmin &lt; 0:</span><br><span class="line"></span><br><span class="line">xmin = 0</span><br><span class="line"></span><br><span class="line">if ymin &lt; 0:</span><br><span class="line"></span><br><span class="line">ymin = 0</span><br><span class="line"></span><br><span class="line">if xmax &gt; im_w - 1:</span><br><span class="line"></span><br><span class="line">xmax = im_w - 1</span><br><span class="line"></span><br><span class="line">if ymax &gt; im_h - 1:</span><br><span class="line"></span><br><span class="line">ymax = im_h - 1</span><br><span class="line"></span><br><span class="line">if w &gt; 5 and h &gt; 5:</span><br><span class="line"></span><br><span class="line">list_bndbox.extend([name, flag, pose, truncated, difficult,str(xmin), str(ymin), str(xmax), str(ymax)])</span><br><span class="line"></span><br><span class="line">if xmin &lt; 0 or xmax &gt; im_w - 1 or ymin &lt; 0 or ymax &gt; im_h - 1:</span><br><span class="line"></span><br><span class="line">print(xml_save_path)</span><br><span class="line"></span><br><span class="line">Xml_make().txt_to_xml(list_top, list_bndbox)</span><br><span class="line"></span><br><span class="line">COUNT += 1</span><br><span class="line"></span><br><span class="line">#print(COUNT, xml_save_path)</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line"></span><br><span class="line">out_xml_path = &quot;/home/TL_TrainData/&quot; # .xml输出文件存放地址</span><br><span class="line"></span><br><span class="line">out_jpg_path = &quot;/home/TL_TrainData/&quot; # .jpg输出文件存放地址</span><br><span class="line"></span><br><span class="line">txt_path = &quot;/home/Data/TrafficLight/trainData&quot; # yolov3标注.txt和图片文件夹</span><br><span class="line"></span><br><span class="line">images_path = &quot;/home/TrafficLight/trainData&quot; # image文件存放地址</span><br><span class="line"></span><br><span class="line">txt_2_xml(images_path, out_xml_path, out_jpg_path, txt_path)</span><br></pre></td></tr></table></figure>

<h3 id="4、构造训练数据："><a href="#4、构造训练数据：" class="headerlink" title="4、构造训练数据："></a>4、构造训练数据：</h3><p>2）、训练样本数据构造，需要把分成images和labels，images下面放入图片，labels下面放入.txt文件:</p>
<p><img src="/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/Yolov8%E8%AE%AD%E7%BB%83%E8%87%AA%E5%B7%B1%E7%9A%84%E6%95%B0%E6%8D%AE%E9%9B%86/IMG-20250804110742891.png" alt="分成images和labels"></p>
<p>分成images和labels</p>
<p><img src="/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/Yolov8%E8%AE%AD%E7%BB%83%E8%87%AA%E5%B7%B1%E7%9A%84%E6%95%B0%E6%8D%AE%E9%9B%86/IMG-20250804110743403.png"></p>
<p>images</p>
<p><img src="/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/Yolov8%E8%AE%AD%E7%BB%83%E8%87%AA%E5%B7%B1%E7%9A%84%E6%95%B0%E6%8D%AE%E9%9B%86/IMG-20250804110743666.png"></p>
<p>labels</p>
<h3 id="5、训练样本："><a href="#5、训练样本：" class="headerlink" title="5、训练样本："></a>5、训练样本：</h3><p> 1）、首先安装训练包：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install ultralytics</span><br></pre></td></tr></table></figure>

<p>2）、修改训练数据参数coco128_light.yaml文件，这个是自己修改的。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"># Ultralytics YOLO 🚀, AGPL-3.0 license</span><br><span class="line"></span><br><span class="line"># COCO128 dataset https://www.kaggle.com/ultralytics/coco128 (first 128 images from COCO train2017) by Ultralytics</span><br><span class="line"></span><br><span class="line"># Example usage: yolo train data=coco128.yaml</span><br><span class="line"></span><br><span class="line"># parent</span><br><span class="line"></span><br><span class="line"># ├── ultralytics</span><br><span class="line"></span><br><span class="line"># └── datasets</span><br><span class="line"></span><br><span class="line"># └── coco128 ← downloads here (7 MB)</span><br><span class="line"></span><br><span class="line"># Train/val/test sets as 1) dir: path/to/imgs, 2) file: path/to/imgs.txt, or 3) list: [path/to/imgs1, path/to/imgs2, ..]</span><br><span class="line"></span><br><span class="line">path: /home/Data/TrafficLight/datasets # dataset root dir</span><br><span class="line"></span><br><span class="line">train: images # train images (relative to &#x27;path&#x27;) 128 images</span><br><span class="line"></span><br><span class="line">val: images # val images (relative to &#x27;path&#x27;) 128 images</span><br><span class="line"></span><br><span class="line">test: # test images (optional)</span><br><span class="line"></span><br><span class="line"># Parameters</span><br><span class="line"></span><br><span class="line">nc: 23 # number of classes</span><br><span class="line"></span><br><span class="line"># Classes</span><br><span class="line"></span><br><span class="line">names:</span><br><span class="line"></span><br><span class="line">0: red_light</span><br><span class="line"></span><br><span class="line">1: green_light</span><br><span class="line"></span><br><span class="line">2: yellow_light</span><br><span class="line"></span><br><span class="line">3: off_light</span><br><span class="line"></span><br><span class="line">4: part_ry_light</span><br><span class="line"></span><br><span class="line">5: part_rg_light</span><br><span class="line"></span><br><span class="line">6: part_yg_light</span><br><span class="line"></span><br><span class="line">7: ryg_light</span><br><span class="line"></span><br><span class="line">8: countdown_off_light</span><br><span class="line"></span><br><span class="line">9: countdown_on_light</span><br><span class="line"></span><br><span class="line">10: shade_light</span><br><span class="line"></span><br><span class="line">11: zero</span><br><span class="line"></span><br><span class="line">12: one</span><br><span class="line"></span><br><span class="line">13: two</span><br><span class="line"></span><br><span class="line">14: three</span><br><span class="line"></span><br><span class="line">15: four</span><br><span class="line"></span><br><span class="line">16: five</span><br><span class="line"></span><br><span class="line">17: six</span><br><span class="line"></span><br><span class="line">18: seven</span><br><span class="line"></span><br><span class="line">19: eight</span><br><span class="line"></span><br><span class="line">20: nine</span><br><span class="line"></span><br><span class="line">21: brokeNumber</span><br><span class="line"></span><br><span class="line">22: brokenLight</span><br><span class="line"></span><br><span class="line"># Download script/URL (optional)</span><br><span class="line"></span><br><span class="line">#download: https://ultralytics.com/assets/coco128.zip</span><br></pre></td></tr></table></figure>

<p>3）、执行 train_yolov8x_light.sh，内容为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yolo detect train data=coco128_light.yaml model=./runs/last.pt epochs=100 imgsz=640 workers=16 batch=32</span><br></pre></td></tr></table></figure>

<p>        开始启动训练：</p>
<p><img src="/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/Yolov8%E8%AE%AD%E7%BB%83%E8%87%AA%E5%B7%B1%E7%9A%84%E6%95%B0%E6%8D%AE%E9%9B%86/IMG-20250804110743690.png"></p>
<p>模型训练启动</p>
<h2 id="三、验证模型："><a href="#三、验证模型：" class="headerlink" title="三、验证模型："></a>三、验证模型：</h2><h3 id="1、图像测试："><a href="#1、图像测试：" class="headerlink" title="1、图像测试："></a>1、图像测试：</h3><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ultralytics <span class="keyword">import</span> YOLO</span><br><span class="line"></span><br><span class="line">model = YOLO(<span class="string">&#x27;best.pt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">results = model(<span class="string">&#x27;bus.jpg&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> results:</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(r.boxes)</span><br></pre></td></tr></table></figure>

<h3 id="2、视频测试："><a href="#2、视频测试：" class="headerlink" title="2、视频测试："></a>2、视频测试：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">import cv2</span><br><span class="line"></span><br><span class="line">from ultralytics import YOLO</span><br><span class="line"></span><br><span class="line"># Load the YOLOv8 model</span><br><span class="line"></span><br><span class="line">model = YOLO(&#x27;best.pt&#x27;)</span><br><span class="line"></span><br><span class="line"># Open the video file</span><br><span class="line"></span><br><span class="line">video_path = &quot;test_car_person_1080P.mp4&quot;</span><br><span class="line"></span><br><span class="line">cap = cv2.VideoCapture(video_path)</span><br><span class="line"></span><br><span class="line"># Loop through the video frames</span><br><span class="line"></span><br><span class="line">while cap.isOpened():</span><br><span class="line"></span><br><span class="line"># Read a frame from the video</span><br><span class="line"></span><br><span class="line">success, frame = cap.read()</span><br><span class="line"></span><br><span class="line">if success:</span><br><span class="line"></span><br><span class="line"># Run YOLOv8 inference on the frame</span><br><span class="line"></span><br><span class="line">results = model(frame)</span><br><span class="line"></span><br><span class="line"># Visualize the results on the frame</span><br><span class="line"></span><br><span class="line">annotated_frame = results[0].plot()</span><br><span class="line"></span><br><span class="line"># Display the annotated frame</span><br><span class="line"></span><br><span class="line">cv2.imshow(&quot;YOLOv8 Inference&quot;, annotated_frame)</span><br><span class="line"></span><br><span class="line">cv2.waitKey(10)</span><br></pre></td></tr></table></figure>

<h2 id="四、导出ONNX"><a href="#四、导出ONNX" class="headerlink" title="四、导出ONNX"></a>四、导出ONNX</h2><p>1、训练输出，经过上面的训练后，得到训练生成文件，weights下生成了best.pt和last.pt：</p>
<p><img src="/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/Yolov8%E8%AE%AD%E7%BB%83%E8%87%AA%E5%B7%B1%E7%9A%84%E6%95%B0%E6%8D%AE%E9%9B%86/IMG-20250804110743875.png"></p>
<p>训练数据生成文件</p>
<p>2、等训练完毕后，利用best.pt生成best.onnx，执行命令如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yolo export model=best.pt imgsz=640 format=onnx opset=12</span><br></pre></td></tr></table></figure>

<h2 id="五、Opencv实现Yolov8-C-识别"><a href="#五、Opencv实现Yolov8-C-识别" class="headerlink" title="五、Opencv实现Yolov8 C++ 识别"></a>五、Opencv实现Yolov8 C++ 识别</h2><h3 id="1、开发环境："><a href="#1、开发环境：" class="headerlink" title="1、开发环境："></a>1、开发环境：</h3><p>1）、win7&#x2F;win10；</p>
<p>2）、vs2019；</p>
<p>3）、opencv4.7.0；</p>
<h3 id="2、main函数代码："><a href="#2、main函数代码：" class="headerlink" title="2、main函数代码："></a>2、main函数代码：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line"></span><br><span class="line">#include &lt;vector&gt;</span><br><span class="line"></span><br><span class="line">#include &quot;opencv2/opencv.hpp&quot;</span><br><span class="line"></span><br><span class="line">#include &quot;inference.h&quot;</span><br><span class="line"></span><br><span class="line">#include &lt;io.h&gt;</span><br><span class="line"></span><br><span class="line">#include &lt;thread&gt;</span><br><span class="line"></span><br><span class="line">#define socklen_t int</span><br><span class="line"></span><br><span class="line">#pragma comment (lib, &quot;ws2_32.lib&quot;)</span><br><span class="line"></span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">using namespace cv;</span><br><span class="line"></span><br><span class="line">int getFiles(std::string path, std::vector&lt;std::string&gt;&amp; files, std::vector&lt;std::string&gt;&amp; names)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">int i = 0;</span><br><span class="line"></span><br><span class="line">intptr_t hFile = 0;</span><br><span class="line"></span><br><span class="line">struct _finddata_t c_file;</span><br><span class="line"></span><br><span class="line">std::string imageFile = path + &quot;*.*&quot;;</span><br><span class="line"></span><br><span class="line">if ((hFile = _findfirst(imageFile.c_str(), &amp;c_file)) == -1L)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">_findclose(hFile);</span><br><span class="line"></span><br><span class="line">return -1;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">else</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">while (true)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">std::string strname(c_file.name);</span><br><span class="line"></span><br><span class="line">if (std::string::npos != strname.find(&quot;.jpg&quot;) || std::string::npos != strname.find(&quot;.png&quot;) || std::string::npos != strname.find(&quot;.bmp&quot;))</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">std::string fullName = path + c_file.name;</span><br><span class="line"></span><br><span class="line">files.push_back(fullName);</span><br><span class="line"></span><br><span class="line">std::string cutname = strname.substr(0, strname.rfind(&quot;.&quot;));</span><br><span class="line"></span><br><span class="line">names.push_back(cutname);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (_findnext(hFile, &amp;c_file) != 0)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">_findclose(hFile);</span><br><span class="line"></span><br><span class="line">break;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">return 0;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">std::string projectBasePath = &quot;./&quot;; // Set your ultralytics base path</span><br><span class="line"></span><br><span class="line">bool runOnGPU = true;</span><br><span class="line"></span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">// Pass in either:</span><br><span class="line"></span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">// &quot;yolov8s.onnx&quot; or &quot;yolov5s.onnx&quot;</span><br><span class="line"></span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">// To run Inference with yolov8/yolov5 (ONNX)</span><br><span class="line"></span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">// Note that in this example the classes are hard-coded and &#x27;classes.txt&#x27; is a place holder.</span><br><span class="line"></span><br><span class="line">Inference inf(projectBasePath + &quot;/best.onnx&quot;, cv::Size(640, 640), &quot;classes.txt&quot;, runOnGPU);</span><br><span class="line"></span><br><span class="line">std::vector&lt;std::string&gt; files;</span><br><span class="line"></span><br><span class="line">std::vector&lt;std::string&gt; names;</span><br><span class="line"></span><br><span class="line">getFiles(&quot;./test/&quot;, files, names);</span><br><span class="line"></span><br><span class="line">//std::vector&lt;std::string&gt; imageNames;</span><br><span class="line"></span><br><span class="line">//imageNames.push_back(projectBasePath + &quot;/test/20221104_8336.jpg&quot;);</span><br><span class="line"></span><br><span class="line">//imageNames.push_back(projectBasePath + &quot;/test/20221104_8339.jpg&quot;);</span><br><span class="line"></span><br><span class="line">for (int i = 0; i &lt; files.size(); ++i)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">cv::Mat frame = cv::imread(files[i]);</span><br><span class="line"></span><br><span class="line">// Inference starts here...</span><br><span class="line"></span><br><span class="line">clock_t start, end;</span><br><span class="line"></span><br><span class="line">float time;</span><br><span class="line"></span><br><span class="line">start = clock();</span><br><span class="line"></span><br><span class="line">std::vector&lt;Detection&gt; output = inf.runInference(frame);</span><br><span class="line"></span><br><span class="line">end = clock();</span><br><span class="line"></span><br><span class="line">time = (float)(end - start);//CLOCKS_PER_SEC;</span><br><span class="line"></span><br><span class="line">printf(&quot;timeCount = %f\n&quot;, time);</span><br><span class="line"></span><br><span class="line">int detections = output.size();</span><br><span class="line"></span><br><span class="line">std::cout &lt;&lt; &quot;Number of detections:&quot; &lt;&lt; detections &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">for (int i = 0; i &lt; detections; ++i)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">Detection detection = output[i];</span><br><span class="line"></span><br><span class="line">cv::Rect box = detection.box;</span><br><span class="line"></span><br><span class="line">cv::Scalar color = detection.color;</span><br><span class="line"></span><br><span class="line">// Detection box</span><br><span class="line"></span><br><span class="line">cv::rectangle(frame, box, color, 2);</span><br><span class="line"></span><br><span class="line">// Detection box text</span><br><span class="line"></span><br><span class="line">std::string classString = detection.className + &#x27; &#x27; + std::to_string(detection.confidence).substr(0, 4);</span><br><span class="line"></span><br><span class="line">cv::Size textSize = cv::getTextSize(classString, cv::FONT_HERSHEY_DUPLEX, 1, 2, 0);</span><br><span class="line"></span><br><span class="line">cv::Rect textBox(box.x, box.y - 40, textSize.width + 10, textSize.height + 20);</span><br><span class="line"></span><br><span class="line">cv::rectangle(frame, textBox, color, cv::FILLED);</span><br><span class="line"></span><br><span class="line">cv::putText(frame, classString, cv::Point(box.x + 5, box.y - 10), cv::FONT_HERSHEY_DUPLEX, 1, cv::Scalar(0, 0, 0), 2, 0);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Inference ends here...</span><br><span class="line"></span><br><span class="line">// This is only for preview purposes</span><br><span class="line"></span><br><span class="line">float scale = 0.8;</span><br><span class="line"></span><br><span class="line">cv::resize(frame, frame, cv::Size(frame.cols * scale, frame.rows * scale));</span><br><span class="line"></span><br><span class="line">cv::imshow(&quot;Inference&quot;, frame);</span><br><span class="line"></span><br><span class="line">cv::waitKey(10);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3、yolov8-头文件inference-h代码："><a href="#3、yolov8-头文件inference-h代码：" class="headerlink" title="3、yolov8 头文件inference.h代码："></a>3、yolov8 头文件inference.h代码：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">#ifndef INFERENCE_H</span><br><span class="line"></span><br><span class="line">#define INFERENCE_H</span><br><span class="line"></span><br><span class="line">// Cpp native</span><br><span class="line"></span><br><span class="line">#include &lt;fstream&gt;</span><br><span class="line"></span><br><span class="line">#include &lt;vector&gt;</span><br><span class="line"></span><br><span class="line">#include &lt;string&gt;</span><br><span class="line"></span><br><span class="line">#include &lt;random&gt;</span><br><span class="line"></span><br><span class="line">// OpenCV / DNN / Inference</span><br><span class="line"></span><br><span class="line">#include &lt;opencv2/imgproc.hpp&gt;</span><br><span class="line"></span><br><span class="line">#include &lt;opencv2/opencv.hpp&gt;</span><br><span class="line"></span><br><span class="line">#include &lt;opencv2/dnn.hpp&gt;</span><br><span class="line"></span><br><span class="line">struct Detection</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">int class_id&#123;0&#125;;</span><br><span class="line"></span><br><span class="line">std::string className&#123;&#125;;</span><br><span class="line"></span><br><span class="line">float confidence&#123;0.0&#125;;</span><br><span class="line"></span><br><span class="line">cv::Scalar color&#123;&#125;;</span><br><span class="line"></span><br><span class="line">cv::Rect box&#123;&#125;;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">class Inference</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">public:</span><br><span class="line"></span><br><span class="line">Inference(const std::string &amp;onnxModelPath, const cv::Size &amp;modelInputShape = &#123;640, 640&#125;, const std::string &amp;classesTxtFile = &quot;&quot;, const bool &amp;runWithCuda = true);</span><br><span class="line"></span><br><span class="line">std::vector&lt;Detection&gt; runInference(const cv::Mat &amp;input);</span><br><span class="line"></span><br><span class="line">private:</span><br><span class="line"></span><br><span class="line">void loadClassesFromFile();</span><br><span class="line"></span><br><span class="line">void loadOnnxNetwork();</span><br><span class="line"></span><br><span class="line">cv::Mat formatToSquare(const cv::Mat &amp;source);</span><br><span class="line"></span><br><span class="line">std::string modelPath&#123;&#125;;</span><br><span class="line"></span><br><span class="line">std::string classesPath&#123;&#125;;</span><br><span class="line"></span><br><span class="line">bool cudaEnabled&#123;&#125;;</span><br><span class="line"></span><br><span class="line">std::vector&lt;std::string&gt; classes&#123; &quot;red_light&quot;, &quot;green_light&quot;, &quot;yellow_light&quot;, &quot;off_light&quot;, &quot;part_ry_light&quot;, &quot;part_rg_light&quot;, &quot;part_yg_light&quot;, &quot;ryg_light&quot;,&quot;countdown_off_light&quot;, &quot;countdown_on_light&quot;,&quot;shade_light&quot;,&quot;zero&quot;,&quot;one&quot;,&quot;two&quot;,&quot;three&quot;,&quot;four&quot;,&quot;five&quot;,&quot;six&quot;,&quot;seven&quot;,&quot;eight&quot;,&quot;nine&quot;,&quot;brokeNumber&quot;,&quot;brokenLight&quot; &#125;;</span><br><span class="line"></span><br><span class="line">cv::Size2f modelShape&#123;&#125;;</span><br><span class="line"></span><br><span class="line">float modelConfidenceThreshold &#123;0.25&#125;;</span><br><span class="line"></span><br><span class="line">float modelScoreThreshold &#123;0.45&#125;;</span><br><span class="line"></span><br><span class="line">float modelNMSThreshold &#123;0.50&#125;;</span><br><span class="line"></span><br><span class="line">bool letterBoxForSquare = true;</span><br><span class="line"></span><br><span class="line">cv::dnn::Net net;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">#endif // INFERENCE_H</span><br></pre></td></tr></table></figure>

<h3 id="4、yolov8-cpp文件inference-cpp代码："><a href="#4、yolov8-cpp文件inference-cpp代码：" class="headerlink" title="4、yolov8 cpp文件inference.cpp代码："></a>4、yolov8 cpp文件inference.cpp代码：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;inference.h&quot;</span><br><span class="line"></span><br><span class="line">Inference::Inference(const std::string &amp;onnxModelPath, const cv::Size &amp;modelInputShape, const std::string &amp;classesTxtFile, const bool &amp;runWithCuda)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">modelPath = onnxModelPath;</span><br><span class="line"></span><br><span class="line">modelShape = modelInputShape;</span><br><span class="line"></span><br><span class="line">classesPath = classesTxtFile;</span><br><span class="line"></span><br><span class="line">cudaEnabled = runWithCuda;</span><br><span class="line"></span><br><span class="line">loadOnnxNetwork();</span><br><span class="line"></span><br><span class="line">// loadClassesFromFile(); The classes are hard-coded for this example</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">std::vector&lt;Detection&gt; Inference::runInference(const cv::Mat &amp;input)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">cv::Mat modelInput = input;</span><br><span class="line"></span><br><span class="line">if (letterBoxForSquare &amp;&amp; modelShape.width == modelShape.height)</span><br><span class="line"></span><br><span class="line">modelInput = formatToSquare(modelInput);</span><br><span class="line"></span><br><span class="line">cv::Mat blob;</span><br><span class="line"></span><br><span class="line">cv::dnn::blobFromImage(modelInput, blob, 1.0/255.0, modelShape, cv::Scalar(), true, false);</span><br><span class="line"></span><br><span class="line">net.setInput(blob);</span><br><span class="line"></span><br><span class="line">std::vector&lt;cv::Mat&gt; outputs;</span><br><span class="line"></span><br><span class="line">net.forward(outputs, net.getUnconnectedOutLayersNames());</span><br><span class="line"></span><br><span class="line">int rows = outputs[0].size[1];</span><br><span class="line"></span><br><span class="line">int dimensions = outputs[0].size[2];</span><br><span class="line"></span><br><span class="line">bool yolov8 = false;</span><br><span class="line"></span><br><span class="line">// yolov5 has an output of shape (batchSize, 25200, 85) (Num classes + box[x,y,w,h] + confidence[c])</span><br><span class="line"></span><br><span class="line">// yolov8 has an output of shape (batchSize, 84, 8400) (Num classes + box[x,y,w,h])</span><br><span class="line"></span><br><span class="line">if (dimensions &gt; rows) // Check if the shape[2] is more than shape[1] (yolov8)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">yolov8 = true;</span><br><span class="line"></span><br><span class="line">rows = outputs[0].size[2];</span><br><span class="line"></span><br><span class="line">dimensions = outputs[0].size[1];</span><br><span class="line"></span><br><span class="line">outputs[0] = outputs[0].reshape(1, dimensions);</span><br><span class="line"></span><br><span class="line">cv::transpose(outputs[0], outputs[0]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">float *data = (float *)outputs[0].data;</span><br><span class="line"></span><br><span class="line">float x_factor = modelInput.cols / modelShape.width;</span><br><span class="line"></span><br><span class="line">float y_factor = modelInput.rows / modelShape.height;</span><br><span class="line"></span><br><span class="line">std::vector&lt;int&gt; class_ids;</span><br><span class="line"></span><br><span class="line">std::vector&lt;float&gt; confidences;</span><br><span class="line"></span><br><span class="line">std::vector&lt;cv::Rect&gt; boxes;</span><br><span class="line"></span><br><span class="line">for (int i = 0; i &lt; rows; ++i)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">if (yolov8)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">float *classes_scores = data+4;</span><br><span class="line"></span><br><span class="line">cv::Mat scores(1, classes.size(), CV_32FC1, classes_scores);</span><br><span class="line"></span><br><span class="line">cv::Point class_id;</span><br><span class="line"></span><br><span class="line">double maxClassScore;</span><br><span class="line"></span><br><span class="line">minMaxLoc(scores, 0, &amp;maxClassScore, 0, &amp;class_id);</span><br><span class="line"></span><br><span class="line">if (maxClassScore &gt; modelScoreThreshold)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">confidences.push_back(maxClassScore);</span><br><span class="line"></span><br><span class="line">class_ids.push_back(class_id.x);</span><br><span class="line"></span><br><span class="line">float x = data[0];</span><br><span class="line"></span><br><span class="line">float y = data[1];</span><br><span class="line"></span><br><span class="line">float w = data[2];</span><br><span class="line"></span><br><span class="line">float h = data[3];</span><br><span class="line"></span><br><span class="line">int left = int((x - 0.5 * w) * x_factor);</span><br><span class="line"></span><br><span class="line">int top = int((y - 0.5 * h) * y_factor);</span><br><span class="line"></span><br><span class="line">int width = int(w * x_factor);</span><br><span class="line"></span><br><span class="line">int height = int(h * y_factor);</span><br><span class="line"></span><br><span class="line">boxes.push_back(cv::Rect(left, top, width, height));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">else // yolov5</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">float confidence = data[4];</span><br><span class="line"></span><br><span class="line">if (confidence &gt;= modelConfidenceThreshold)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">float *classes_scores = data+5;</span><br><span class="line"></span><br><span class="line">cv::Mat scores(1, classes.size(), CV_32FC1, classes_scores);</span><br><span class="line"></span><br><span class="line">cv::Point class_id;</span><br><span class="line"></span><br><span class="line">double max_class_score;</span><br><span class="line"></span><br><span class="line">minMaxLoc(scores, 0, &amp;max_class_score, 0, &amp;class_id);</span><br><span class="line"></span><br><span class="line">if (max_class_score &gt; modelScoreThreshold)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">confidences.push_back(confidence);</span><br><span class="line"></span><br><span class="line">class_ids.push_back(class_id.x);</span><br><span class="line"></span><br><span class="line">float x = data[0];</span><br><span class="line"></span><br><span class="line">float y = data[1];</span><br><span class="line"></span><br><span class="line">float w = data[2];</span><br><span class="line"></span><br><span class="line">float h = data[3];</span><br><span class="line"></span><br><span class="line">int left = int((x - 0.5 * w) * x_factor);</span><br><span class="line"></span><br><span class="line">int top = int((y - 0.5 * h) * y_factor);</span><br><span class="line"></span><br><span class="line">int width = int(w * x_factor);</span><br><span class="line"></span><br><span class="line">int height = int(h * y_factor);</span><br><span class="line"></span><br><span class="line">boxes.push_back(cv::Rect(left, top, width, height));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">data += dimensions;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">std::vector&lt;int&gt; nms_result;</span><br><span class="line"></span><br><span class="line">cv::dnn::NMSBoxes(boxes, confidences, modelScoreThreshold, modelNMSThreshold, nms_result);</span><br><span class="line"></span><br><span class="line">std::vector&lt;Detection&gt; detections&#123;&#125;;</span><br><span class="line"></span><br><span class="line">for (unsigned long i = 0; i &lt; nms_result.size(); ++i)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">int idx = nms_result[i];</span><br><span class="line"></span><br><span class="line">Detection result;</span><br><span class="line"></span><br><span class="line">result.class_id = class_ids[idx];</span><br><span class="line"></span><br><span class="line">result.confidence = confidences[idx];</span><br><span class="line"></span><br><span class="line">std::random_device rd;</span><br><span class="line"></span><br><span class="line">std::mt19937 gen(rd());</span><br><span class="line"></span><br><span class="line">std::uniform_int_distribution&lt;int&gt; dis(100, 255);</span><br><span class="line"></span><br><span class="line">result.color = cv::Scalar(dis(gen),</span><br><span class="line"></span><br><span class="line">dis(gen),</span><br><span class="line"></span><br><span class="line">dis(gen));</span><br><span class="line"></span><br><span class="line">result.className = classes[result.class_id];</span><br><span class="line"></span><br><span class="line">result.box = boxes[idx];</span><br><span class="line"></span><br><span class="line">detections.push_back(result);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">return detections;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void Inference::loadClassesFromFile()</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">std::ifstream inputFile(classesPath);</span><br><span class="line"></span><br><span class="line">if (inputFile.is_open())</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">std::string classLine;</span><br><span class="line"></span><br><span class="line">while (std::getline(inputFile, classLine))</span><br><span class="line"></span><br><span class="line">classes.push_back(classLine);</span><br><span class="line"></span><br><span class="line">inputFile.close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void Inference::loadOnnxNetwork()</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">net = cv::dnn::readNetFromONNX(modelPath);</span><br><span class="line"></span><br><span class="line">if (cudaEnabled)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">std::cout &lt;&lt; &quot;\nRunning on CUDA&quot; &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">net.setPreferableBackend(cv::dnn::DNN_BACKEND_CUDA);</span><br><span class="line"></span><br><span class="line">net.setPreferableTarget(cv::dnn::DNN_TARGET_CUDA);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">else</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">std::cout &lt;&lt; &quot;\nRunning on CPU&quot; &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">net.setPreferableBackend(cv::dnn::DNN_BACKEND_OPENCV);</span><br><span class="line"></span><br><span class="line">net.setPreferableTarget(cv::dnn::DNN_TARGET_CPU);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">cv::Mat Inference::formatToSquare(const cv::Mat &amp;source)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">int col = source.cols;</span><br><span class="line"></span><br><span class="line">int row = source.rows;</span><br><span class="line"></span><br><span class="line">int _max = MAX(col, row);</span><br><span class="line"></span><br><span class="line">cv::Mat result = cv::Mat::zeros(_max, _max, CV_8UC3);</span><br><span class="line"></span><br><span class="line">source.copyTo(result(cv::Rect(0, 0, col, row)));</span><br><span class="line"></span><br><span class="line">return result;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4、效果图：</p>
<p><img src="/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/Yolov8%E8%AE%AD%E7%BB%83%E8%87%AA%E5%B7%B1%E7%9A%84%E6%95%B0%E6%8D%AE%E9%9B%86/IMG-20250804110743968.jpeg"></p>
<p>vs2019工程运行结果</p>
<p><img src="/2024/09/04/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/Python/YOLOv8/Yolov8%E8%AE%AD%E7%BB%83%E8%87%AA%E5%B7%B1%E7%9A%84%E6%95%B0%E6%8D%AE%E9%9B%86/IMG-20250804110743995.jpeg"></p>
<p>红绿灯识别结果</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="上一页" aria-label="上一页" href="/page/4/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/20/">20</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="/page/6/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2015 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Chemmy</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>
<script class="next-config" data-name="giscus" type="application/json">{"enable":true,"repo":"chengming0916/chengming0916.github.io","repo_id":"R_kgDOLemcag","category":"Announcements","category_id":"DIC_kwDOLemcas4CupMn","mapping":"title","strict":0,"reactions_enabled":1,"emit_metadata":1,"theme":"light","lang":"zh-CN","crossorigin":"anonymous","input_position":"bottom","loading":"lazy"}</script>

<script>
document.addEventListener('page:loaded', () => {
  if (!CONFIG.page.comments) return;

  NexT.utils.loadComments('.giscus-container')
    .then(() => NexT.utils.getScript('https://giscus.app/client.js', {
      attributes: {
        async                   : true,
        crossOrigin             : 'anonymous',
        'data-repo'             : CONFIG.giscus.repo,
        'data-repo-id'          : CONFIG.giscus.repo_id,
        'data-category'         : CONFIG.giscus.category,
        'data-category-id'      : CONFIG.giscus.category_id,
        'data-mapping'          : CONFIG.giscus.mapping,
        'data-strict'           : CONFIG.giscus.strict,
        'data-reactions-enabled': CONFIG.giscus.reactions_enabled,
        'data-emit-metadata'    : CONFIG.giscus.emit_metadata,
        'data-theme'            : CONFIG.giscus.theme,
        'data-lang'             : CONFIG.giscus.lang,
        'data-input-position'   : CONFIG.giscus.input_position,
        'data-loading'          : CONFIG.giscus.loading
      },
      parentNode: document.querySelector('.giscus-container')
    }));
});
</script>

</body>
</html>
