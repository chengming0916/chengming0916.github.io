<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous" defer></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"chengming0916.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.26.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.json","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="Chemmy&#39;s Blog">
<meta property="og:url" content="http://chengming0916.github.io/page/11/index.html">
<meta property="og:site_name" content="Chemmy&#39;s Blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Chemmy">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://chengming0916.github.io/page/11/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/11/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Chemmy's Blog</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>





  <script src="/js/third-party/pace.js" defer></script>


  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Chemmy's Blog</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">chengming0916@outlook.com</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Chemmy"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Chemmy</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">194</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">26</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">183</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/chengming0916" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;chengming0916" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/chengming0916@outlook.com" title="E-Mail → chengming0916@outlook.com" rel="noopener me"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chengming0916.github.io/2022/01/01/Linux/Linux%E8%AE%BE%E7%BD%AEswap%E5%88%86%E5%8C%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Chemmy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/01/01/Linux/Linux%E8%AE%BE%E7%BD%AEswap%E5%88%86%E5%8C%BA/" class="post-title-link" itemprop="url">Linux设置swap分区</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-01-01 00:00:00" itemprop="dateCreated datePublished" datetime="2022-01-01T00:00:00+08:00">2022-01-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-04 16:58:10" itemprop="dateModified" datetime="2025-12-04T16:58:10+08:00">2025-12-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chengming0916.github.io/2022/01/01/Linux/Systemd%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Chemmy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/01/01/Linux/Systemd%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86/" class="post-title-link" itemprop="url">Systemd服务管理</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-01-01 00:00:00" itemprop="dateCreated datePublished" datetime="2022-01-01T00:00:00+08:00">2022-01-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-04 16:58:10" itemprop="dateModified" datetime="2025-12-04T16:58:10+08:00">2025-12-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1516125">可能是史上最全面易懂的 Systemd 服务管理教程！( 强烈建议收藏 )-腾讯云开发者社区-腾讯云 (tencent.com)</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chengming0916.github.io/2021/10/22/Hexo%E5%8D%9A%E5%AE%A2/Hexo-%E5%8D%9A%E5%AE%A2%E9%85%8D%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Chemmy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/10/22/Hexo%E5%8D%9A%E5%AE%A2/Hexo-%E5%8D%9A%E5%AE%A2%E9%85%8D%E7%BD%AE/" class="post-title-link" itemprop="url">Hexo 博客配置</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-10-22 09:32:52" itemprop="dateCreated datePublished" datetime="2021-10-22T09:32:52+08:00">2021-10-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-04 16:58:10" itemprop="dateModified" datetime="2025-12-04T16:58:10+08:00">2025-12-04</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><p>本地安装 Git NodeJS</p>
<p>检查环境</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git -v</span><br><span class="line"></span><br><span class="line">node -v</span><br><span class="line"></span><br><span class="line">npm -v</span><br></pre></td></tr></table></figure>

<p>切换镜像站,具体参考<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/1903405138527384159">NPM配置国内源</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npmmirror.com</span><br></pre></td></tr></table></figure>

<h2 id="Hexo环境搭建"><a href="#Hexo环境搭建" class="headerlink" title="Hexo环境搭建"></a>Hexo环境搭建</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">pnpm install -g hexo-cli                <span class="comment"># 安装Hexo cli工具</span></span><br><span class="line"></span><br><span class="line">hexo init                            <span class="comment"># 初始化博客环境</span></span><br><span class="line">npm install                          <span class="comment"># 安装依赖库</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 插件</span></span><br><span class="line">npm install hexo-asset-img           <span class="comment"># 头像</span></span><br><span class="line">npm install hexo-auto-category       <span class="comment"># 自动分类</span></span><br><span class="line">npm install hexo-generator-searchdb  <span class="comment"># 生成搜索数据库</span></span><br><span class="line">npm install hexo-backlink            <span class="comment"># Obsdian链接转换</span></span><br><span class="line">npm install hexo-deploy-git          <span class="comment"># git自动发布</span></span><br><span class="line">npm install hexo-theme-next          <span class="comment"># hexo NexT主题</span></span><br><span class="line">npm install hexo-server              <span class="comment"># hexo服务器</span></span><br><span class="line">npm install hexo-next-giscus         <span class="comment"># giscus评论组件</span></span><br><span class="line">npm install hexo-wordcount           <span class="comment"># 字数统计</span></span><br></pre></td></tr></table></figure>

<h2 id="Hexo-配置"><a href="#Hexo-配置" class="headerlink" title="Hexo 配置"></a>Hexo 配置</h2><p>参考<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/configuration">官方文档</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">theme: next     # 配置主题next</span><br><span class="line"></span><br><span class="line">giscus:         # 评论配置</span><br><span class="line">  enable: true</span><br><span class="line">  repo:  # Github repository name</span><br><span class="line">  repo_id: # Github repository id</span><br><span class="line">  category: # Github discussion category</span><br><span class="line">  category_id: # Github discussion category id</span><br><span class="line">  # Available values: pathname | url | title | og:title</span><br><span class="line">  mapping: title</span><br><span class="line">  # Available values: 0 | 1</span><br><span class="line">  reactions_enabled: 1</span><br><span class="line">   # Available values: 0 | 1</span><br><span class="line">  emit_metadata: 1</span><br><span class="line">  # Available values: light | light_high_contrast | light_protanopia | light_tritanopia | dark | dark_high_contrast | dark_protanopia | dark_tritanopia | dark_dimmed | preferred_color_scheme | transparent_dark | noborder_light | noborder_dark | noborder_gray | cobalt | purple_dark</span><br><span class="line">  theme: light</span><br><span class="line">  # Available values: en | zh-CN</span><br><span class="line">  lang: zh-CN</span><br><span class="line">  # Place the comment box above the comments</span><br><span class="line">  input_position: bottom</span><br><span class="line">  # Load the comments lazily</span><br><span class="line">  loading: lazy</span><br><span class="line">  </span><br><span class="line">deploy:   # 发布配置</span><br><span class="line">  - type: git</span><br><span class="line">    repo:        # 仓库发布地址</span><br><span class="line">    branch: main # 发布分支</span><br><span class="line">    name:        # git用户名 git config user.name &lt;username&gt;</span><br><span class="line">    email:       # git邮箱 git config user.email &lt;email&gt;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p><strong>注意</strong>： 评论部分需要借助Github Discussions, 参考<a href="Hexo%E5%8D%9A%E5%AE%A2%E9%85%8D%E7%BD%AEGiscus%E8%AF%84%E8%AE%BA.md">Hexo博客配置Giscus评论</a></p>
<h2 id="Hexo主题配置"><a href="#Hexo主题配置" class="headerlink" title="Hexo主题配置"></a>Hexo主题配置</h2><p>安装主题后从<code>npm_modules/&lt;主题名&gt;/</code>文件夹中复制<code>_config.yml</code>到博客根目录并重命名为<code>_config.next.yml</code>,当博客deploy时回自动应用主题配置，一下主题修改都基于此文件进行。</p>
<h3 id="设置语言"><a href="#设置语言" class="headerlink" title="设置语言"></a>设置语言</h3><p>NexT主题支持多种语言，只需要编辑<code>_config.next.yml</code>中的<code>language</code>设置即可</p>
<table>
<thead>
<tr>
<th>语言</th>
<th>代码</th>
<th>设定示例</th>
</tr>
</thead>
<tbody><tr>
<td>English</td>
<td>en</td>
<td>language: en</td>
</tr>
<tr>
<td>简体中文</td>
<td>zh-CN（注：zh-Hans已经无法使用）</td>
<td>language: zh-CN</td>
</tr>
<tr>
<td>Frangais</td>
<td>fr-FR</td>
<td>language: fr-FR</td>
</tr>
<tr>
<td>Portugues</td>
<td>pt</td>
<td>language: pt  <br>或者  <br>language:pt-BR</td>
</tr>
<tr>
<td>繁體中文</td>
<td>zh-hk  <br>或者  <br>zh-tw</td>
<td>language: zh-hk</td>
</tr>
<tr>
<td>Pycckmi 93bIK</td>
<td>ru</td>
<td>language: ru</td>
</tr>
<tr>
<td>Deutsch</td>
<td>de</td>
<td>language: de</td>
</tr>
<tr>
<td>日本語</td>
<td>ja</td>
<td>language: ja</td>
</tr>
<tr>
<td>Indonesian</td>
<td>id</td>
<td>language: id</td>
</tr>
<tr>
<td>Korean</td>
<td>ko</td>
<td>language: ko</td>
</tr>
<tr>
<td>如果需要添加非内置的字段需要手动添加翻译文件，例如中文的翻译文件路径为<code>node_modules/next/languages/zh-CN.yml</code></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="设置关于"><a href="#设置关于" class="headerlink" title="设置关于"></a>设置关于</h3><p>在<code>source/about/index.md</code>中添加如下内容</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 关于</span><br><span class="line"><span class="section">date: 2025-08-27 00:00:00</span></span><br><span class="line"><span class="section">---</span></span><br><span class="line"></span><br><span class="line">&lt;个人信息&gt;</span><br></pre></td></tr></table></figure>

<h3 id="选择Scheme"><a href="#选择Scheme" class="headerlink" title="选择Scheme"></a>选择Scheme</h3><p>Scheme 是 NexT 提供的一种特性，借助于 Scheme，NexT 为你提供多种不同的外观。同时，几乎所有的配置都可以 在 Scheme 之间共用。目前 NexT 支持三种 Schem</p>
<ul>
<li>Muse - 默认 Scheme</li>
<li>Mist - Muse 的紧凑版本</li>
<li>Pisces - 双栏 Scheme</li>
<li>Gemini</li>
</ul>
<h3 id="菜单配置"><a href="#菜单配置" class="headerlink" title="菜单配置"></a>菜单配置</h3><p>菜单配置包括三个部分，第一是菜单项（名称和链接），第二是菜单项的显示文本，第三是菜单项对应的图标。 NexT 使用的是 <a target="_blank" rel="noopener" href="http://fontawesome.io/">Font Awesome</a> 提供的图标， Font Awesome 提供了 600+ 的图标，可以满足绝大的多数的场景，同时无须担心在 Retina 屏幕下 图标模糊的问题。</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu: home:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">home</span> </span><br><span class="line"><span class="attr">categories:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">th</span> </span><br><span class="line"><span class="attr">archives:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">archive</span> </span><br><span class="line"><span class="attr">tags:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">tags</span> </span><br><span class="line"><span class="comment">#schedule: /schedule/ || calendar </span></span><br><span class="line"><span class="comment">#sitemap: /sitemap.xml || sitemap </span></span><br><span class="line"><span class="comment">#commonweal: /404/ || heartbeat </span></span><br><span class="line"><span class="attr">about:</span> <span class="string">/about/</span> <span class="string">||</span> <span class="string">user</span></span><br></pre></td></tr></table></figure>

<p>NexT 默认的菜单项有（标注 <code>* </code>的项表示需要手动创建这个页面）：</p>
<p><strong>注意</strong>: 若站点运行在子目录中，请将链接前缀的 &#x2F; 去掉。</p>
<table>
<thead>
<tr>
<th align="left">键值</th>
<th align="left">设定值</th>
<th align="left">显示文本（简体中文）</th>
</tr>
</thead>
<tbody><tr>
<td align="left">home</td>
<td align="left">home: &#x2F;</td>
<td align="left">主页</td>
</tr>
<tr>
<td align="left">archives</td>
<td align="left">archives: &#x2F;archives</td>
<td align="left">归档页</td>
</tr>
<tr>
<td align="left">categories</td>
<td align="left">categories: &#x2F;categories</td>
<td align="left">分类页<code> *</code></td>
</tr>
<tr>
<td align="left">tags</td>
<td align="left">tags: &#x2F;tags</td>
<td align="left">标签页 <code>*</code></td>
</tr>
<tr>
<td align="left">about</td>
<td align="left">about: &#x2F;about</td>
<td align="left">关于页面<code>*</code></td>
</tr>
<tr>
<td align="left">commonweal</td>
<td align="left">commonweal: &#x2F;404.html</td>
<td align="left">公益 404 !</td>
</tr>
</tbody></table>
<h3 id="侧栏配置"><a href="#侧栏配置" class="headerlink" title="侧栏配置"></a>侧栏配置</h3><p>默认情况下，侧栏仅在文章页面（拥有目录列表）时才显示，并放置于右侧位置。配置具体如下</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">...</span></span><br><span class="line"></span><br><span class="line"><span class="attr">sidbar:</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">left</span>     <span class="comment"># 配置侧栏居左</span></span><br><span class="line">  <span class="attr">display:</span> <span class="string">post</span>      <span class="comment"># 侧栏显示行为</span></span><br><span class="line"></span><br><span class="line"><span class="string">...</span></span><br></pre></td></tr></table></figure>

<p>侧栏显示位置支持</p>
<ul>
<li><code>left</code>:  居左显示</li>
<li><code>right</code>:  居右显示</li>
</ul>
<p>侧栏显示行为支持</p>
<ul>
<li><code>post</code> 默认行为，在文章页面（拥有目录列表）时显示</li>
<li><code>always</code> 所有页面都显示</li>
<li><code>hide</code> 在所有页面中都隐藏（可以手动展开）</li>
<li><code>remove</code> 完全移除</li>
</ul>
<p>注册Github账号,Gitea账号(可选)<br>[^注] Github由于网络问题会经常无法链接，可使用Gitea作为中转，先将代码提交道Gitea，然后Gitea配置自动推送到Github</p>
<h3 id="设置头像"><a href="#设置头像" class="headerlink" title="设置头像"></a>设置头像</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">avatar: /images/avatar.jpg</span><br></pre></td></tr></table></figure>

<p>头像地址如果是以<code>/</code>起始则表示头像图片放置在博客发布后的目录下，例如测试博客地址是<code>http://localhost:4000</code>,头像图片地址为<code>http://localhost:4000/images/avatar.jpg</code><br>此配置需要在博客的<code>source/images</code>目录中放置头像图片<code>avatar.jpg</code></p>
<h3 id="侧边栏社交链接"><a href="#侧边栏社交链接" class="headerlink" title="侧边栏社交链接"></a>侧边栏社交链接</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">social:</span><br><span class="line">  #GitHub: https://github.com/&lt;username&gt; || fab fa-github</span><br><span class="line">  #E-Mail: &lt;email&gt; || fa fa-envelope</span><br><span class="line">  #Weibo: https://weibo.com/yourname || fab fa-weibo</span><br><span class="line">  #Twitter: https://twitter.com/yourname || fab fa-twitter</span><br><span class="line">  #FB Page: https://www.facebook.com/yourname || fab fa-facebook</span><br><span class="line">  #StackOverflow: https://stackoverflow.com/yourname || fab fa-stack-overflow</span><br><span class="line">  #YouTube: https://youtube.com/yourname || fab fa-youtube</span><br><span class="line">  #Instagram: https://instagram.com/yourname || fab fa-instagram</span><br><span class="line">  #Skype: skype:yourname?call|chat || fab fa-skype</span><br></pre></td></tr></table></figure>

<p>next主题默认支持的社交链接 <code>||</code>符号后是链接的图标</p>
<p>使用已有配置放开注释即可，如果要添加默认不存在链接示例如下</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">social:</span></span><br><span class="line">  <span class="string">微信:</span> <span class="string">https://wx.qq.com</span> <span class="string">||</span> <span class="string">weixin</span></span><br></pre></td></tr></table></figure>


<p><strong>注意</strong>: 图标对应的名称是FontAwesom图标的名称（不必带 <code>fa-</code> 前缀）</p>
<h3 id="打赏功能"><a href="#打赏功能" class="headerlink" title="打赏功能"></a>打赏功能</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Reward </span></span><br><span class="line"><span class="attr">reward:</span> </span><br><span class="line">  <span class="attr">wechatpay:</span> <span class="string">/images/custom/wechatpay.jpg</span> </span><br><span class="line">  <span class="attr">alipay:</span> <span class="string">/images/custom/alipay.jpg</span> </span><br></pre></td></tr></table></figure>
<p>放开此部分注释并在<code>source/images</code>中放入收款码图片</p>
<h3 id="站点建立时间"><a href="#站点建立时间" class="headerlink" title="站点建立时间"></a>站点建立时间</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">footer:</span></span><br><span class="line">  <span class="attr">since:</span> <span class="number">2025</span></span><br></pre></td></tr></table></figure>

<h3 id="订阅微信公众号"><a href="#订阅微信公众号" class="headerlink" title="订阅微信公众号"></a>订阅微信公众号</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Wechat Subscriber </span><br><span class="line">wechat_subscriber: </span><br><span class="line">  enabled: true </span><br><span class="line">  qcode: /images/wechat-qcode.jpg </span><br><span class="line">  description: 欢迎您扫一扫上面的微信公众号，订阅我的博客！</span><br></pre></td></tr></table></figure>
<p>放开此部分注释，并在<code>source/images</code>中放入公众号二维码</p>
<p><strong>注意</strong>: 此功能需要NexT版本在5.0.1之后</p>
<h3 id="设置动画"><a href="#设置动画" class="headerlink" title="设置动画"></a>设置动画</h3><p>NexT 默认开启动画效果，效果使用 JavaScript 编写，因此需要等待 JavaScript 脚本完全加载完毕后才会显示内容。 如果您比较在乎速度，可以将设置此字段的值为 <code>false</code> 来关闭动画。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># Use velocity to animate everything. </span><br><span class="line">motion: </span><br><span class="line">  enable: true </span><br><span class="line">  async: true </span><br><span class="line">  transition: </span><br><span class="line">    # Transition variants: </span><br><span class="line">    # fadeIn | fadeOut | flipXIn | flipXOut | flipYIn | flipYOut | flipBounceXIn | flipBounceXOut | flipBounceYIn | flipBounceYOut </span><br><span class="line">    # swoopIn | swoopOut | whirlIn | whirlOut | shrinkIn | shrinkOut | expandIn | expandOut </span><br><span class="line">    # bounceIn | bounceOut | bounceUpIn | bounceUpOut | bounceDownIn | bounceDownOut | bounceLeftIn | bounceLeftOut | bounceRightIn | bounceRightOut </span><br><span class="line">    # slideUpIn | slideUpOut | slideDownIn | slideDownOut | slideLeftIn | slideLeftOut | slideRightIn | slideRightOut </span><br><span class="line">    # slideUpBigIn | slideUpBigOut | slideDownBigIn | slideDownBigOut | slideLeftBigIn | slideLeftBigOut | slideRightBigIn | slideRightBigOut </span><br><span class="line">    # perspectiveUpIn | perspectiveUpOut | perspectiveDownIn | perspectiveDownOut | perspectiveLeftIn | perspectiveLeftOut | perspectiveRightIn | perspectiveRightOut </span><br><span class="line">    post_block: fadeIn </span><br><span class="line">    post_header: slideDownIn </span><br><span class="line">    post_body: slideDownIn </span><br><span class="line">    coll_header: slideLeftIn # Only for Pisces | Gemini. </span><br><span class="line">    sidebar: slideUpIn</span><br></pre></td></tr></table></figure>

<h3 id="设置全文阅读"><a href="#设置全文阅读" class="headerlink" title="设置全文阅读"></a>设置全文阅读</h3><p>在首页显示一篇文章的部分内容，并提供一个链接跳转到全文页面是一个常见的需求。 NexT 提供三种方式来控制文章在首页的显示方式。</p>
<ul>
<li>在文章中使用 <code>&lt;!-- more --&gt;</code> 手动进行截断，Hexo 提供的方式 <strong>推荐</strong>。</li>
<li>在文章的 front-matter 中添加 description，并提供文章摘录</li>
<li>自动形成摘要，需要添加如下配置<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Automatically Excerpt. Not recommend. </span></span><br><span class="line"><span class="comment"># Please use &lt;!-- more --&gt; in the post to control excerpt accurately. </span></span><br><span class="line"><span class="attr">auto_excerpt:</span> </span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> </span><br><span class="line">  <span class="attr">length:</span> <span class="number">150</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="设置字数统计-阅读时长"><a href="#设置字数统计-阅读时长" class="headerlink" title="设置字数统计&#x2F;阅读时长"></a>设置字数统计&#x2F;阅读时长</h3><p>在<code>_config.yml</code>中配置如下</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Post wordcount display settings </span></span><br><span class="line"><span class="comment"># Dependencies: https://github.com/willin/hexo-wordcount </span></span><br><span class="line"><span class="attr">post_wordcount:</span> </span><br><span class="line">  <span class="attr">item_text:</span> <span class="literal">true</span> </span><br><span class="line">  <span class="attr">wordcount:</span> <span class="literal">true</span> </span><br><span class="line">  <span class="attr">min2read:</span> <span class="literal">true</span> </span><br><span class="line">  <span class="attr">totalcount:</span> <span class="literal">false</span> </span><br><span class="line">  <span class="attr">separated_meta:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h3 id="加载进度条"><a href="#加载进度条" class="headerlink" title="加载进度条"></a>加载进度条</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Progress bar in the top during page loading.</span></span><br><span class="line"><span class="attr">pace:</span> <span class="literal">true</span></span><br><span class="line"><span class="comment"># Themes list:</span></span><br><span class="line"><span class="comment">#pace-theme-big-counter</span></span><br><span class="line"><span class="comment">#pace-theme-bounce</span></span><br><span class="line"><span class="comment">#pace-theme-barber-shop</span></span><br><span class="line"><span class="comment">#pace-theme-center-atom</span></span><br><span class="line"><span class="comment">#pace-theme-center-circle</span></span><br><span class="line"><span class="comment">#pace-theme-center-radar</span></span><br><span class="line"><span class="comment">#pace-theme-center-simple</span></span><br><span class="line"><span class="comment">#pace-theme-corner-indicator</span></span><br><span class="line"><span class="comment">#pace-theme-fill-left</span></span><br><span class="line"><span class="comment">#pace-theme-flash</span></span><br><span class="line"><span class="comment">#pace-theme-loading-bar</span></span><br><span class="line"><span class="comment">#pace-theme-mac-osx</span></span><br><span class="line"><span class="comment">#pace-theme-minimal</span></span><br><span class="line"><span class="comment"># For example</span></span><br><span class="line"><span class="comment"># pace_theme: pace-theme-center-simple</span></span><br><span class="line"><span class="attr">pace_theme:</span> <span class="string">pace-theme-minimal</span></span><br></pre></td></tr></table></figure>

<h3 id="搜索服务"><a href="#搜索服务" class="headerlink" title="搜索服务"></a>搜索服务</h3><p>在<code>_config.yml</code>中配置如下</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># hexo-generator-searchdb </span></span><br><span class="line"><span class="attr">search:</span> </span><br><span class="line">  <span class="attr">path:</span> <span class="string">search.xml</span> </span><br><span class="line">  <span class="attr">field:</span> <span class="string">post</span> </span><br><span class="line">  <span class="attr">format:</span> <span class="string">html</span> </span><br><span class="line">  <span class="attr">limit:</span> <span class="number">10000</span></span><br></pre></td></tr></table></figure>

<p>在_config.next.yml中配置如下</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Local search </span></span><br><span class="line"><span class="comment"># Dependencies: https://github.com/flashlab/hexo-generator-search </span></span><br><span class="line"><span class="attr">local_search:</span> </span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> </span><br><span class="line">  <span class="comment"># if auto, trigger search by changing input </span></span><br><span class="line">  <span class="comment"># if manual, trigger search by pressing enter key or search button   </span></span><br><span class="line">  <span class="attr">trigger:</span> <span class="string">auto</span> </span><br><span class="line">  <span class="comment"># show top n results per article, show all results by setting to -1 </span></span><br><span class="line">  <span class="attr">top_n_per_article:</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>参考<br><a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/">官方文档</a><br><a target="_blank" rel="noopener" href="https://jiz4oh.com/2020/09/hexo-next/">Hexo 博客使用 Next 主题及美化 | Jiz4oh’s Life</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chengming0916.github.io/2021/10/22/Hexo%E5%8D%9A%E5%AE%A2/%E4%BD%BF%E7%94%A8Github-Actions%E9%83%A8%E7%BD%B2Hexo%E5%8D%9A%E5%AE%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Chemmy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/10/22/Hexo%E5%8D%9A%E5%AE%A2/%E4%BD%BF%E7%94%A8Github-Actions%E9%83%A8%E7%BD%B2Hexo%E5%8D%9A%E5%AE%A2/" class="post-title-link" itemprop="url">使用Github Actions部署Hexo博客</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-10-22 00:00:00" itemprop="dateCreated datePublished" datetime="2021-10-22T00:00:00+08:00">2021-10-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-04 16:58:10" itemprop="dateModified" datetime="2025-12-04T16:58:10+08:00">2025-12-04</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>作为技术博主，博客的高效维护与部署一直是我关注的重点。近期在维护博客时，我遇到了两个核心问题：</p>
<ol>
<li><strong>内容管理混乱</strong>：草稿箱文件堆积，缺乏分类标准，甚至因误操作破坏了原有配置；</li>
<li><strong>兼容性局限</strong>：计划将文章同步至 FastGPT 等 AI 知识库时，发现官方推荐的 Hexo 部署方案（源码与静态文件混存）中，冗余的 <code>public</code> 目录会干扰 RAG 系统提取内容，且源码与发布产物耦合易引发冲突。</li>
</ol>
<p>为解决这些问题，我采用了<strong>源码与发布分离</strong>的部署架构：将 Markdown 源文件单独存放在一个仓库，通过 GitHub Actions 自动在另一个仓库构建并发布静态文件。这种方式的优劣对比如下：</p>
<table>
<thead>
<tr>
<th>方案</th>
<th>优点</th>
<th>缺点</th>
</tr>
</thead>
<tbody><tr>
<td>官方混仓部署</td>
<td>支持本地手动 &#x2F; 自动发布，预览方便，配置简单</td>
<td>仓库体积大，源码与产物混合，不利于二次利用</td>
</tr>
<tr>
<td>本文分离部署</td>
<td>源码纯净、产物独立，兼容 AI 知识库，自动构建</td>
<td>本地预览需搭测试环境，配置较复杂（双仓库 + 鉴权）</td>
</tr>
</tbody></table>
<h2 id="部署核心思路"><a href="#部署核心思路" class="headerlink" title="部署核心思路"></a>部署核心思路</h2><p>核心逻辑：当源码仓库收到推送时，GitHub Actions 自动将源文件检出到 <code>source/_posts</code>，并从 <code>_hexo</code> 目录复制配置文件还原 Hexo 环境，最终执行构建与发布。</p>
<p><strong>文件结构设计</strong>（源码仓库）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">|-- _hexo/ # Hexo 核心配置目录 </span><br><span class="line">| |-- _config.yml # Hexo 主配置 </span><br><span class="line">| |-- _config.next.yml # NexT 主题配置 </span><br><span class="line">| |-- package.json # Node 环境依赖 </span><br><span class="line">| |-- scaffolds/ # 文章模板（draft/page/post.md） </span><br><span class="line">| |-- static/ # 静态资源（头像、支付码等） </span><br><span class="line">|-- .github/workflows/ # GitHub Actions 工作流配置 </span><br><span class="line">|-- .obsidian/ # Obsidian 编辑器配置（可选）</span><br></pre></td></tr></table></figure>

<h2 id="详细部署步骤"><a href="#详细部署步骤" class="headerlink" title="详细部署步骤"></a>详细部署步骤</h2><h3 id="1-生成-SSH-密钥对（用于仓库间鉴权）"><a href="#1-生成-SSH-密钥对（用于仓库间鉴权）" class="headerlink" title="1. 生成 SSH 密钥对（用于仓库间鉴权）"></a>1. 生成 SSH 密钥对（用于仓库间鉴权）</h3><p>需要生成一对 SSH 密钥，用于源码仓库向发布仓库推送构建结果：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">&quot;&lt;github 注册邮箱&gt;&quot;</span></span><br></pre></td></tr></table></figure>

<p>执行后会在以下路径生成两个文件：</p>
<ul>
<li>私钥：<code>~/.ssh/id_rsa</code>（Linux&#x2F;Mac）或 <code>C:\Users\&lt;用户名&gt;\.ssh\id_rsa</code>（Windows）</li>
<li>公钥：<code>~/.ssh/id_rsa.pub</code>（同上路径）</li>
</ul>
<p><strong>注意</strong>：.ssh为隐藏目录，需要修改系统设置显示此文件夹</p>
<p><img src="/2021/10/22/Hexo%E5%8D%9A%E5%AE%A2/%E4%BD%BF%E7%94%A8Github-Actions%E9%83%A8%E7%BD%B2Hexo%E5%8D%9A%E5%AE%A2/IMG-20250827165137638.png"></p>
<h3 id="2-准备两个仓库"><a href="#2-准备两个仓库" class="headerlink" title="2. 准备两个仓库"></a>2. 准备两个仓库</h3><h4 id="仓库-1：源码仓库（存放-Markdown-与配置）"><a href="#仓库-1：源码仓库（存放-Markdown-与配置）" class="headerlink" title="仓库 1：源码仓库（存放 Markdown 与配置）"></a>仓库 1：源码仓库（存放 Markdown 与配置）</h4><ul>
<li>新建仓库（例如命名为 <code>hexo-source</code>）</li>
<li>进入仓库设置：<code>Settings → Secrets and variables → Actions → New repository secret</code></li>
<li>添加一个名为 <code>HEXO_DEPLOY_KEY</code> 的密钥，值为<strong>私钥 <code>id_rsa</code> 的内容</strong>（用记事本打开复制）</li>
</ul>
<p><img src="/2021/10/22/Hexo%E5%8D%9A%E5%AE%A2/%E4%BD%BF%E7%94%A8Github-Actions%E9%83%A8%E7%BD%B2Hexo%E5%8D%9A%E5%AE%A2/IMG-20250827165137689.png"></p>
<p><img src="/2021/10/22/Hexo%E5%8D%9A%E5%AE%A2/%E4%BD%BF%E7%94%A8Github-Actions%E9%83%A8%E7%BD%B2Hexo%E5%8D%9A%E5%AE%A2/IMG-20250827165137708.png"></p>
<h4 id="仓库-2：发布仓库（存放静态文件，用于-GitHub-Pages）"><a href="#仓库-2：发布仓库（存放静态文件，用于-GitHub-Pages）" class="headerlink" title="仓库 2：发布仓库（存放静态文件，用于 GitHub Pages）"></a>仓库 2：发布仓库（存放静态文件，用于 GitHub Pages）</h4><ul>
<li>仓库名必须为 <code>&lt;你的 GitHub 用户名&gt;.github.io</code>（固定格式，否则 GitHub Pages 无法生效）</li>
<li>权限需设为<strong>公开</strong>，并开启 <code>Discussions</code> 功能（进入仓库设置 → <code>Features</code> 勾选）</li>
<li>配置部署密钥：<code>Settings → Deploy keys → Add deploy key</code><ul>
<li>Title 填 <code>HEXO_DEPLOY_PUB</code></li>
<li>Key 填入<strong>公钥 <code>id_rsa.pub</code> 的内容</strong>，并勾选 <code>Allow write access</code>（允许推送权限）</li>
</ul>
</li>
</ul>
<p><img src="/2021/10/22/Hexo%E5%8D%9A%E5%AE%A2/%E4%BD%BF%E7%94%A8Github-Actions%E9%83%A8%E7%BD%B2Hexo%E5%8D%9A%E5%AE%A2/IMG-20250827165137733.png"></p>
<p><img src="/2021/10/22/Hexo%E5%8D%9A%E5%AE%A2/%E4%BD%BF%E7%94%A8Github-Actions%E9%83%A8%E7%BD%B2Hexo%E5%8D%9A%E5%AE%A2/IMG-20250827165137761.png"></p>
<h3 id="3-配置-Hexo-环境文件"><a href="#3-配置-Hexo-环境文件" class="headerlink" title="3. 配置 Hexo 环境文件"></a>3. 配置 Hexo 环境文件</h3><p>在源码仓库中创建 <code>_hexo</code> 目录，放入以下核心文件（可从本地 Hexo 环境中复制, 参考<a href="Hexo-%E5%8D%9A%E5%AE%A2%E9%85%8D%E7%BD%AE.md">Hexo-博客配置</a>）：</p>
<ul>
<li><code>_config.yml</code>：Hexo 主配置（需修改部署相关配置，见步骤 4）</li>
<li><code>_config.next.yml</code>：NexT 主题配置（其他主题同理）</li>
<li><code>package.json</code>：依赖配置（需包含 <code>hexo</code>、<code>hexo-deployer-git</code> 等核心依赖）</li>
<li><code>scaffolds/</code>：文章模板（<code>draft.md</code>&#x2F;<code>page.md</code>&#x2F;<code>post.md</code>）</li>
<li>静态资源：如头像（<code>avatar.jpg</code>）、关于页（<code>about.md</code>）等，按实际需求存放</li>
</ul>
<h3 id="4-配置部署与工作流文件"><a href="#4-配置部署与工作流文件" class="headerlink" title="4. 配置部署与工作流文件"></a>4. 配置部署与工作流文件</h3><h4 id="①-Hexo-部署配置（-hexo-config-yml）"><a href="#①-Hexo-部署配置（-hexo-config-yml）" class="headerlink" title="① Hexo 部署配置（_hexo/_config.yml）"></a>① Hexo 部署配置（<code>_hexo/_config.yml</code>）</h4><p>在配置文件中添加部署规则，指向发布仓库：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">    <span class="attr">repo:</span> <span class="string">git@github.com:&lt;username&gt;/&lt;username&gt;.github.io.git</span></span><br><span class="line">    <span class="attr">branch:</span> <span class="string">master</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">&lt;username&gt;</span></span><br><span class="line">    <span class="attr">email:</span> <span class="string">&lt;email&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="②-GitHub-Actions-工作流（-github-workflows-hexo-deploy-yml）"><a href="#②-GitHub-Actions-工作流（-github-workflows-hexo-deploy-yml）" class="headerlink" title="② GitHub Actions 工作流（.github/workflows/hexo-deploy.yml）"></a>② GitHub Actions 工作流（<code>.github/workflows/hexo-deploy.yml</code>）</h4><p>创建工作流文件，实现自动构建部署：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">hexo-deploy</span>  <span class="comment"># 工作流名称</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 触发条件：向 master 分支推送时执行</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span> [<span class="string">&quot;master&quot;</span>]</span><br><span class="line">    </span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span>  <span class="comment"># 使用 Ubuntu 环境</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="comment"># 1. 配置时区（避免时间显示异常）</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Setup</span> <span class="string">Timezone</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">szenius/set-timezone@v2.0</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">timezoneLinux:</span> <span class="string">&quot;Asia/Shanghai&quot;</span></span><br><span class="line">      </span><br><span class="line">      <span class="comment"># 2. 拉取源码仓库内容到 source/_posts</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/checkout@v3</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">path:</span> <span class="string">source/_posts</span></span><br><span class="line">      </span><br><span class="line">      <span class="comment"># 3. 安装 Node.js（需与本地开发环境版本一致，这里用 20.x）</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Use</span> <span class="string">Node.js</span> <span class="number">20</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/setup-node@v4</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">node-version:</span> <span class="string">&#x27;20&#x27;</span></span><br><span class="line">      </span><br><span class="line">      <span class="comment"># 4. 缓存 NPM 依赖（加速构建）</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Cache</span> <span class="string">NPM</span> <span class="string">dependencies</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/cache@v4</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">path:</span> <span class="string">node_modules</span></span><br><span class="line">          <span class="attr">key:</span> <span class="string">$&#123;&#123;</span> <span class="string">runner.OS</span> <span class="string">&#125;&#125;-npm-cache</span></span><br><span class="line">          <span class="attr">restore-keys:</span> <span class="string">|</span></span><br><span class="line"><span class="string">            $&#123;&#123; runner.OS &#125;&#125;-npm-cache</span></span><br><span class="line"><span class="string"></span>      </span><br><span class="line">      <span class="comment"># 5. 配置 SSH 密钥（用于向发布仓库推送）</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Setup</span> <span class="string">Git</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">          <span class="attr">ACTION_DEPLOY_KEY:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.HEXO_DEPLOY_KEY</span> <span class="string">&#125;&#125;</span>  <span class="comment"># 引用源码仓库的私钥</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          mkdir -p ~/.ssh/</span></span><br><span class="line"><span class="string">          echo &quot;$ACTION_DEPLOY_KEY&quot; &gt; ~/.ssh/id_rsa</span></span><br><span class="line"><span class="string">          chmod 700 ~/.ssh</span></span><br><span class="line"><span class="string">          chmod 600 ~/.ssh/id_rsa  # 严格权限，否则 SSH 会拒绝使用</span></span><br><span class="line"><span class="string">          ssh-keyscan github.com &gt;&gt; ~/.ssh/known_hosts  # 信任 GitHub 主机</span></span><br><span class="line"><span class="string"></span>      </span><br><span class="line">      <span class="comment"># 6. 拉取主题（以 NexT 为例，其他主题修改仓库地址即可）</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Use</span> <span class="string">Themes</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v3</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">repository:</span> <span class="string">next-theme/hexo-theme-next</span></span><br><span class="line">          <span class="attr">path:</span> <span class="string">themes/next</span></span><br><span class="line">      </span><br><span class="line">      <span class="comment"># 7. 还原 Hexo 环境（从 _hexo 目录复制配置文件）</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Setup</span> <span class="string">Hexo</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          npm install -g hexo-cli  # 全局安装 Hexo 命令行工具</span></span><br><span class="line"><span class="string">          # 复制核心配置文件</span></span><br><span class="line"><span class="string">          cp source/_posts/_hexo/_config.yml .</span></span><br><span class="line"><span class="string">          cp source/_posts/_hexo/_config.next.yml .</span></span><br><span class="line"><span class="string">          cp source/_posts/_hexo/package.json .</span></span><br><span class="line"><span class="string">          # 复制文章模板</span></span><br><span class="line"><span class="string">          mkdir scaffolds</span></span><br><span class="line"><span class="string">          cp source/_posts/_hexo/scaffolds/* scaffolds/</span></span><br><span class="line"><span class="string">          # 复制静态页面（关于页、分类页等，按实际需求调整）</span></span><br><span class="line"><span class="string">          mkdir -p source/about source/categories source/tags source/images</span></span><br><span class="line"><span class="string">          cp source/_posts/_hexo/about.md source/about/index.md</span></span><br><span class="line"><span class="string">          cp source/_posts/_hexo/categories.md source/categories/index.md</span></span><br><span class="line"><span class="string">          cp source/_posts/_hexo/tags.md source/tags/index.md</span></span><br><span class="line"><span class="string">          cp source/_posts/_hexo/*.jpg source/images/  # 复制图片资源</span></span><br><span class="line"><span class="string">          # 安装依赖</span></span><br><span class="line"><span class="string">          npm install</span></span><br><span class="line"><span class="string"></span>      </span><br><span class="line">      <span class="comment"># 8. 缓存部署目录（加速后续构建）</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Cache</span> <span class="string">Deploy</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/cache@v4</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">path:</span> <span class="string">.deploy_git</span></span><br><span class="line">          <span class="attr">key:</span> <span class="string">$&#123;&#123;</span> <span class="string">runner.OS</span> <span class="string">&#125;&#125;-deploy-cache</span></span><br><span class="line">          <span class="attr">restore-keys:</span> <span class="string">|</span></span><br><span class="line"><span class="string">            $&#123;&#123; runner.OS &#125;&#125;-deploy-cache</span></span><br><span class="line"><span class="string"></span>      </span><br><span class="line">      <span class="comment"># 9. 构建并发布</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Deploy</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          cd .deploy_git &amp;&amp; git pull  # 拉取最新发布内容，避免冲突</span></span><br><span class="line"><span class="string">          cd ..</span></span><br><span class="line"><span class="string">          hexo clean  # 清理缓存</span></span><br><span class="line"><span class="string">          hexo generate  # 生成静态文件</span></span><br><span class="line"><span class="string">          hexo deploy  # 部署到发布仓库</span></span><br></pre></td></tr></table></figure>

<h2 id="验证与使用"><a href="#验证与使用" class="headerlink" title="验证与使用"></a>验证与使用</h2><ol>
<li>将上述文件提交到源码仓库的 <code>master</code> 分支，GitHub Actions 会自动触发工作流；</li>
<li>进入源码仓库的 <code>Actions</code> 标签页，查看工作流执行状态，若显示绿色对勾则部署成功；</li>
<li>访问 <code>https://&lt;你的用户名&gt;.github.io</code>，即可看到最新发布的博客。</li>
</ol>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ol>
<li>私钥 <code>HEXO_DEPLOY_KEY</code> 是敏感信息，切勿泄露或提交到仓库；</li>
<li>发布仓库名必须严格为 <code>&lt;用户名&gt;.github.io</code>，否则 GitHub Pages 无法正常访问；</li>
<li>若主题是自定义修改过的，建议将主题 fork 到自己的仓库，再在工作流中拉取自己的 fork 版本；</li>
<li>本地预览时，可在源码仓库中手动搭建 Hexo 环境（复制 <code>_hexo</code> 目录文件，执行 <code>hexo server</code>）。</li>
</ol>
<p>参考</p>
<p><a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/github-pages">Hexo官方提供的Github Actions部署示例</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chengming0916.github.io/2020/12/29/%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/Kubernetes%E6%90%AD%E5%BB%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Chemmy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/12/29/%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/Kubernetes%E6%90%AD%E5%BB%BA/" class="post-title-link" itemprop="url">Kubernetes搭建</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-12-29 00:00:00" itemprop="dateCreated datePublished" datetime="2020-12-29T00:00:00+08:00">2020-12-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-04 16:58:11" itemprop="dateModified" datetime="2025-12-04T16:58:11+08:00">2025-12-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">容器技术</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a target="_blank" rel="noopener" href="https://kubernetes.io/zh/docs/home/">官方文档(中文)</a></p>
<table>
<thead>
<tr>
<th>节点名称</th>
<th>节点IP</th>
<th>配置</th>
<th>系统版本</th>
</tr>
</thead>
<tbody><tr>
<td>VIP</td>
<td>192.168.50.220</td>
<td>虚拟IP</td>
<td></td>
</tr>
<tr>
<td>k8s-master-221</td>
<td>192.168.50.221</td>
<td>4核 2G</td>
<td>debian 11</td>
</tr>
<tr>
<td>k8s-master-222</td>
<td>192.168.50.222</td>
<td>4核 2G</td>
<td>debian 11</td>
</tr>
<tr>
<td>k8s-master-223</td>
<td>192.168.50.223</td>
<td>4核 2G</td>
<td>debian 11</td>
</tr>
<tr>
<td>k8s-node-224</td>
<td>192.168.50.224</td>
<td>4核 2G</td>
<td>debian 11</td>
</tr>
<tr>
<td>k8s-node-225</td>
<td>192.168.50.225</td>
<td>4核 2G</td>
<td>debian 11</td>
</tr>
</tbody></table>
<h3 id="主机配置"><a href="#主机配置" class="headerlink" title="主机配置"></a>主机配置</h3><h4 id="时间同步"><a href="#时间同步" class="headerlink" title="时间同步"></a>时间同步</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="配置-hostname"><a href="#配置-hostname" class="headerlink" title="配置 hostname"></a>配置 hostname</h4><p><strong>注意节名称不能重复</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hostnamectl --static set-hostname k8s-master-221</span><br></pre></td></tr></table></figure>

<h4 id="配置防火墙"><a href="#配置防火墙" class="headerlink" title="配置防火墙"></a>配置防火墙</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">service iptables stop </span><br><span class="line"></span><br><span class="line">iptables -F</span><br><span class="line"></span><br><span class="line">systemctl stop firewalld &amp;&amp; systemctl <span class="built_in">disable</span> firewalld</span><br></pre></td></tr></table></figure>
<p>如果需要打开防火墙，执行以下配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># master节点执行</span></span><br><span class="line">ufw allow 6443/tcp</span><br><span class="line">ufw allow 2379/tcp</span><br><span class="line">ufw allow 2380/tcp</span><br><span class="line">ufw allow 10250/tcp</span><br><span class="line">ufw allow 10251/tcp</span><br><span class="line">ufw allow 10252/tcp</span><br><span class="line">ufw allow 10255/tcp</span><br><span class="line">ufw reload</span><br><span class="line"></span><br><span class="line"><span class="comment"># worker节点执行</span></span><br><span class="line">ufw allow 10250/tcp</span><br><span class="line">ufw allow 30000:32767/tcp</span><br><span class="line">ufw reload</span><br></pre></td></tr></table></figure>

<h4 id="关闭交换分区"><a href="#关闭交换分区" class="headerlink" title="关闭交换分区"></a>关闭交换分区</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">swapoff -a</span><br><span class="line"><span class="built_in">set</span> -ri <span class="string">&#x27;s/.*swap.*/#&amp;/&#x27;</span> /etc/fstab</span><br></pre></td></tr></table></figure>
<p>若需允许交换分区参考<a target="_blank" rel="noopener" href="https://kubernetes.io/zh-cn/docs/setup/production-environment/tools/kubeadm/install-kubeadm/">官方文档</a> 交换分区的配置</p>
<h4 id="配置hosts"><a href="#配置hosts" class="headerlink" title="配置hosts"></a>配置hosts</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt;&gt; /etc/hosts &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">192.168.50.221 k8s-master-221</span></span><br><span class="line"><span class="string">192.168.50.222 k8s-master-222</span></span><br><span class="line"><span class="string">192.168.50.223 k8s-master-223</span></span><br><span class="line"><span class="string">192.168.50.224 k8s-worker-224</span></span><br><span class="line"><span class="string">192.168.50.225 k8s-worker-225</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure>

<h4 id="开启-bridge-网桥过滤功能"><a href="#开启-bridge-网桥过滤功能" class="headerlink" title="开启 bridge 网桥过滤功能"></a>开启 bridge 网桥过滤功能</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 桥接的ipv4流量转到iptables</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt; <span class="string">EOF | sudo tee /etc/modules-load.d/k8s.conf</span></span><br><span class="line"><span class="string">overlay</span></span><br><span class="line"><span class="string">br_netfilter</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">sudo</span> modprobe overlay</span><br><span class="line"><span class="built_in">sudo</span> modprobe br_netfilter</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置所需的 sysctl 参数,参数在重新启动后保持不变</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt; <span class="string">EOF | sudo tee /etc/sysctl.d/k8s.conf</span></span><br><span class="line"><span class="string">net.bridge.bridge-nf-call-iptables  = 1 # 开启网桥模式(必须)</span></span><br><span class="line"><span class="string">net.bridge.bridge-nf-call-ip6tables = 1 # 开启网桥模式(必须)</span></span><br><span class="line"><span class="string">net.ipv4.ip_forward                 = 1 # 转发模式(默认开启)</span></span><br><span class="line"><span class="string">vm.panic_on_oom                     = 0 # 开启OOM(默认开启)</span></span><br><span class="line"><span class="string">vm.swappiness                       = 0 # 禁止使用swap空间</span></span><br><span class="line"><span class="string">vm.overcommit_memory                = 1 # 不检查物理内存是否够用</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 应用 sysctl 参数而不重新启动</span></span><br><span class="line"><span class="built_in">sudo</span> sysctl --system</span><br></pre></td></tr></table></figure>

<h4 id="配置-IPVS"><a href="#配置-IPVS" class="headerlink" title="配置 IPVS"></a>配置 IPVS</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">modprobe br_netfilter</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &gt; /etc/sysconfig/modules/ipvs.modules &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">#!/bin/bash</span></span><br><span class="line"><span class="string">modprobe -- ip_vs</span></span><br><span class="line"><span class="string">modprobe -- ip_vs_rr</span></span><br><span class="line"><span class="string">modprobe -- ip_vs_wrr</span></span><br><span class="line"><span class="string">modprobe -- ip_vs_sh</span></span><br><span class="line"><span class="string">modprobe -- nf_conntrack_ipv</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="安装工具"><a href="#安装工具" class="headerlink" title="安装工具"></a>安装工具</h3><h4 id="安装-Containerd"><a href="#安装-Containerd" class="headerlink" title="安装 Containerd"></a>安装 Containerd</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装</span></span><br><span class="line">apt update </span><br><span class="line">apt install -y containerd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 导出默认配置</span></span><br><span class="line">containerd config default | <span class="built_in">sudo</span> <span class="built_in">tee</span> /etc/containerd/config.toml &gt;/dev/null 2&gt;&amp;1</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>设置<code>cgroupdriver</code>为<code>systemd</code>,编辑 <code>/etc/containerd/config.toml</code> 文件，找到 <code>[plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.runtimes.runc.options]</code> 部分，添加一行内容：<code>SystemdCgroup = true</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">&#x27;s/SystemdCgroup \= false/SystemdCgroup \= true/g&#x27;</span> /etc/containerd/config.toml</span><br></pre></td></tr></table></figure>

<p><img src="/2020/12/29/%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/Kubernetes%E6%90%AD%E5%BB%BA/IMG-20250804110102409.png"></p>
<p>重启containerd并设置开机启动</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart containerd</span><br><span class="line">systemctl <span class="built_in">enable</span> containerd</span><br></pre></td></tr></table></figure>

<h4 id="安装-keadm-kubelete-kubectl"><a href="#安装-keadm-kubelete-kubectl" class="headerlink" title="安装 keadm,kubelete,kubectl"></a>安装 keadm,kubelete,kubectl</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加安装源</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装</span></span><br><span class="line">apt update </span><br><span class="line">apt install -y kubelet kubeadm kubectl </span><br><span class="line">apt-mark hold kubelet kubeadm kubectl</span><br></pre></td></tr></table></figure>
<h3 id="部署高可用-仅-master-节点"><a href="#部署高可用-仅-master-节点" class="headerlink" title="部署高可用(仅 master 节点)"></a>部署高可用(仅 master 节点)</h3><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install keepalived haproxy</span><br></pre></td></tr></table></figure>

<h4 id="修改haproxy配置"><a href="#修改haproxy配置" class="headerlink" title="修改haproxy配置"></a>修改haproxy配置</h4><p><code>/etc/haproxy/haproxy.cfg</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">global</span><br><span class="line">  maxconn  2000</span><br><span class="line">  ulimit-n  16384</span><br><span class="line">  log  127.0.0.1 local0 err</span><br><span class="line">  stats timeout 30s</span><br><span class="line"></span><br><span class="line">defaults</span><br><span class="line">  log global</span><br><span class="line">  mode  http</span><br><span class="line">  option  httplog</span><br><span class="line">  timeout connect 5000</span><br><span class="line">  timeout client  50000</span><br><span class="line">  timeout server  50000</span><br><span class="line">  timeout http-request 15s</span><br><span class="line">  timeout http-keep-alive 15s</span><br><span class="line"></span><br><span class="line">frontend monitor-in</span><br><span class="line">  bind *:33305</span><br><span class="line">  mode http</span><br><span class="line">  option httplog</span><br><span class="line">  monitor-uri /monitor</span><br><span class="line"></span><br><span class="line">frontend k8s-master</span><br><span class="line">  bind 0.0.0.0:16443</span><br><span class="line">  bind 127.0.0.1:16443</span><br><span class="line">  mode tcp</span><br><span class="line">  option tcplog</span><br><span class="line">  tcp-request inspect-delay 5s</span><br><span class="line">  default_backend k8s-master</span><br><span class="line"></span><br><span class="line">backend k8s-master</span><br><span class="line">  mode tcp</span><br><span class="line">  option tcplog</span><br><span class="line">  option tcp-check</span><br><span class="line">  balance roundrobin</span><br><span class="line">  default-server inter 10s downinter 5s rise 2 fall 2 slowstart 60s maxconn 250 maxqueue 256 weight 100</span><br><span class="line">  server k8s-master1	172.16.12.111:6443  check  </span><br><span class="line">  server k8s-master2	172.16.12.112:6443  check</span><br><span class="line">  server k8s-master3	172.16.12.113:6443  check</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="配置-keepalived"><a href="#配置-keepalived" class="headerlink" title="配置 keepalived"></a>配置 keepalived</h4><blockquote>
<p>interface         # 网卡名称<br>mcast_src_ip      # 节点ip<br>virtual_ipaddress # vip地址</p>
</blockquote>
<p>k8s-master-221配置文件<code>/etc/keepalived/keepalived.conf</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">! Configuration File for keepalived</span><br><span class="line">global_defs &#123;</span><br><span class="line">    router_id LVS_DEVEL</span><br><span class="line">script_user root</span><br><span class="line">    enable_script_security</span><br><span class="line">&#125;</span><br><span class="line">vrrp_script chk_apiserver &#123;</span><br><span class="line">    script &quot;/etc/keepalived/check_apiserver.sh&quot; #健康检查脚本</span><br><span class="line">    interval 5</span><br><span class="line">    weight -5</span><br><span class="line">    fall 2  </span><br><span class="line">    rise 1</span><br><span class="line">&#125;</span><br><span class="line">vrrp_instance VI_1 &#123;</span><br><span class="line">    state MASTER					#高可用主1</span><br><span class="line">    interface eth0					#网卡名称</span><br><span class="line">    mcast_src_ip 192.168.50.221		#该节点 IP</span><br><span class="line">    virtual_router_id 51</span><br><span class="line">    priority 100				    #设置最高级优先级</span><br><span class="line">    advert_int 2</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass K8SHA_KA_AUTH</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        192.168.50.220			    #vip地址</span><br><span class="line">    &#125;</span><br><span class="line">    track_script &#123;</span><br><span class="line">       chk_apiserver</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>k8s-master-222配置文件<code>/etc/keepalived/keepalived.conf</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">! Configuration File for keepalived</span><br><span class="line">global_defs &#123;</span><br><span class="line">    router_id LVS_DEVEL</span><br><span class="line">script_user root</span><br><span class="line">    enable_script_security</span><br><span class="line">&#125;</span><br><span class="line">vrrp_script chk_apiserver &#123;</span><br><span class="line">    script &quot;/etc/keepalived/check_apiserver.sh&quot;</span><br><span class="line">    interval 5</span><br><span class="line">    weight -5</span><br><span class="line">    fall 2  </span><br><span class="line">    rise 1</span><br><span class="line">&#125;</span><br><span class="line">vrrp_instance VI_1 &#123;</span><br><span class="line">    state BACKUP					#高可用 从1</span><br><span class="line">    interface ens33					#网卡名称</span><br><span class="line">    mcast_src_ip 192.168.50.222	    #该节点 IP</span><br><span class="line">    virtual_router_id 51</span><br><span class="line">    priority 50				        #设置优先级</span><br><span class="line">    advert_int 2</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass K8SHA_KA_AUTH</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        192.168.50.220			    #vip地址</span><br><span class="line">    &#125;</span><br><span class="line">    track_script &#123;</span><br><span class="line">       chk_apiserver</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>k8s-master-222配置文件<code>/etc/keepalived/keepalived.conf</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">! Configuration File for keepalived</span><br><span class="line">global_defs &#123;</span><br><span class="line">    router_id LVS_DEVEL</span><br><span class="line">script_user root</span><br><span class="line">    enable_script_security</span><br><span class="line">&#125;</span><br><span class="line">vrrp_script chk_apiserver &#123;</span><br><span class="line">    script &quot;/etc/keepalived/check_apiserver.sh&quot;</span><br><span class="line">    interval 5</span><br><span class="line">    weight -5</span><br><span class="line">    fall 2  </span><br><span class="line">    rise 1</span><br><span class="line">&#125;</span><br><span class="line">vrrp_instance VI_1 &#123;</span><br><span class="line">    state BACKUP					#高可用从2</span><br><span class="line">    interface ens33					#网卡名称</span><br><span class="line">    mcast_src_ip 192.168.50.223		#该节点 IP</span><br><span class="line">    virtual_router_id 51</span><br><span class="line">    priority 49				        #设置优先级</span><br><span class="line">    advert_int 2</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass K8SHA_KA_AUTH</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        192.168.50.220			    #vip地址</span><br><span class="line">    &#125;</span><br><span class="line">    track_script &#123;</span><br><span class="line">       chk_apiserver</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>健康检查脚本 <code>/etc/keepalived/check_apiserver.sh</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">err=0</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> $(<span class="built_in">seq</span> 1 3);<span class="keyword">do</span></span><br><span class="line">    check_code=$(pgrep haproxy)</span><br><span class="line">    <span class="keyword">if</span> [[ <span class="variable">$check_code</span> == <span class="string">&quot;&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">        err=$(<span class="built_in">expr</span> <span class="variable">$err</span> + 1)</span><br><span class="line">        <span class="built_in">sleep</span> 1</span><br><span class="line">        <span class="built_in">continue</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        err=0</span><br><span class="line">        <span class="built_in">break</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$err</span> != <span class="string">&quot;0&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;systemctl stop keepalived&quot;</span></span><br><span class="line">    /usr/bin/systemctl stop keepalived</span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">exit</span> 0</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>给监测脚本添加执行权限</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x /etc/keepalived/check_apiserver.sh</span><br></pre></td></tr></table></figure>
<p>启动keepalive和haproxy</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">systemctl daemon-reload</span><br><span class="line"><span class="comment"># 启动并设置开机启动</span></span><br><span class="line"><span class="comment"># systemctl enable --now haproxy</span></span><br><span class="line">systemctl start haproxy &amp;&amp; systemctl <span class="built_in">enable</span> haproxy</span><br><span class="line"><span class="comment"># systemctl enable --now keepalived</span></span><br><span class="line">systemctl start keepalived &amp;&amp; systemctl enbale keepalived</span><br></pre></td></tr></table></figure>
<h4 id="测试vip漂移"><a href="#测试vip漂移" class="headerlink" title="测试vip漂移"></a>测试vip漂移</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看ip与vip</span></span><br><span class="line">hostname -I</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试vip的16443端口是否通</span></span><br><span class="line">nc -v 192.168.50.220 16443</span><br></pre></td></tr></table></figure>

<h3 id="初始化集群"><a href="#初始化集群" class="headerlink" title="初始化集群"></a>初始化集群</h3><h4 id="拉取镜像"><a href="#拉取镜像" class="headerlink" title="拉取镜像"></a>拉取镜像</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看需要的镜像文件</span></span><br><span class="line">kubeadm config images list </span><br><span class="line"></span><br><span class="line"><span class="comment"># 拉取镜像</span></span><br><span class="line">kubeadm config images pull </span><br></pre></td></tr></table></figure>

<h4 id="master-节点初始化"><a href="#master-节点初始化" class="headerlink" title="master 节点初始化"></a>master 节点初始化</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导出默认初始化配置</span></span><br><span class="line">kubeadm config <span class="built_in">print</span> init-defaults &gt; kubeadm-config.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># token过期后生成信息token</span></span><br><span class="line">kubeadm token create --print-join-command</span><br></pre></td></tr></table></figure>

<h4 id="master-节点加入集群"><a href="#master-节点加入集群" class="headerlink" title="master 节点加入集群"></a>master 节点加入集群</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># master节点需要生成certificate-key</span></span><br><span class="line">kubeadm init --control-plane-endpoint=192.168.50.220:16443</span><br><span class="line"></span><br><span class="line">kubeadm <span class="built_in">join</span> 192.168.50.220:16443 --token &#123;token&#125; \</span><br><span class="line">    --discovery-token-ca-cert-hash &#123;&#125; \</span><br><span class="line">    --control-plane --certificate-key &#123;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="worker-节点加入集群"><a href="#worker-节点加入集群" class="headerlink" title="worker 节点加入集群"></a>worker 节点加入集群</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubeadm <span class="built_in">join</span> 192.168.50.220:16643 --token &#123;token&#125; \</span><br><span class="line">    --discovery-token-ca-cert-hash &#123;&#125; </span><br></pre></td></tr></table></figure>

<p>从集群种移除节点</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl delete node &#123;node-name&#125;</span><br></pre></td></tr></table></figure>

<h4 id="配置环境变量，用于访问集群"><a href="#配置环境变量，用于访问集群" class="headerlink" title="配置环境变量，用于访问集群"></a>配置环境变量，用于访问集群</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt; <span class="string">EOF &gt;&gt; ~/.bashrc</span></span><br><span class="line"><span class="string">export KUBECONFIG=/etc/kubernetes/admin/conf</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure>
<p>查看集群节点状态</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看节点状态</span></span><br><span class="line">kubectl get nodes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看系统组件</span></span><br><span class="line">kubectl get all -n kube-system -o wide</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="安装网络组件-只在master-221节点操作"><a href="#安装网络组件-只在master-221节点操作" class="headerlink" title="安装网络组件(只在master-221节点操作)"></a>安装网络组件(只在master-221节点操作)</h4><p>Calico<br>Flannel</p>
<h4 id="去除-master节点污点"><a href="#去除-master节点污点" class="headerlink" title="去除 master节点污点"></a>去除 master节点污点</h4><p>如果你打算让Master节点也参与到平常的Pod调度(生产环境一般不会这样做，以保证master节点的稳定性)，那么你需要使用以下命令将Master节点上的 taint(污点标记)解除</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl taint nodes --all node-role.kubernetes.io/master-</span><br></pre></td></tr></table></figure>

<p>最后我们使用以下命令查看当前集群的状态，发现Scheduler和Controller Manager组件处理不健康状态：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get cs</span><br></pre></td></tr></table></figure>
<p>解决上述问题需要将每个Master节点上的 &#x2F;etc&#x2F;kubernetes&#x2F;manifests&#x2F;kube-scheduler.yaml 和 &#x2F;etc&#x2F;kubernetes&#x2F;manifests&#x2F;kube-controller-manager.yaml 文件中的- –port&#x3D;0注释掉,然后重启一下各Master节点上的kubelet即可.</p>
<h4 id="测试集群"><a href="#测试集群" class="headerlink" title="测试集群"></a>测试集群</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">kubectl create deployment nginx --image nginx --replicas 2</span><br><span class="line">kubectl expose deployment nginx --name nginx --<span class="built_in">type</span> NodePort --port 80 --target-port 80 --node-port 8080</span><br><span class="line"></span><br><span class="line">curl http://192.168.50.220:8080</span><br></pre></td></tr></table></figure>


<p>参考<br><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/587922250">如何用 Kubeadm 在 Debian 11 上安装 Kubernetes 集群 | Linux 中国 - 知乎 (zhihu.com)</a><br><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000040132460">Kubernetes多主多从高可用集群部署 - 个人文章 - SegmentFault 思否</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_53667818/article/details/132702544">搭建多主节点k8s高可用集群(三主两从一VIP）_kubernetes部署多主多从集群-CSDN博客</a><br><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000045271028">github - 基于Ubuntu22.04部署KubeEdge-v1.18.0环境 - 云原生_KubeEdge - SegmentFault 思否</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chengming0916.github.io/2020/04/29/Git/submodule/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Chemmy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/04/29/Git/submodule/" class="post-title-link" itemprop="url">Git子库</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-04-29 10:27:18" itemprop="dateCreated datePublished" datetime="2020-04-29T10:27:18+08:00">2020-04-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-04 16:58:10" itemprop="dateModified" datetime="2025-12-04T16:58:10+08:00">2025-12-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Git/" itemprop="url" rel="index"><span itemprop="name">Git</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>原文链接:<a target="_blank" rel="noopener" href="https://www.cnblogs.com/AhuntSun-blog/p/12736934.html">Git应用详解第十讲：Git子库：submodule与subtree</a></p>
<p>一个中大型项目往往会依赖几个模块，<code>git</code>提供了子库的概念。可以将这些子模块存放在不同的仓库中，通过<code>submodule</code>或<code>subtree</code>实现仓库的嵌套。本讲为<code>Git</code>应用详解的倒数第二讲，胜利离我们不远了！</p>
<h3 id="一、submodule"><a href="#一、submodule" class="headerlink" title="一、submodule"></a>一、<code>submodule</code></h3><p><code>submodule</code>：子模块的意思，表示将一个版本库作为子库引入到另一个版本库中：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173351334.png" alt="img"></p>
<h4 id="1-引入子库"><a href="#1-引入子库" class="headerlink" title="1.引入子库"></a>1.引入子库</h4><p>需要使用如下命令：</p>
<h5 id="git-submodule-add-子库地址-保存目录"><a href="#git-submodule-add-子库地址-保存目录" class="headerlink" title="git submodule add 子库地址 保存目录"></a><code>git submodule add 子库地址 保存目录</code></h5><p>比如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git submodule add git@github.<span class="property">com</span>:<span class="title class_">AhuntSun</span>/git_child.<span class="property">git</span> mymodule</span><br></pre></td></tr></table></figure>

<p>执行上述命令会将地址对应的远程仓库作为子库，保存到当前版本库的<code>mymodule</code>目录下：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173351385.png" alt="img"></p>
<p>随后查看当前版本库的状态：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173351455.png" alt="image-20200329203048016"></p>
<p>可以发现新增了两个文件。查看其中的<code>.gitmodules</code>文件：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173351530.png" alt="image-20200329203507411"></p>
<p>可以看到当前文件的路径和子模块的<code>url</code>，随后将这两个新增文件<strong>添加</strong>、<strong>提交</strong>并<strong>推送</strong>。在当前仓库<code>git_parent</code>对应的远程仓库中多出了两个文件：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173351620.png" alt="image-20200329203746236"></p>
<p>其中<code>mymodule</code>文件夹上的<code>3bd7f76</code> 对应的是<strong>子仓库</strong><code>git_child</code>中的<strong>最新提交</strong>：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173351694.png" alt="image-20200329203905051"></p>
<p>点击<code>mymodule</code>文件夹，会自动跳转到<strong>子仓库</strong>中：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173351761.png" alt="image-20200329203957392"></p>
<p>通过上述分析，可以得出结论：两个仓库已经关联起来了，并且仓库<code>git_child</code>为仓库<code>git_parent</code>的子仓库；</p>
<h4 id="2-同步子库变化"><a href="#2-同步子库变化" class="headerlink" title="2.同步子库变化"></a>2.同步子库变化</h4><p><strong>当被依赖的子版本库发生变化时</strong>：在子版本库<code>git_child</code>中新增文件<code>world.txt</code>并提交到远程仓库：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173351830.png" alt="image-20200329204252524"></p>
<p>这个时候依赖它的父版本库<code>git_parent</code>要如何感知这一变化呢？</p>
<h5 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h5><p>这个时候<code>git_parent</code>只需要进入存放子库<code>git_child</code>的目录<code>mymodule</code>，执行<code>git pull</code>就能将子版本库<code>git_child</code>的更新拉取到本地：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173351898.png" alt="image-20200330102106961"></p>
<h5 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h5><p>当父版本库<code>git_parent</code>依赖的<strong>多个子版本库</strong>都发生变化时，可以采用如下方法遍历更新所有子库：首先回到版本库主目录，执行以下指令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git submodule foreach git pull</span><br></pre></td></tr></table></figure>

<p>该命令会<strong>遍历</strong>当前版本库所依赖的<strong>所有</strong>子版本库，并将它们的更新<strong>拉取</strong>到父版本库<code>git_parent</code>：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173351970.png" alt="image-20200330102642607"></p>
<p>拉取完成后，查看状态，发现<code>mymodule</code>目录下文件发生了变化，所以需要执行一次添加、提交、推送操作：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173352045.png" alt="image-20200330102914556"></p>
<h4 id="3-复制父版本库"><a href="#3-复制父版本库" class="headerlink" title="3.复制父版本库"></a>3.复制父版本库</h4><p>如果将使用了<code>submodule</code>添加依赖了子库的父版本库<code>git_parent</code>，克隆一份到本地的话。在克隆出来的新版本库<code>git_parent2</code>中，原父版本库存放依赖子库的目录虽在，但是内容不在：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173352136.png" alt="image-20200330103417911"></p>
<p>进入根据<code>git_parent</code>复制出来的仓库<code>git_parent2</code>，会发现<code>mymodule</code>目录为空：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173352199.png" alt="image-20200330103502848"></p>
<p><strong>解决方法：</strong>可采用多条命令的分步操作，也可以通过参数将多步操作进行合并。</p>
<h5 id="分步操作"><a href="#分步操作" class="headerlink" title="分步操作"></a>分步操作</h5><p>这是在执行了<code>clone</code>操作后的额外操作，还需要做两件事：</p>
<ul>
<li><p>手动初始化<code>submodule</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git submodule init</span><br></pre></td></tr></table></figure>
</li>
<li><p>手动拉取依赖的子版本库；：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git submodule update --recursive</span><br></pre></td></tr></table></figure></li>
</ul>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173352268.png" alt="image-20200330103803762"></p>
<p>执行完两步操作后，子版本库中就有内容了。由此完成了<code>git_parent</code>的克隆；</p>
<h5 id="合并操作"><a href="#合并操作" class="headerlink" title="合并操作"></a>合并操作</h5><p>分步操作相对繁琐，还可以通过添加参数的方式，将多步操作进行合并。通过以下指令基于<code>git_parent</code>克隆一份<code>git_parent3</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone git@github.com:AhuntSun/git_parent.git git_parent3 --recursive</span><br></pre></td></tr></table></figure>

<p><img src="/2020/04/29/Git/submodule/IMG-20250804173352329.png" alt="image-20200330104210732"></p>
<p><code>--recursive</code>表示递归地克隆<code>git_parent</code>依赖的所有子版本库。</p>
<h4 id="4-删除子版本库"><a href="#4-删除子版本库" class="headerlink" title="4.删除子版本库"></a>4.删除子版本库</h4><p><code>git</code>没有提供直接删除<code>submodule</code>子库的命令，但是我们可以通过其他指令的组合来达到这一目的，分为三步：</p>
<ul>
<li><p>将<code>submodule</code>从版本库中删除：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rm --cache mymodule</span><br></pre></td></tr></table></figure></li>
</ul>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173352397.png" alt="image-20200330105131697"></p>
<blockquote>
<p><code>git rm</code>的作用为删除版本库中的文件，并将这一操作纳入暂存区；</p>
</blockquote>
<ul>
<li>将<code>submodule</code>从工作区中删除；</li>
</ul>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173352456.png" alt="image-20200330105226923"></p>
<ul>
<li>最后将<code>.gitmodules</code>目录删除；</li>
</ul>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173352522.png" alt="image-20200330105542069"></p>
<p>完成三步操作后，再进行添加，提交，推送即可完成删除子库的操作：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173352584.png" alt="image-20200330105614793"></p>
<h3 id="二、subtree"><a href="#二、subtree" class="headerlink" title="二、subtree"></a>二、<code>subtree</code></h3><h4 id="1-简介"><a href="#1-简介" class="headerlink" title="1.简介"></a>1.简介</h4><p><code>subtree</code>与<code>submodule</code>的作用是一样的，但是<code>subtree</code>出现得比<code>submodule</code>晚，它的出现是为了弥补<code>submodule</code>存在的问题：</p>
<ul>
<li><strong>第一：</strong><code>submodule</code>不能在父版本库中修改子版本库的代码，只能在子版本库中修改，是单向的；</li>
<li><strong>第二：</strong><code>submodule</code>没有直接删除子版本库的功能；</li>
</ul>
<p>而<code>subtree</code>则可以实现双向数据修改。官方推荐使用<code>subtree</code>替代<code>submodule</code>。</p>
<h4 id="2-创建子库"><a href="#2-创建子库" class="headerlink" title="2.创建子库"></a>2.创建子库</h4><p>首先创建两个版本库：<code>git_subtree_parent</code>和<code>git_subtree_child</code>然后在<code>git_subtree_parent</code>中执行<code>git subtree</code>会列出该指令的一些常见的参数：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173352649.png" alt="image-20200330112616987"></p>
<h4 id="3-建立关联"><a href="#3-建立关联" class="headerlink" title="3.建立关联"></a>3.建立关联</h4><p>首先需要给<code>git_subtree_parent</code>添加一个子库<code>git_subtree_child</code>:</p>
<p><strong>第一步：</strong>添加子库的远程地址：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add subtree-origin git@github.com:AhuntSun/git_subtree_child.git</span><br></pre></td></tr></table></figure>

<p>添加完成后，父版本库中就有两个远程地址了：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173352728.png" alt="image-20200330113223780"></p>
<p>这里的<code>subtree-origin</code>就代表了远程仓库<code>git_subtree_child</code>的地址。</p>
<p><strong>第二步：</strong>建立依赖关系：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git subtree add --prefix=subtree subtree-origin master --squash</span><br><span class="line">//其中的--prefix=subtree可以写成：--p subtree 或 --prefix subtree</span><br></pre></td></tr></table></figure>

<p>该命令表示将远程地址为<code>subtree-origin</code>的，子版本库上<code>master</code>分支的，文件克隆到<code>subtree</code>目录下；</p>
<blockquote>
<p>注意：是在某一分支（如<code>master</code>）上将<code>subtree-origin</code>代表的远程仓库的某一分支（如<code>master</code>）作为子库拉取到<code>subtree</code>文件夹中。可切换到其他分支重复上述操作，也就是说子库的实质就是子分支。</p>
</blockquote>
<p><code>--squash</code>是可选参数，它的含义是<strong>合并，压缩</strong>的意思。</p>
<ul>
<li>如果不增加这个参数，则会把远程的子库中指定的分支（这里是<code>master</code>）中的提交一个一个地拉取到本地再去创建一个合并提交；</li>
<li>如果增加了这个参数，会将远程子库指定分支上的多次提交合并压缩成一次提交再拉取到本地，这样拉取到本地的，远程子库中的，指定分支上的，历史提交记录就没有了。</li>
</ul>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173352794.png" alt="image-20200330114203889"></p>
<p>拉取完成后，父版本库中会增添一个<code>subtree</code>目录，里面是子库的文件，相当于把依赖的子库代码拉取到了本地：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173352867.png" alt="image-20200330114316257"></p>
<p>此时查看一下父版本库的提交历史：<br><img src="/2020/04/29/Git/submodule/IMG-20250804173352932.png" alt="image-20200330114500554"></p>
<p>会发现其中没有子库李四的提交信息，这是因为<code>--squash</code>参数将他的提交压缩为一次提交，并由父版本库张三进行合并和提交。所以父版本库多出了两次提交。</p>
<p>随后，我们在父版本库中进行一次推送：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173353000.png" alt="image-20200330114730534"></p>
<p>结果远程仓库中多出了一个存放子版本库文件的<code>subtree</code>目录，并且完全脱离了版本库<code>git_subtree_child</code>，仅仅是属于父版本库<code>git_subtree_parent</code>的一个目录。而不像使用<code>submodule</code>那样，是一个点击就会自动跳转到依赖子库的<strong>指针</strong>：</p>
<ul>
<li><code>subtree</code>的远程父版本库：</li>
</ul>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173353062.png" alt="image-20200330115004586"></p>
<ul>
<li><code>submodule</code>的远程父版本库：</li>
</ul>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173353132.png" alt="image-20200329203746236"></p>
<p>即<code>submodule</code>与<code>subtree</code>子库的区别为：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173353195.png" alt="image-20200408224805624"></p>
<h4 id="4-同步子库变化"><a href="#4-同步子库变化" class="headerlink" title="4.同步子库变化"></a>4.同步子库变化</h4><p>在子库中创建一个新文件<code>world</code>并推送到远程子库：<br><img src="/2020/04/29/Git/submodule/IMG-20250804173353257.png" alt="image-20200330115440136"></p>
<p>在父库中通过如下指令更新依赖的子库内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git subtree pull --prefix=subtree subtree-origin master --squash</span><br></pre></td></tr></table></figure>

<p><img src="/2020/04/29/Git/submodule/IMG-20250804173353320.png" alt="image-20200330115726052"></p>
<p>此时查看一下提交历史：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173353393.png" alt="image-20200330115755340"></p>
<p>发现没有子库李四的提交信息，这都是<code>--squash</code>的作用。子库的修改交由父库来提交。</p>
<h4 id="5-参数-squash"><a href="#5-参数-squash" class="headerlink" title="5.参数--squash"></a>5.参数<code>--squash</code></h4><p>该参数的作用为：防止子库指定分支上的提交历史污染父版本库。比如在子库的<code>master</code>分支上进行了三次提交分别为：<code>a</code>、<code>b</code>、<code>c</code>，并推送到远程子库。</p>
<p>首先，复习一下合并分支时遵循的<strong>三方合并</strong>原则：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173353499.png" alt="image-20200408003842196"></p>
<p>当提交<code>4</code>和<code>6</code>需要合并的时候，<code>git</code>会先寻找二者的公共父提交节点，如图中的<code>2</code>，然后在提交<code>2</code>的基础上进行<code>2</code>、<code>4</code>、<code>6</code>的三方合并，合并后得到提交<code>7</code>。</p>
<p>父仓库执行<code>pull</code>操作时：如果添加参数<code>--squash</code>，就会把远程子库<code>master</code>分支上的这三次提交合并为一次新的提交<code>abc</code>；随后再与父仓库中子库的<code>master</code>分支进行合并，又产生一次提交<code>X</code>。整个<code>pull</code>的过程一共产生了五次提交，如下图所示：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173353566.png" alt="image-20200420103912282"></p>
<p><strong>存在的问题：</strong></p>
<p>由于<code>--squash</code>指令的合并操作，会导致远程<code>master</code>分支上的合并提交<code>abc</code>与本地<code>master</code>分支上的最新提交<code>2</code>，找不到公共父节点，从而合并失败。同时<code>push</code>操作也会出现额外的问题。</p>
<p><strong>最佳实践：要么全部操作都使用<code>--squash</code>指令，要么全部操作都不使用该参数，这样就不会出错。</strong></p>
<p><strong>错误示范：</strong></p>
<p>为了验证，重新创建两个仓库<code>A</code>和<code>B</code>，并通过<code>subtree</code>将<code>B</code>设置为<code>A</code>的子库。这次全程都没有使用参数<code>--squash</code>，重复上述操作：</p>
<ul>
<li>首先，修改子库文件；</li>
<li>然后，通过下列指令，在不使用参数<code>--squash</code>的情况下，将远程子库<code>A</code>变化的文件拉取到本地：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git subtree pull --prefix=subtree subtree-origin master</span><br></pre></td></tr></table></figure>

<p><img src="/2020/04/29/Git/submodule/IMG-20250804173353638.png" alt="image-20200330141920474"></p>
<p>此时查看提交历史：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173353705.png" alt="image-20200330142000915"></p>
<p>可以看到子库<code>儿子</code>的提交信息污染了父版本库的提交信息，验证了上述的结论。</p>
<p>所以要么都使用该指令，要么都不使用才能避免错误；如果不需要子库的提交日志，推荐使用<code>--squash</code>指令。</p>
<blockquote>
<p><strong>补充：</strong><code>echo &#39;new line&#39; &gt;&gt; test.txt</code>：表示在<code>test.txt</code>文件末尾追加文本<code>new line</code>；如果是一个<code>&gt;</code>表示替换掉<code>test.txt</code>内的全部内容。</p>
</blockquote>
<h4 id="6-修改子库"><a href="#6-修改子库" class="headerlink" title="6.修改子库"></a>6.修改子库</h4><p><code>subtree</code>的强大之处在于，它可以在父版本库中修改依赖的子版本库。以下为演示：</p>
<p>进入父版本库存放子库的<code>subtree</code>目录，修改子库文件<code>child.txt</code>，并推送到远程父仓库：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173353778.png" alt="image-20200330121429186"></p>
<p>此时远程父版本库中存放子库文件的<code>subtree</code>目录发生了变化，但是独立的远程子库<code>git_subtree_child</code>并没有发生变化。</p>
<ul>
<li><p><strong>修改独立的远程子库：</strong></p>
<p>可执行以下命令，同步地修改远程子版本库：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git subtree push --prefix=subtree subtree-origin master</span><br></pre></td></tr></table></figure>

<p>如下图所示，父库中的子库文件<code>child.txt</code>新增的<code>child2</code>内容，同步到了独立的远程子库中：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173353847.png" alt="image-20200330125911158"></p>
</li>
<li><p><strong>修改独立的本地子库：</strong></p>
<p>回到本地子库<code>git_subtree_child</code>，将对应的远程子库进行的修改拉取到本地进行合并同步：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173353920.png" alt="image-20200330144044823"></p>
<p>由此无论是远程的还是本地的子库都被修改了。</p>
</li>
</ul>
<blockquote>
<p>实际上使用<code>subtree</code>后，在外部看起来父仓库和子仓库是一个整体的仓库。执行<code>clone</code>操作时，不会像<code>submodule</code>那样需要遍历子库来单独克隆。而是可以将整个父仓库和它所依赖的子库当做一个整体进行克隆。</p>
</blockquote>
<h5 id="存在的问题"><a href="#存在的问题" class="headerlink" title="存在的问题"></a>存在的问题</h5><p>父版本库拉取远程子库进行更新同步会出现的问题：</p>
<ul>
<li><p><strong>子仓库第一次修改：</strong></p>
<p>经历了上述操作，本地子库与远程子库的文件达到了同步，其中文件<code>child.txt</code>的内容都是<code>child~4</code>。在此基础上本地子库为该文件添加<code>child5~6</code>：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173353989.png" alt="image-20200330145702019"></p>
<p>然后推送到远程子库。</p>
</li>
<li><p><strong>父仓库第一次拉取：</strong></p>
<p>随后父版本库通过下述指令，拉取远程子库，与本地父仓库<code>git_subtree_parent</code>中的子库进行同步：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git subtree pull --p subtree subtree-origin master --squash</span><br></pre></td></tr></table></figure>

<p>结果出现了合并失败的情况：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173354061.png" alt="image-20200330145839093"></p>
<p>我们查看冲突产生的文件：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173354122.png" alt="image-20200330145922152"></p>
<p>发现父版本库中的子库与远程子库内容上并无冲突，但是却发生了冲突，这是为什么呢？</p>
<p>探究冲突产生的原因之前我们先解决冲突，先删除多余的内容：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173354192.png" alt="image-20200330150141430"></p>
<p>随后执行<code>git add</code>命令和<code>git commit</code>命令标识解决了冲突：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173354255.png" alt="image-20200330150312944"></p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173354332.png" alt="image-20200330150406317"></p>
<p>解决完冲突后将该文件推送到独立的远程子库，发现文件并没有发生更新，也就是说<code>git</code>认为我们并没有解决冲突：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173354398.png" alt="image-20200330150747452"></p>
</li>
<li><p><strong>子仓库第二次修改与父仓库第二次拉取：</strong></p>
<p>再次修改本地子库的文件并推送到对应的远程仓库，父版本库再次将远程子库更新的文件拉取到本地进行同步：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173354467.png" alt="image-20200330151140092"></p>
<p>这次却成功了！为什么同样的操作，有的时候成功有的时候失败呢？</p>
</li>
</ul>
<h5 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h5><p>原因出现在<code>--squash</code>指令中。实际上，<code>--squash</code>指令把子库中的提交信息合并了，导致父仓库在执行<code>git pull</code>操作时找不到公共的父节点，从而导致即使文件没有冲突的内容，也会出现合并冲突的情况。其实不使用<code>--squash</code>也会有这种问题，问题的根本原因仍然是<strong>三方合并时找不到公共父节点</strong>。我们打开<code>gitk</code>：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173354530.png" alt="image-20200330154944300"></p>
<p>从图中不难看出，当使用<code>subtree</code>时，子库与父库之间是没有公共节点的，所以时常会因为找不到公共节点而出现合并冲突的情况，此时只需要解决冲突，手动合并即可。</p>
<blockquote>
<p>不使用<code>subtree</code>时，普通的版本库中的各分支总会有一个公共节点：</p>
<p><img src="/2020/04/29/Git/submodule/IMG-20250804173354600.png" alt="image-20200330160206258"></p>
</blockquote>
<p><strong>再次强调：</strong>使用<code>--squash</code>指令时一定要小心，要么都使用它，要么都不使用。</p>
<h4 id="7-抽离子库"><a href="#7-抽离子库" class="headerlink" title="7.抽离子库"></a>7.抽离子库</h4><h5 id="git-subtree-split"><a href="#git-subtree-split" class="headerlink" title="git subtree split"></a><code>git subtree split</code></h5><p>当开发过程中出现某些子库完全可以复用到其他项目中时，我们希望将它独立出来。</p>
<ul>
<li><p><strong>方法一：</strong>可以手动将文件拷贝出来。缺点是，这样会丢失关于该子库的提交记录；</p>
</li>
<li><p>方法二：</p>
<p>使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git subtree split</span><br></pre></td></tr></table></figure>

<p>指令，该指令会把关于独立出来的子库的每次提交都记录起来。但是，这样存在弊端：</p>
<ul>
<li>比如该独立子库为<code>company.util</code>，当一次提交同时修改了<code>company.util</code>和<code>company.server</code>两个子库时。</li>
<li>通过上述命令独立出来的子库<code>util</code>只会记录对自身修改的提交，而不会记录对<code>company.server</code>的修改，这样在别人看来这次提交就只修改了<code>util</code>，这是不完整的。</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chengming0916.github.io/2020/04/28/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/DotNet/C#%E6%97%B6%E9%97%B4%E6%88%B3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Chemmy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/04/28/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/DotNet/C#%E6%97%B6%E9%97%B4%E6%88%B3/" class="post-title-link" itemprop="url">C#时间戳</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-04-28 16:32:14" itemprop="dateCreated datePublished" datetime="2020-04-28T16:32:14+08:00">2020-04-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-04 16:58:11" itemprop="dateModified" datetime="2025-12-04T16:58:11+08:00">2025-12-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">编程技术</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BC%96%E7%A8%8B%E6%8A%80%E6%9C%AF/DotNet/" itemprop="url" rel="index"><span itemprop="name">DotNet</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>来源：<a target="_blank" rel="noopener" href="https://links.jianshu.com/go?to=https://blog.guoqianfan.com/2019/11/24/timestamp-in-csharp/">https://blog.guoqianfan.com/2019/11/24/timestamp-in-csharp/</a></p>
</blockquote>
<h2 id="什么是时间戳"><a href="#什么是时间戳" class="headerlink" title="什么是时间戳"></a>什么是时间戳</h2><blockquote>
<p>时间戳默认是<strong>Unix时间戳</strong>。</p>
</blockquote>
<p>首先要清楚JavaScript与Unix的时间戳的区别：</p>
<p>JavaScript时间戳：是指格林威治时间1970年01月01日00时00分00秒(北京时间1970年01月01日08时00分00秒)起至现在的<strong>总毫秒数</strong>。</p>
<p>Unix时间戳：是指格林威治时间1970年01月01日00时00分00秒(北京时间1970年01月01日08时00分00秒)起至现在的<strong>总秒数</strong>。</p>
<p>可以看出JavaScript时间戳是<strong>总毫秒数</strong>，Unix时间戳是<strong>总秒数</strong>。</p>
<p>比如同样是的 2016&#x2F;11&#x2F;03 12:30:00 ，转换为JavaScript时间戳为 1478147400000；转换为Unix时间戳为 1478147400。</p>
<p>从上面也可以看出<strong>时间戳与时区无关</strong>。</p>
<h2 id="Unix时间戳相互转换"><a href="#Unix时间戳相互转换" class="headerlink" title="Unix时间戳相互转换"></a>Unix时间戳相互转换</h2><h3 id="C-DateTime转换为Unix时间戳"><a href="#C-DateTime转换为Unix时间戳" class="headerlink" title="C# DateTime转换为Unix时间戳"></a>C# DateTime转换为Unix时间戳</h3><h4 id="NET-4-6新方法"><a href="#NET-4-6新方法" class="headerlink" title=".NET 4.6新方法"></a>.NET 4.6新方法</h4><p>只能在 .NET 4.6及更高版本里才能使用。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">long timeStamp = DateTimeOffset.Now.ToUnixTimeSeconds(); </span><br><span class="line">Console.WriteLine(timeStamp);</span><br></pre></td></tr></table></figure>

<h4 id="通用的老方法"><a href="#通用的老方法" class="headerlink" title="通用的老方法"></a>通用的老方法</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">System.DateTime startTime = TimeZone.CurrentTimeZone.ToLocalTime(new System.DateTime(1970, 1, 1)); </span><br><span class="line">long timeStamp = (long)(DateTime.Now - startTime).TotalSeconds; </span><br><span class="line">System.Console.WriteLine(timeStamp);</span><br></pre></td></tr></table></figure>

<h3 id="Unix时间戳转换为C-DateTime"><a href="#Unix时间戳转换为C-DateTime" class="headerlink" title="Unix时间戳转换为C# DateTime"></a>Unix时间戳转换为C# DateTime</h3><h4 id="NET-4-6新方法-1"><a href="#NET-4-6新方法-1" class="headerlink" title=".NET 4.6新方法"></a>.NET 4.6新方法</h4><p>由时间戳转换的<code>DateTimeOffset</code>的时区默认是<code>+00:00</code>，此时我们需要<strong>转为本地时区</strong>，否则后续使用可能会有问题。</p>
<p>转为本地时区：<code>DateTimeOffset.LocalDateTime</code>。</p>
<p>示例代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">DateTimeOffset dto = DateTimeOffset.FromUnixTimeMilliseconds(1573696406184);</span><br><span class="line"></span><br><span class="line">DateTime dt01 = dto.DateTime;</span><br><span class="line"></span><br><span class="line">DateTime dt02 = dto.LocalDateTime;</span><br></pre></td></tr></table></figure>

<h4 id="通用的老方法-1"><a href="#通用的老方法-1" class="headerlink" title="通用的老方法"></a>通用的老方法</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">long unixTimeStamp = 1478162177;</span><br><span class="line">System.DateTime startTime = TimeZone.CurrentTimeZone.ToLocalTime(new System.DateTime(1970, 1, 1)); </span><br><span class="line">DateTime dt = startTime.AddSeconds(unixTimeStamp);</span><br><span class="line">System.Console.WriteLine(dt.ToString(&quot;yyyy/MM/dd HH:mm:ss:ffff&quot;));</span><br></pre></td></tr></table></figure>

<h2 id="备注"><a href="#备注" class="headerlink" title="备注"></a>备注</h2><h3 id="DateTimeOffset使用Now还是UtcNow"><a href="#DateTimeOffset使用Now还是UtcNow" class="headerlink" title="DateTimeOffset使用Now还是UtcNow"></a>DateTimeOffset使用Now还是UtcNow</h3><p>对于<code>DateTimeOffset</code>，发现有2个获取当前时间的属性：<code>DateTimeOffset.Now</code>和<code>DateTimeOffset.UtcNow</code>。</p>
<p>如果只是<strong>获取时间戳</strong>，这2个使用哪个都可以，得到的值是一样的。</p>
<p>因为<code>DateTimeOffset</code>里面有时区信息，获取时间戳时会使用时区进行转换的，所以获得的时间戳一样。</p>
<p>而也是因为时区的原因，<code>DateTimeOffset</code>的其他操作可能会不一样。例如<code>DateTimeOffset.DateTime</code>就不一样，此时推荐使用<code>DateTimeOffset.LocalDateTime</code>来获得本地时区的时间。</p>
<p>测试代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Console.WriteLine(&quot;none：&#123;0&#125;&quot;, DateTimeOffset.Now);</span><br><span class="line"></span><br><span class="line">Console.WriteLine(&quot;utc：&#123;0&#125;&quot;, DateTimeOffset.UtcNow);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Console.WriteLine(&quot;none：&#123;0&#125;&quot;, DateTimeOffset.Now.ToUnixTimeSeconds());</span><br><span class="line"></span><br><span class="line">Console.WriteLine(&quot;utc：&#123;0&#125;&quot;, DateTimeOffset.UtcNow.ToUnixTimeSeconds());</span><br></pre></td></tr></table></figure>

<h3 id="DateTime转换为DateTimeOffset"><a href="#DateTime转换为DateTimeOffset" class="headerlink" title="DateTime转换为DateTimeOffset"></a>DateTime转换为DateTimeOffset</h3><p>可以直接把<code>DateTime</code>赋值给<code>DateTimeOffset</code>，内部会自动进行隐式转换。这里涉及到时区，请往下看。</p>
<h4 id="DateTime的时区信息-Kind属性"><a href="#DateTime的时区信息-Kind属性" class="headerlink" title="DateTime的时区信息(Kind属性)"></a>DateTime的时区信息(Kind属性)</h4><p><code>DateTime</code>的<strong>时区信息</strong>存放在<code>Kind</code>属性里。<code>Kind</code>属性的数据类型是<code>DateTimeKind</code>枚举，只有3个值：</p>
<ul>
<li><code>Unspecified</code>：未指定&#x2F;未规定</li>
<li><code>Utc</code>：<code>UTC</code>时间</li>
<li><code>Local</code>：本地时区</li>
</ul>
<p>不同情况下得到的<code>DateTime</code>的<code>Kind</code>是不同的，具体如下：</p>
<ul>
<li><p><code>DateTime.Now</code>：<code>DateTime.Kind</code>是 **<code>Local</code>(本地时区)**。</p>
</li>
<li><p><code>DateTime.UtcNow</code>：<code>DateTime.Kind</code>是 **<code>Utc</code>**。</p>
</li>
<li><p><code>DateTime.Parse()</code>：</p>
<ul>
<li><p>【<strong>默认</strong>】在<strong>未指定时区</strong>时，<code>DateTime.Kind</code>是 <strong><code>Unspecified</code></strong></p>
</li>
<li><p>指定时区：指定时区后<code>DateTime.Kind</code>就是相对应的值。</p>
<p>指定时区有2种方式：</p>
<ul>
<li>【<strong>默认+优先</strong>】<strong>待转换的字符串</strong>里有时区信息。例如：<code>2019/11/24 17:40:32 +08:00</code></li>
<li>使用<code>DateTimeStyles</code>参数来指定时区。<code>DateTimeStyles</code>是枚举类型，更多信息自己查看定义，这里不再多说。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><code>Local</code>和<code>Utc</code>都会把相应的时区传递过去。对于 <strong><code>Unspecified</code>(未指定)<strong>，会被当做</strong>本地时区</strong>来处理（结果已验证，<a target="_blank" rel="noopener" href="https://links.jianshu.com/go?to=https://source.dot.net/%23System.Private.CoreLib/DateTimeOffset.cs">源码</a>没看懂）。</p>
<h4 id="测试代码"><a href="#测试代码" class="headerlink" title="测试代码"></a>测试代码</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">DateTime dtNow = DateTime.Now;</span><br><span class="line"></span><br><span class="line">DateTime dtUtcNow = DateTime.UtcNow;</span><br><span class="line"></span><br><span class="line">DateTime dtParse = DateTime.Parse(&quot;2019-11-24 17:40:13&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DateTimeOffset dtoNow = dtNow;</span><br><span class="line"></span><br><span class="line">DateTimeOffset dtoUtcNow = dtUtcNow;</span><br><span class="line"></span><br><span class="line">DateTimeOffset dtoParse = dtParse;</span><br><span class="line"></span><br><span class="line">Console.WriteLine(&quot;DateTime：&quot;);</span><br><span class="line">Console.WriteLine(&quot;dtNow：&#123;0&#125;(Kind：&#123;1&#125;)&quot;, dtNow, dtNow.Kind);</span><br><span class="line">Console.WriteLine(&quot;dtUtcNow：&#123;0&#125;(Kind：&#123;1&#125;)&quot;, dtUtcNow, dtUtcNow.Kind);</span><br><span class="line">Console.WriteLine(&quot;dtParse：&#123;0&#125;(Kind：&#123;1&#125;)&quot;, dtParse, dtParse.Kind);</span><br><span class="line"></span><br><span class="line">Console.WriteLine();</span><br><span class="line"></span><br><span class="line">Console.WriteLine(&quot;DateTimeOffset：&quot;);</span><br><span class="line">Console.WriteLine(&quot;dtoNow：&#123;0&#125;&quot;, dtoNow);</span><br><span class="line">Console.WriteLine(&quot;dtoUtcNow：&#123;0&#125;&quot;, dtoUtcNow);</span><br><span class="line">Console.WriteLine(&quot;dtoParse：&#123;0&#125;&quot;, dtoParse);</span><br></pre></td></tr></table></figure>

<p>输出结果如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">DateTime：</span><br><span class="line">dtNow：2019/11/24 17:40:32(Kind：Local)</span><br><span class="line">dtUtcNow：2019/11/24 9:40:32(Kind：Utc)</span><br><span class="line">dtParse：2019/11/24 17:40:13(Kind：Unspecified)</span><br><span class="line"></span><br><span class="line">DateTimeOffset：</span><br><span class="line">dtoNow：2019/11/24 17:40:32 +08:00</span><br><span class="line">dtoUtcNow：2019/11/24 9:40:32 +00:00</span><br><span class="line">dtoParse：2019/11/24 17:40:13 +08:00</span><br></pre></td></tr></table></figure>

<h3 id="DateTimeOffset-Parse的默认时区"><a href="#DateTimeOffset-Parse的默认时区" class="headerlink" title="DateTimeOffset.Parse的默认时区"></a>DateTimeOffset.Parse的默认时区</h3><p><code>DateTimeOffset.Parse</code>的默认时区是<strong>当前时区</strong>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Console.WriteLine(&quot;parse：&#123;0&#125;&quot;, DateTimeOffset.Parse(&quot;2019-6-14 15:38:49&quot;));</span><br></pre></td></tr></table></figure>

<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol>
<li>C# DateTime与时间戳转换：<a target="_blank" rel="noopener" href="https://links.jianshu.com/go?to=https://www.cnblogs.com/polk6/p/6024892.html">https://www.cnblogs.com/polk6/p/6024892.html</a></li>
<li>如何将Unix时间戳转换为DateTime，反之亦然？：<a target="_blank" rel="noopener" href="https://links.jianshu.com/go?to=https://stackoverflow.com/questions/249760/how-can-i-convert-a-unix-timestamp-to-datetime-and-vice-versa">https://stackoverflow.com/questions/249760/how-can-i-convert-a-unix-timestamp-to-datetime-and-vice-versa</a></li>
<li>DateTimeOffset源码：<a target="_blank" rel="noopener" href="https://links.jianshu.com/go?to=https://source.dot.net/%23System.Private.CoreLib/DateTimeOffset.cs">https://source.dot.net/#System.Private.CoreLib/DateTimeOffset.cs</a></li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chengming0916.github.io/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Chemmy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/" class="post-title-link" itemprop="url">8种主要排序算法的CSharp实现</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-11-30 00:01:26" itemprop="dateCreated datePublished" datetime="2019-11-30T00:01:26+08:00">2019-11-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-04 16:58:11" itemprop="dateModified" datetime="2025-12-04T16:58:11+08:00">2025-12-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">排序算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="8种主要排序算法的C-实现"><a href="#8种主要排序算法的C-实现" class="headerlink" title="8种主要排序算法的C#实现"></a>8种主要排序算法的C#实现</h1><blockquote>
<h2 id="Excerpt"><a href="#Excerpt" class="headerlink" title="Excerpt"></a>Excerpt</h2><p>8种主要排序算法的实现及优化，包含选择排序，冒泡排序，插入排序，快速排序，归并排序，堆排序，希尔排序，基数排序。文末实际测试并比较。</p>
</blockquote>
<hr>
<p>新的一年到了，很多园友都辞职要去追求更好的工作环境，我也是其中一个，呵呵！</p>
<p>最近闲暇的时候我开始重温一些常用的算法。老早就买了《算法导论》，一直都没啃下去。</p>
<p>这本书确实很好，只是太难读了，总是读了几章就又读不下去了！工作上也几乎用不到。</p>
<p>我这段时间发现看这些排序算法比以前容易了很多，就借此机会将它们整理总结起来。</p>
<p>一是方便以后重温，二是可以应对笔试面试。同时也希望这篇博文可以帮助各位刚辞职和正在学习排序算法的园友。</p>
<p>PS：有可能实现的代码并不是最优的，如果有什么错误或者值得改进的地方，还请大家帮忙指出。</p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>排序算法是我们编程中遇到的最多的算法。目前主流的算法有8种。</p>
<p>  平均时间复杂度从高到低依次是：</p>
<p>     冒泡排序（o(n<sup>2</sup>)），选择排序（o(n<sup>2</sup>)），插入排序（o(n<sup>2</sup>)），堆排序（o(nlogn)），</p>
<p>     归并排序（o(nlogn)），快速排序（o(nlogn)）， 希尔排序（o(n<sup>1.25</sup>)），基数排序（o(n)）</p>
<p>这些平均时间复杂度是参照维基百科<a target="_blank" rel="noopener" href="http://zh.wikipedia.org/wiki/%E6%8E%92%E5%BA%8F">排序算法</a>罗列的。</p>
<p>是计算的理论平均值，并不意味着你的代码实现能达到这样的程度。</p>
<p>例如希尔排序，时间复杂度是由选择的步长决定的。基数排序时间复杂度最小，</p>
<p>但我实现的基数排序的速度并不是最快的，后面的结果测试图可以看到。</p>
<p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/fatbird/p/SortAlgorithm.html">本文</a>代码实现使用的数据源类型为IList<int>，这样可以兼容int[]和List<int>(虽然int[]有ToList()，</p>
<p>List<int>有ToArray()，哈哈！)。</p>
<h2 id="选择排序"><a href="#选择排序" class="headerlink" title="选择排序"></a>选择排序</h2><p>选择排序是我觉得最简单暴力的排序方式了。</p>
<p>以前刚接触排序算法的时候，感觉算法太多搞不清，唯独记得选择排序的做法及实现。</p>
<p>原理：找出参与排序的数组最大值，放到末尾（或找到最小值放到开头） <a target="_blank" rel="noopener" href="http://zh.wikipedia.org/wiki/%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F">维基入口</a></p>
<p>实现如下：</p>
<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt; 1&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; SelectSort(IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt; data)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = &lt;span&gt;0&lt;/span&gt;; i &amp;lt; data.Count - &lt;span&gt;1&lt;/span&gt;; i++&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;                 &lt;span&gt;int&lt;/span&gt; min =&lt;span&gt; i;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;                 &lt;span&gt;int&lt;/span&gt; temp =&lt;span&gt; data[i];</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;                 &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; j = i + &lt;span&gt;1&lt;/span&gt;; j &amp;lt; data.Count; j++&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;                &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;                     &lt;span&gt;if&lt;/span&gt; (data[j] &amp;lt;&lt;span&gt; temp)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; &lt;span&gt;                    &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;                         min =&lt;span&gt; j;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;                         temp =&lt;span&gt; data[j];</span><br><span class="line">&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;                    &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;14&lt;/span&gt; &lt;span&gt;                &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;15&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (min !=&lt;span&gt; i)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; &lt;span&gt;                    Swap(data, min, i);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;17&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;         &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<p>过程解析：将剩余数组的最小数交换到开头。</p>
<h2 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h2><p>冒泡排序是笔试面试经常考的内容，虽然它是这些算法里排序速度最慢的（汗），后面有测试为证。</p>
<p>原理：从头开始，每一个元素和它的下一个元素比较，如果它大，就将它与比较的元素交换，否则不动。</p>
<p>这意味着，大的元素总是在向后慢慢移动直到遇到比它更大的元素。所以每一轮交换完成都能将最大值</p>
<p>冒到最后。  <a target="_blank" rel="noopener" href="http://zh.wikipedia.org/wiki/%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F#.E5.8A.A9.E8.AE.B0.E7.A0.81">维基入口</a></p>
<p>实现如下：</p>
<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt; 1&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; BubbleSort(IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt; data)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = data.Count - &lt;span&gt;1&lt;/span&gt;; i &amp;gt; &lt;span&gt;0&lt;/span&gt;; i--&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;                 &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; j = &lt;span&gt;0&lt;/span&gt;; j &amp;lt; i; j++&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;                &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;                     &lt;span&gt;if&lt;/span&gt; (data[j] &amp;gt; data[j + &lt;span&gt;1&lt;/span&gt;&lt;span&gt;])</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;                         Swap(data, j, j + &lt;span&gt;1&lt;/span&gt;&lt;span&gt;);</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt; &lt;span&gt;                &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;         &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<p>过程解析：中需要注意的是j&lt;i，每轮冒完泡必然会将最大值排到数组末尾，所以需要排序的数应该是在减少的。</p>
<p>很多网上版本每轮冒完泡后依然还是将所有的数进行第二轮冒泡即j&lt;data.Count-1，这样会增加比较次数。</p>
<h4 id="通过标识提升冒泡排序"><a href="#通过标识提升冒泡排序" class="headerlink" title="通过标识提升冒泡排序"></a>通过标识提升冒泡排序</h4><p>在维基上看到，可以通过添加标识来分辨剩余的数是否已经有序来减少比较次数。感觉很有意思，可以试试。</p>
<p>实现如下：</p>
<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt; 1&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; BubbleSortImprovedWithFlag(IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt; data)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;             &lt;span&gt;bool&lt;/span&gt;&lt;span&gt; flag;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = data.Count - &lt;span&gt;1&lt;/span&gt;; i &amp;gt; &lt;span&gt;0&lt;/span&gt;; i--&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;                 flag = &lt;span&gt;true&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;                 &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; j = &lt;span&gt;0&lt;/span&gt;; j &amp;lt; i; j++&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;                &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;                     &lt;span&gt;if&lt;/span&gt; (data[j] &amp;gt; data[j + &lt;span&gt;1&lt;/span&gt;&lt;span&gt;])</span><br><span class="line">&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; &lt;span&gt;                    &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;                         Swap(data, j, j + &lt;span&gt;1&lt;/span&gt;&lt;span&gt;);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;                         flag = &lt;span&gt;false&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;                    &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;14&lt;/span&gt; &lt;span&gt;                &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;15&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (flag) &lt;span&gt;break&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;         &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<p>过程解析：发现某轮冒泡没有任何数进行交换（即已经有序），就跳出排序。</p>
<p>我起初也以为这个方法是应该有不错效果的，可是实际测试结果并不如想的那样。和未优化耗费时间一样（对于随机数列）。</p>
<p>由果推因，那么应该是冒泡排序对于随机数列，当剩余数列有序的时候，也没几个数要排列了！？</p>
<p>不过如果已经是有序数列或者部分有序的话，这个冒泡方法将会提升很大速度。</p>
<h3 id="鸡尾酒排序（来回排序）"><a href="#鸡尾酒排序（来回排序）" class="headerlink" title="鸡尾酒排序（来回排序）"></a>鸡尾酒排序（来回排序）</h3><h4 id="对冒泡排序进行更大的优化"><a href="#对冒泡排序进行更大的优化" class="headerlink" title="对冒泡排序进行更大的优化"></a>对冒泡排序进行更大的优化</h4><p>冒泡排序只是单向冒泡，而鸡尾酒来回反复双向冒泡。</p>
<p>原理：自左向右将大数冒到末尾，然后将剩余数列再自右向左将小数冒到开头，如此循环往复。<a target="_blank" rel="noopener" href="http://zh.wikipedia.org/wiki/%E5%BE%80%E8%BF%94%E6%8E%92%E5%BA%8F">维基入口</a></p>
<p>实现如下：</p>
<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt; 1&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; BubbleCocktailSort(IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt; data)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;             &lt;span&gt;bool&lt;/span&gt;&lt;span&gt; flag;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt; m = &lt;span&gt;0&lt;/span&gt;, n = &lt;span&gt;0&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = data.Count - &lt;span&gt;1&lt;/span&gt;; i &amp;gt; &lt;span&gt;0&lt;/span&gt;; i--&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;                 flag = &lt;span&gt;true&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (i % &lt;span&gt;2&lt;/span&gt; == &lt;span&gt;0&lt;/span&gt;&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt; &lt;span&gt;                &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;                     &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; j = n; j &amp;lt; data.Count - &lt;span&gt;1&lt;/span&gt; - m; j++&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; &lt;span&gt;                    &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;                         &lt;span&gt;if&lt;/span&gt; (data[j] &amp;gt; data[j + &lt;span&gt;1&lt;/span&gt;&lt;span&gt;])</span><br><span class="line">&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;                        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;                             Swap(data, j, j + &lt;span&gt;1&lt;/span&gt;&lt;span&gt;);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;15&lt;/span&gt;                             flag = &lt;span&gt;false&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; &lt;span&gt;                        &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;17&lt;/span&gt; &lt;span&gt;                    &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;                     &lt;span&gt;if&lt;/span&gt; (flag) &lt;span&gt;break&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;                     m++&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; &lt;span&gt;                &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;21&lt;/span&gt;                 &lt;span&gt;else&lt;/span&gt;</span><br><span class="line">&lt;span&gt;22&lt;/span&gt; &lt;span&gt;                &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;23&lt;/span&gt;                     &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; k = data.Count - &lt;span&gt;1&lt;/span&gt; - m; k &amp;gt; n; k--&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;24&lt;/span&gt; &lt;span&gt;                    &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;25&lt;/span&gt;                         &lt;span&gt;if&lt;/span&gt; (data[k] &amp;lt; data[k - &lt;span&gt;1&lt;/span&gt;&lt;span&gt;])</span><br><span class="line">&lt;/span&gt;&lt;span&gt;26&lt;/span&gt; &lt;span&gt;                        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;27&lt;/span&gt;                             Swap(data, k, k - &lt;span&gt;1&lt;/span&gt;&lt;span&gt;);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;28&lt;/span&gt;                             flag = &lt;span&gt;false&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;29&lt;/span&gt; &lt;span&gt;                        &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;30&lt;/span&gt; &lt;span&gt;                    &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;31&lt;/span&gt;                     &lt;span&gt;if&lt;/span&gt; (flag) &lt;span&gt;break&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;32&lt;/span&gt;                     n++&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;33&lt;/span&gt; &lt;span&gt;                &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;34&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;35&lt;/span&gt;         &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<p>过程解析：分析第i轮冒泡，i是偶数则将剩余数列最大值向右冒泡至末尾，是奇数则将剩余数列最小值</p>
<p>向左冒泡至开头。对于剩余数列，n为始，data.Count-1-m为末。</p>
<p>来回冒泡比单向冒泡：对于随机数列，更容易得到有序的剩余数列。因此这里使用标识将会提升的更加明显。</p>
<h2 id="插入排序"><a href="#插入排序" class="headerlink" title="插入排序"></a>插入排序</h2><p>插入排序是一种对于有序数列高效的排序。非常聪明的排序。只是对于随机数列，效率一般，交换的频率高。</p>
<p>原理：通过构建有序数列，将未排序的数从后向前比较，找到合适位置并插入。<a target="_blank" rel="noopener" href="http://zh.wikipedia.org/wiki/%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F">维基入口</a></p>
<p>第一个数当作有序数列。</p>
<p>实现如下：</p>
<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt; 1&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; InsertSort(IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt; data)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt;&lt;span&gt; temp;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = &lt;span&gt;1&lt;/span&gt;; i &amp;lt; data.Count; i++&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;                 temp =&lt;span&gt; data[i];</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;                 &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; j = i - &lt;span&gt;1&lt;/span&gt;; j &amp;gt;= &lt;span&gt;0&lt;/span&gt;; j--&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;                &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;                     &lt;span&gt;if&lt;/span&gt; (data[j] &amp;gt;&lt;span&gt; temp)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; &lt;span&gt;                    &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;                         data[j + &lt;span&gt;1&lt;/span&gt;] =&lt;span&gt; data[j];</span><br><span class="line">&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;                         &lt;span&gt;if&lt;/span&gt; (j == &lt;span&gt;0&lt;/span&gt;&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;                        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;                             data[&lt;span&gt;0&lt;/span&gt;] =&lt;span&gt; temp;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;15&lt;/span&gt;                             &lt;span&gt;break&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; &lt;span&gt;                        &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;17&lt;/span&gt; &lt;span&gt;                    &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;                     &lt;span&gt;else&lt;/span&gt;</span><br><span class="line">&lt;span&gt;19&lt;/span&gt; &lt;span&gt;                    &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;20&lt;/span&gt;                         data[j + &lt;span&gt;1&lt;/span&gt;] =&lt;span&gt; temp;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;21&lt;/span&gt;                         &lt;span&gt;break&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;22&lt;/span&gt; &lt;span&gt;                    &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;23&lt;/span&gt; &lt;span&gt;                &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;24&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;25&lt;/span&gt;         &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<p>过程解析：将要排序的数（索引为i）存储起来，向前查找合适位置j+1，将i-1到j+1的元素依次向后</p>
<p>移动一位，空出j+1，然后将之前存储的值放在这个位置。</p>
<p>这个方法写的不如维基上的简洁清晰，由于合适位置是j+1所以多出了对j&#x3D;&#x3D;0的判断，但实际效率影响无差别。</p>
<p>建议比照维基和我写的排序，自行选择。</p>
<h4 id="二分查找法优化插入排序"><a href="#二分查找法优化插入排序" class="headerlink" title="二分查找法优化插入排序"></a>二分查找法优化插入排序</h4><p>插入排序主要工作是在有序的数列中对要排序的数查找合适的位置，而查找里面经典的二分查找法正可以适用。</p>
<p>原理：通过二分查找法的方式找到一个位置索引。当要排序的数插入这个位置时，大于前一个数，小于后一个数。</p>
<p>实现如下：</p>
<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt; 1&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; InsertSortImprovedWithBinarySearch(IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt; data)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt;&lt;span&gt; temp;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt;&lt;span&gt; tempIndex;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = &lt;span&gt;1&lt;/span&gt;; i &amp;lt; data.Count; i++&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;                 temp =&lt;span&gt; data[i];</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;                 tempIndex = BinarySearchForInsertSort(data, &lt;span&gt;0&lt;/span&gt;&lt;span&gt;, i, i);</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;                 &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; j = i - &lt;span&gt;1&lt;/span&gt;; j &amp;gt;= tempIndex; j--&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; &lt;span&gt;                &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;                     data[j + &lt;span&gt;1&lt;/span&gt;] =&lt;span&gt; data[j];</span><br><span class="line">&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; &lt;span&gt;                &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;                 data[tempIndex] =&lt;span&gt; temp;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;14&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; &lt;span&gt;        &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; </span><br><span class="line">&lt;span&gt;17&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; BinarySearchForInsertSort(IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt; data, &lt;span&gt;int&lt;/span&gt; low, &lt;span&gt;int&lt;/span&gt; high, &lt;span&gt;int&lt;/span&gt;&lt;span&gt; key)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;18&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (low &amp;gt;= data.Count - &lt;span&gt;1&lt;/span&gt;&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;20&lt;/span&gt;                 &lt;span&gt;return&lt;/span&gt; data.Count - &lt;span&gt;1&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;21&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (high &amp;lt;= &lt;span&gt;0&lt;/span&gt;&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;22&lt;/span&gt;                 &lt;span&gt;return&lt;/span&gt; &lt;span&gt;0&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;23&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt; mid = (low + high) / &lt;span&gt;2&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;24&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (mid == key) &lt;span&gt;return&lt;/span&gt;&lt;span&gt; mid;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;25&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (data[key] &amp;gt;&lt;span&gt; data[mid])</span><br><span class="line">&lt;/span&gt;&lt;span&gt;26&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;27&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (data[key] &amp;lt; data[mid + &lt;span&gt;1&lt;/span&gt;&lt;span&gt;])</span><br><span class="line">&lt;/span&gt;&lt;span&gt;28&lt;/span&gt;                     &lt;span&gt;return&lt;/span&gt; mid + &lt;span&gt;1&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;29&lt;/span&gt;                 &lt;span&gt;return&lt;/span&gt; BinarySearchForInsertSort(data, mid + &lt;span&gt;1&lt;/span&gt;&lt;span&gt;, high, key);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;30&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;31&lt;/span&gt;             &lt;span&gt;else  &lt;span&gt;// data[key] &amp;lt;= data[mid]&lt;/span&gt;&lt;/span&gt;</span><br><span class="line">&lt;span&gt;32&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;33&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (mid - &lt;span&gt;1&lt;/span&gt; &amp;lt; &lt;span&gt;0&lt;/span&gt;) &lt;span&gt;return&lt;/span&gt; &lt;span&gt;0&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;34&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (data[key] &amp;gt; data[mid - &lt;span&gt;1&lt;/span&gt;&lt;span&gt;])</span><br><span class="line">&lt;/span&gt;&lt;span&gt;35&lt;/span&gt;                     &lt;span&gt;return&lt;/span&gt;&lt;span&gt; mid;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;36&lt;/span&gt;                 &lt;span&gt;return&lt;/span&gt; BinarySearchForInsertSort(data, low, mid - &lt;span&gt;1&lt;/span&gt;&lt;span&gt;, key);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;37&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;38&lt;/span&gt;         &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<p> 过程解析：需要注意的是二分查找方法实现中high-low&#x3D;&#x3D;1的时候mid&#x3D;&#x3D;low，所以需要33行</p>
<p>mid-1&lt;0即mid&#x3D;&#x3D;0的判断，否则下行会索引越界。</p>
<h2 id="快速排序"><a href="#快速排序" class="headerlink" title="快速排序"></a>快速排序</h2><p>快速排序是一种有效比较较多的高效排序。它包含了“分而治之”以及“哨兵”的思想。</p>
<p>原理：从数列中挑选一个数作为“哨兵”，使比它小的放在它的左侧，比它大的放在它的右侧。将要排序是数列递归地分割到</p>
<p>最小数列，每次都让分割出的数列符合“哨兵”的规则，自然就将数列变得有序。 <a target="_blank" rel="noopener" href="http://zh.wikipedia.org/wiki/%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F#.E5.8E.9F.E5.9C.B0.28in-place.29.E5.88.86.E5.89.B2.E7.9A.84.E7.89.88.E6.9C.AC">维基入口</a></p>
<p>实现如下：</p>
<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt; 1&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; QuickSortStrict(IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt; data)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;             QuickSortStrict(data, &lt;span&gt;0&lt;/span&gt;, data.Count - &lt;span&gt;1&lt;/span&gt;&lt;span&gt;);</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;        &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; </span><br><span class="line">&lt;span&gt; 6&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; QuickSortStrict(IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt; data, &lt;span&gt;int&lt;/span&gt; low, &lt;span&gt;int&lt;/span&gt;&lt;span&gt; high)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (low &amp;gt;= high) &lt;span&gt;return&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt; temp =&lt;span&gt; data[low];</span><br><span class="line">&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt; i = low + &lt;span&gt;1&lt;/span&gt;, j =&lt;span&gt; high;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;             &lt;span&gt;while&lt;/span&gt; (&lt;span&gt;true&lt;/span&gt;&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;                 &lt;span&gt;while&lt;/span&gt; (data[j] &amp;gt; temp) j--&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;                 &lt;span&gt;while&lt;/span&gt; (data[i] &amp;lt; temp &amp;amp;&amp;amp; i &amp;lt; j) i++&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;15&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (i &amp;gt;= j) &lt;span&gt;break&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; &lt;span&gt;                Swap(data, i, j);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;                 i++; j--&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;18&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (j !=&lt;span&gt; low)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; &lt;span&gt;                Swap(data, low, j);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;21&lt;/span&gt;             QuickSortStrict(data, j + &lt;span&gt;1&lt;/span&gt;&lt;span&gt;, high);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;22&lt;/span&gt;             QuickSortStrict(data, low, j - &lt;span&gt;1&lt;/span&gt;&lt;span&gt;);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;23&lt;/span&gt;         &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<p>过程解析：取的哨兵是数列的第一个值，然后从第二个和末尾同时查找，左侧要显示的是小于哨兵的值，</p>
<p>所以要找到不小于的i，右侧要显示的是大于哨兵的值，所以要找到不大于的j。将找到的i和j的数交换，</p>
<p>这样可以减少交换次数。i&gt;&#x3D;j时，数列全部查找了一遍，而不符合条件j必然是在小的那一边，而哨兵</p>
<p>是第一个数，位置本应是小于自己的数。所以将哨兵与j交换，使符合“哨兵”的规则。</p>
<p>这个版本的缺点在于如果是有序数列排序的话，递归次数会很可怕的。</p>
<h4 id="另一个版本"><a href="#另一个版本" class="headerlink" title="另一个版本"></a>另一个版本</h4><p>这是维基上的一个C#版本，我觉得很有意思。这个版本并没有严格符合“哨兵”的规则。但却将“分而治之”</p>
<p>以及“哨兵”思想融入其中，代码简洁。</p>
<p>实现如下：</p>
<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt; 1&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; QuickSortRelax(IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt; data)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;             QuickSortRelax(data, &lt;span&gt;0&lt;/span&gt;, data.Count - &lt;span&gt;1&lt;/span&gt;&lt;span&gt;);</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;        &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; </span><br><span class="line">&lt;span&gt; 6&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; QuickSortRelax(IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt; data, &lt;span&gt;int&lt;/span&gt; low, &lt;span&gt;int&lt;/span&gt;&lt;span&gt; high)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (low &amp;gt;= high) &lt;span&gt;return&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt; temp = data[(low + high) / &lt;span&gt;2&lt;/span&gt;&lt;span&gt;];</span><br><span class="line">&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt; i = low - &lt;span&gt;1&lt;/span&gt;, j = high + &lt;span&gt;1&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;             &lt;span&gt;while&lt;/span&gt; (&lt;span&gt;true&lt;/span&gt;&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;                 &lt;span&gt;while&lt;/span&gt; (data[++i] &amp;lt;&lt;span&gt; temp) ;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;                 &lt;span&gt;while&lt;/span&gt; (data[--j] &amp;gt;&lt;span&gt; temp) ;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;15&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (i &amp;gt;= j) &lt;span&gt;break&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; &lt;span&gt;                Swap(data, i, j);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;17&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;             QuickSortRelax(data, j + &lt;span&gt;1&lt;/span&gt;&lt;span&gt;, high);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;             QuickSortRelax(data, low, i - &lt;span&gt;1&lt;/span&gt;&lt;span&gt;);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;20&lt;/span&gt;         &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<p>过程解析：取的哨兵是数列中间的数。将数列分成两波，左侧小于等于哨兵，右侧大于等于哨兵。</p>
<p>也就是说，哨兵不一定处于两波数的中间。虽然哨兵不在中间，但不妨碍“哨兵”的思想的实现。所以</p>
<p>这个实现也可以达到快速排序的效果。但却造成了每次递归完成，要排序的数列数总和没有减少（除非i&#x3D;&#x3D;j）。</p>
<h4 id="针对这个版本的缺点，我进行了优化"><a href="#针对这个版本的缺点，我进行了优化" class="headerlink" title="针对这个版本的缺点，我进行了优化"></a>针对这个版本的缺点，我进行了优化</h4><p>实现如下：</p>
<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt; 1&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; QuickSortRelaxImproved(IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt; data)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;             QuickSortRelaxImproved(data, &lt;span&gt;0&lt;/span&gt;, data.Count - &lt;span&gt;1&lt;/span&gt;&lt;span&gt;);</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt; &lt;span&gt;        &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; </span><br><span class="line">&lt;span&gt; 6&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; QuickSortRelaxImproved(IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt; data, &lt;span&gt;int&lt;/span&gt; low, &lt;span&gt;int&lt;/span&gt;&lt;span&gt; high)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (low &amp;gt;= high) &lt;span&gt;return&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt; temp = data[(low + high) / &lt;span&gt;2&lt;/span&gt;&lt;span&gt;];</span><br><span class="line">&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt; i = low - &lt;span&gt;1&lt;/span&gt;, j = high + &lt;span&gt;1&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt; index = (low + high) / &lt;span&gt;2&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;             &lt;span&gt;while&lt;/span&gt; (&lt;span&gt;true&lt;/span&gt;&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;                 &lt;span&gt;while&lt;/span&gt; (data[++i] &amp;lt;&lt;span&gt; temp) ;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;15&lt;/span&gt;                 &lt;span&gt;while&lt;/span&gt; (data[--j] &amp;gt;&lt;span&gt; temp) ;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;16&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (i &amp;gt;= j) &lt;span&gt;break&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;17&lt;/span&gt; &lt;span&gt;                Swap(data, i, j);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (i == index) index =&lt;span&gt; j;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;                 &lt;span&gt;else&lt;/span&gt; &lt;span&gt;if&lt;/span&gt; (j == index) index =&lt;span&gt; i;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;21&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (j ==&lt;span&gt; i)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;22&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;23&lt;/span&gt;                 QuickSortRelaxImproved(data, j + &lt;span&gt;1&lt;/span&gt;&lt;span&gt;, high);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;24&lt;/span&gt;                 QuickSortRelaxImproved(data, low, i - &lt;span&gt;1&lt;/span&gt;&lt;span&gt;);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;25&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;26&lt;/span&gt;             &lt;span&gt;else&lt;/span&gt; &lt;span&gt;//&lt;/span&gt;&lt;span&gt;i-j==1&lt;/span&gt;</span><br><span class="line">&lt;span&gt;27&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;28&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (index &amp;gt;=&lt;span&gt; i)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;29&lt;/span&gt; &lt;span&gt;                &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;30&lt;/span&gt;                     &lt;span&gt;if&lt;/span&gt; (index !=&lt;span&gt; i)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;31&lt;/span&gt; &lt;span&gt;                        Swap(data, index, i);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;32&lt;/span&gt;                     QuickSortRelaxImproved(data, i + &lt;span&gt;1&lt;/span&gt;&lt;span&gt;, high);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;33&lt;/span&gt;                     QuickSortRelaxImproved(data, low, i - &lt;span&gt;1&lt;/span&gt;&lt;span&gt;);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;34&lt;/span&gt; &lt;span&gt;                &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;35&lt;/span&gt;                 &lt;span&gt;else &lt;span&gt;//&lt;/span&gt;&lt;span&gt;index &amp;lt; i&lt;/span&gt;&lt;/span&gt;</span><br><span class="line">&lt;span&gt;36&lt;/span&gt; &lt;span&gt;                &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;37&lt;/span&gt;                     &lt;span&gt;if&lt;/span&gt; (index !=&lt;span&gt; j)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;38&lt;/span&gt; &lt;span&gt;                        Swap(data, index, j);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;39&lt;/span&gt;                     QuickSortRelaxImproved(data, j + &lt;span&gt;1&lt;/span&gt;&lt;span&gt;, high);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;40&lt;/span&gt;                     QuickSortRelaxImproved(data, low, j - &lt;span&gt;1&lt;/span&gt;&lt;span&gt;);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;41&lt;/span&gt; &lt;span&gt;                &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;42&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;43&lt;/span&gt;         &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<p>过程解析：定义了一个变量Index，来跟踪哨兵的位置。发现哨兵最后在小于自己的那堆，</p>
<p>那就与j交换，否则与i交换。达到每次递归都能减少要排序的数列数总和的目的。</p>
<h2 id="归并排序"><a href="#归并排序" class="headerlink" title="归并排序"></a>归并排序</h2><p>归并排序也是采用“分而治之”的方式。刚发现<a target="_blank" rel="noopener" href="http://zh.wikipedia.org/wiki/%E5%88%86%E6%B2%BB%E6%B3%95">分治法</a>是一种算法范式，我还一直以为是一种需要意会的思想呢。</p>
<p>不好意思了，孤陋寡闻了，哈哈！</p>
<p>原理：将两个有序的数列，通过比较，合并为一个有序数列。 <a target="_blank" rel="noopener" href="http://zh.wikipedia.org/wiki/%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F">维基入口</a></p>
<p>为方便理解，此处实现用了List<int>的一些方法，随后有IList<int>版本。</p>
<p>实现如下：</p>
<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt; 1&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; List&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt; MergeSortOnlyList(List&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt; data, &lt;span&gt;int&lt;/span&gt; low, &lt;span&gt;int&lt;/span&gt;&lt;span&gt; high)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (low ==&lt;span&gt; high)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;                 &lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; List&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt; &#123; data[low] &#125;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;             List&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt; mergeData = &lt;span&gt;new&lt;/span&gt; List&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt;();</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt; mid = (low + high) / &lt;span&gt;2&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;             List&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt; leftData =&lt;span&gt; MergeSortOnlyList(data, low, mid);</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;             List&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt; rightData = MergeSortOnlyList(data, mid + &lt;span&gt;1&lt;/span&gt;&lt;span&gt;, high);</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt; i = &lt;span&gt;0&lt;/span&gt;, j = &lt;span&gt;0&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;             &lt;span&gt;while&lt;/span&gt; (&lt;span&gt;true&lt;/span&gt;&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (leftData[i] &amp;lt;&lt;span&gt; rightData[j])</span><br><span class="line">&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;                &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;14&lt;/span&gt; &lt;span&gt;                    mergeData.Add(leftData[i]);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;15&lt;/span&gt;                     &lt;span&gt;if&lt;/span&gt; (++i ==&lt;span&gt; leftData.Count)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; &lt;span&gt;                    &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;                         mergeData.AddRange(rightData.GetRange(j, rightData.Count -&lt;span&gt; j));</span><br><span class="line">&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;                         &lt;span&gt;break&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;19&lt;/span&gt; &lt;span&gt;                    &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; &lt;span&gt;                &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;21&lt;/span&gt;                 &lt;span&gt;else&lt;/span&gt;</span><br><span class="line">&lt;span&gt;22&lt;/span&gt; &lt;span&gt;                &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;23&lt;/span&gt; &lt;span&gt;                    mergeData.Add(rightData[j]);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;24&lt;/span&gt;                     &lt;span&gt;if&lt;/span&gt; (++j ==&lt;span&gt; rightData.Count)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;25&lt;/span&gt; &lt;span&gt;                    &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;26&lt;/span&gt;                         mergeData.AddRange(leftData.GetRange(i, leftData.Count -&lt;span&gt; i));</span><br><span class="line">&lt;/span&gt;&lt;span&gt;27&lt;/span&gt;                         &lt;span&gt;break&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;28&lt;/span&gt; &lt;span&gt;                    &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;29&lt;/span&gt; &lt;span&gt;                &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;30&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;31&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt;&lt;span&gt; mergeData;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;32&lt;/span&gt; &lt;span&gt;        &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;33&lt;/span&gt; </span><br><span class="line">&lt;span&gt;34&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; List&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt; MergeSortOnlyList(List&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt; data)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;35&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;36&lt;/span&gt;             data = MergeSortOnlyList(data, &lt;span&gt;0&lt;/span&gt;, data.Count - &lt;span&gt;1&lt;/span&gt;&lt;span&gt;);  &lt;span&gt;//不会改变外部引用 参照&lt;a href=&quot;http://www.cnblogs.com/fatbird/p/parametersInCsharp.html&quot; target=&quot;_blank&quot;&gt;C#参数传递</span><br><span class="line">&lt;/a&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;37&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt;&lt;span&gt; data;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;38&lt;/span&gt;         &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<p>过程解析：将数列分为两部分，分别得到两部分数列的有序版本，然后逐个比较，将比较出的小数逐个放进</p>
<p>新的空数列中。当一个数列放完后，将另一个数列剩余数全部放进去。</p>
<h4 id="IList版本"><a href="#IList版本" class="headerlink" title="IList版本"></a>IList<int>版本</h4><p>实现如下：</p>
<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt; 1&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt; MergeSort(IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt; data)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;             data = MergeSort(data, &lt;span&gt;0&lt;/span&gt;, data.Count - &lt;span&gt;1&lt;/span&gt;&lt;span&gt;);</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt;&lt;span&gt; data;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;        &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; </span><br><span class="line">&lt;span&gt; 7&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt; MergeSort(IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt; data, &lt;span&gt;int&lt;/span&gt; low, &lt;span&gt;int&lt;/span&gt;&lt;span&gt; high)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt; length = high - low + &lt;span&gt;1&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;             IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt; mergeData =&lt;span&gt; NewInstance(data, length);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (low ==&lt;span&gt; high)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;                 mergeData[&lt;span&gt;0&lt;/span&gt;] =&lt;span&gt; data[low];</span><br><span class="line">&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;                 &lt;span&gt;return&lt;/span&gt;&lt;span&gt; mergeData;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;16&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt; mid = (low + high) / &lt;span&gt;2&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;             IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt; leftData =&lt;span&gt; MergeSort(data, low, mid);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;             IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt; rightData = MergeSort(data, mid + &lt;span&gt;1&lt;/span&gt;&lt;span&gt;, high);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt; i = &lt;span&gt;0&lt;/span&gt;, j = &lt;span&gt;0&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;20&lt;/span&gt;             &lt;span&gt;while&lt;/span&gt; (&lt;span&gt;true&lt;/span&gt;&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;22&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (leftData[i] &amp;lt;&lt;span&gt; rightData[j])</span><br><span class="line">&lt;/span&gt;&lt;span&gt;23&lt;/span&gt; &lt;span&gt;                &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;24&lt;/span&gt;                     mergeData[i + j] = leftData[i++]; &lt;span&gt;//&lt;/span&gt;&lt;span&gt;不能使用Add,Array Length不可变&lt;/span&gt;</span><br><span class="line">&lt;span&gt;25&lt;/span&gt;                     &lt;span&gt;if&lt;/span&gt; (i ==&lt;span&gt; leftData.Count)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;26&lt;/span&gt; &lt;span&gt;                    &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;27&lt;/span&gt;                         &lt;span&gt;int&lt;/span&gt; rightLeft = rightData.Count -&lt;span&gt; j;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;28&lt;/span&gt;                         &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; m = &lt;span&gt;0&lt;/span&gt;; m &amp;lt; rightLeft; m++&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;29&lt;/span&gt; &lt;span&gt;                        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;30&lt;/span&gt;                             mergeData[i + j] = rightData[j++&lt;span&gt;];</span><br><span class="line">&lt;/span&gt;&lt;span&gt;31&lt;/span&gt; &lt;span&gt;                        &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;32&lt;/span&gt;                         &lt;span&gt;break&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;33&lt;/span&gt; &lt;span&gt;                    &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;34&lt;/span&gt; &lt;span&gt;                &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;35&lt;/span&gt;                 &lt;span&gt;else&lt;/span&gt;</span><br><span class="line">&lt;span&gt;36&lt;/span&gt; &lt;span&gt;                &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;37&lt;/span&gt;                     mergeData[i + j] = rightData[j++&lt;span&gt;];</span><br><span class="line">&lt;/span&gt;&lt;span&gt;38&lt;/span&gt;                     &lt;span&gt;if&lt;/span&gt; (j ==&lt;span&gt; rightData.Count)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;39&lt;/span&gt; &lt;span&gt;                    &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;40&lt;/span&gt;                         &lt;span&gt;int&lt;/span&gt; leftleft = leftData.Count -&lt;span&gt; i;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;41&lt;/span&gt;                         &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; n = &lt;span&gt;0&lt;/span&gt;; n &amp;lt; leftleft; n++&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;42&lt;/span&gt; &lt;span&gt;                        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;43&lt;/span&gt;                             mergeData[i + j] = leftData[i++&lt;span&gt;];</span><br><span class="line">&lt;/span&gt;&lt;span&gt;44&lt;/span&gt; &lt;span&gt;                        &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;45&lt;/span&gt;                         &lt;span&gt;break&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;46&lt;/span&gt; &lt;span&gt;                    &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;47&lt;/span&gt; &lt;span&gt;                &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;48&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;49&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt;&lt;span&gt; mergeData;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;50&lt;/span&gt; </span><br><span class="line">&lt;span&gt;51&lt;/span&gt;         &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<p>过程原理与上个一样，此处就不赘述了。</p>
<h2 id="堆排序"><a href="#堆排序" class="headerlink" title="堆排序"></a>堆排序</h2><p>堆排序是根据堆这种数据结构设计的一种算法。堆的特性：父节点的值总是小于（或大于）它的子节点。近似二叉树。</p>
<p>原理：将数列构建为最大堆数列（即父节点总是最大值），将最大值（即根节点）交换到数列末尾。这样要排序的数列数总和减少，</p>
<p>同时根节点不再是最大值，调整最大堆数列。如此重复，最后得到有序数列。 <a target="_blank" rel="noopener" href="http://zh.wikipedia.org/wiki/%E5%A0%86%E6%8E%92%E5%BA%8F">维基入口</a>   <a target="_blank" rel="noopener" href="http://www.cs.usfca.edu/~galles/visualization/HeapSort.html">有趣的演示</a></p>
<p>实现准备：如何将数列构造为堆——父节点i的左子节点为2i+1，右子节点为2i+2。节点i的父节点为floor((i-1)&#x2F;2)。</p>
<p>实现如下（这个实现判断和临时变量使用太多，导致效率低，评论中@小城故事提出了更好的实现）：</p>
<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt; 1&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; HeapSort(IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt; data)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt; &lt;span&gt;            BuildMaxHeapify(data);</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt; j =&lt;span&gt; data.Count;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = &lt;span&gt;0&lt;/span&gt;; i &amp;lt;&lt;span&gt; j; )</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;                 Swap(data, i, --&lt;span&gt;j);</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (j - &lt;span&gt;2&lt;/span&gt; &amp;lt; &lt;span&gt;0&lt;/span&gt;&lt;span&gt;)  &lt;span&gt;//只剩下1个数 j代表余下要排列的数的个数</span><br><span class="line">&lt;/span&gt;&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;                     &lt;span&gt;break&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;                 &lt;span&gt;int&lt;/span&gt; k = &lt;span&gt;0&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;                 &lt;span&gt;while&lt;/span&gt; (&lt;span&gt;true&lt;/span&gt;&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; &lt;span&gt;                &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;                     &lt;span&gt;if&lt;/span&gt; (k &amp;gt; (j - &lt;span&gt;2&lt;/span&gt;) / &lt;span&gt;2&lt;/span&gt;) &lt;span&gt;break&lt;/span&gt;&lt;span&gt;;  &lt;span&gt;//即：k &amp;gt; ((j-1)-1)/2&lt;/span&gt; &lt;span&gt;超出最后一个父节点的位置  </span><br><span class="line">&lt;/span&gt;&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;                     &lt;span&gt;else&lt;/span&gt;</span><br><span class="line">&lt;span&gt;15&lt;/span&gt; &lt;span&gt;                    &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;16&lt;/span&gt;                         &lt;span&gt;int&lt;/span&gt; temp =&lt;span&gt; k;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;                         k = ReSortMaxBranch(data, k, &lt;span&gt;2&lt;/span&gt; * k + &lt;span&gt;1&lt;/span&gt;, &lt;span&gt;2&lt;/span&gt; * k + &lt;span&gt;2&lt;/span&gt;, j - &lt;span&gt;1&lt;/span&gt;&lt;span&gt;);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;                         &lt;span&gt;if&lt;/span&gt; (temp == k) &lt;span&gt;break&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;19&lt;/span&gt; &lt;span&gt;                    &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; &lt;span&gt;                &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;22&lt;/span&gt; &lt;span&gt;        &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;23&lt;/span&gt; </span><br><span class="line">&lt;span&gt;24&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; BuildMaxHeapify(IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt; data)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;25&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;26&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = data.Count / &lt;span&gt;2&lt;/span&gt; - &lt;span&gt;1&lt;/span&gt;; i &amp;gt;= &lt;span&gt;0&lt;/span&gt;; i--&lt;span&gt;)  &lt;span&gt;//(data.Count-1)-1)/2为数列最大父节点索引</span><br><span class="line">&lt;/span&gt;&lt;/span&gt;&lt;span&gt;27&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;28&lt;/span&gt;                 &lt;span&gt;int&lt;/span&gt; temp =&lt;span&gt; i;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;29&lt;/span&gt;                 temp = ReSortMaxBranch(data, i, &lt;span&gt;2&lt;/span&gt; * i + &lt;span&gt;1&lt;/span&gt;, &lt;span&gt;2&lt;/span&gt; * i + &lt;span&gt;2&lt;/span&gt;, data.Count - &lt;span&gt;1&lt;/span&gt;&lt;span&gt;);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;30&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (temp !=&lt;span&gt; i)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;31&lt;/span&gt; &lt;span&gt;                &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;32&lt;/span&gt;                     &lt;span&gt;int&lt;/span&gt; k =&lt;span&gt; i;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;33&lt;/span&gt;                     &lt;span&gt;while&lt;/span&gt; (k != temp &amp;amp;&amp;amp; temp &amp;lt;= data.Count / &lt;span&gt;2&lt;/span&gt; - &lt;span&gt;1&lt;/span&gt;&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;34&lt;/span&gt; &lt;span&gt;                    &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;35&lt;/span&gt;                         k =&lt;span&gt; temp;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;36&lt;/span&gt;                         temp = ReSortMaxBranch(data, temp, &lt;span&gt;2&lt;/span&gt; * temp + &lt;span&gt;1&lt;/span&gt;, &lt;span&gt;2&lt;/span&gt; * temp + &lt;span&gt;2&lt;/span&gt;, data.Count - &lt;span&gt;1&lt;/span&gt;&lt;span&gt;);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;37&lt;/span&gt; &lt;span&gt;                    &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;38&lt;/span&gt; &lt;span&gt;                &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;39&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;40&lt;/span&gt; &lt;span&gt;        &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;41&lt;/span&gt; </span><br><span class="line">&lt;span&gt;42&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; ReSortMaxBranch(IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt; data, &lt;span&gt;int&lt;/span&gt; maxIndex, &lt;span&gt;int&lt;/span&gt; left, &lt;span&gt;int&lt;/span&gt; right, &lt;span&gt;int&lt;/span&gt;&lt;span&gt; lastIndex)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;43&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;44&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt;&lt;span&gt; temp;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;45&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (right &amp;gt;&lt;span&gt; lastIndex)  &lt;span&gt;//父节点只有一个子节点</span><br><span class="line">&lt;/span&gt;&lt;/span&gt;&lt;span&gt;46&lt;/span&gt;                 temp =&lt;span&gt; left;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;47&lt;/span&gt;             &lt;span&gt;else&lt;/span&gt;</span><br><span class="line">&lt;span&gt;48&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;49&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (data[left] &amp;gt;&lt;span&gt; data[right])</span><br><span class="line">&lt;/span&gt;&lt;span&gt;50&lt;/span&gt;                     temp =&lt;span&gt; left;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;51&lt;/span&gt;                 &lt;span&gt;else&lt;/span&gt; temp =&lt;span&gt; right;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;52&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;53&lt;/span&gt; </span><br><span class="line">&lt;span&gt;54&lt;/span&gt;             &lt;span&gt;if&lt;/span&gt; (data[maxIndex] &amp;lt;&lt;span&gt; data[temp])</span><br><span class="line">&lt;/span&gt;&lt;span&gt;55&lt;/span&gt; &lt;span&gt;                Swap(data, maxIndex, temp);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;56&lt;/span&gt;             &lt;span&gt;else&lt;/span&gt; temp =&lt;span&gt; maxIndex;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;57&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt;&lt;span&gt; temp;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;58&lt;/span&gt;         &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<p>过程解析：BuildMaxHeapify为排序前构建的最大堆数列方法，主要内容为从最后一个父节点开始往前将每个三角组合</p>
<p>（即父节点与它的两个子节点）符合父节点值最大的规则。ReSortMaxBranch为将三角调整为父节点值最大，</p>
<p>并返回该值之前的索引，用来判断是否进行了交换，以及原来的父节点值交换到了什么位置。在HeapSort里首先</p>
<p>构建了最大堆数列，然后将根节点交换到末尾，根节点不是最大值了，在while语句中对最大堆数列进行调整。</p>
<p>插曲：自从看了Martin Fowler大师《重构》第三版，我发现我更不喜欢写注释了。每次都想着尽量让方法的名字更贴切，</p>
<p>即使会造成方法的名字很长很丑。这算不算曲解了大师的意思啊！？上面的代码注释都是写博客的时候现加的（源代码很干净的。汗!）。</p>
<h2 id="希尔排序"><a href="#希尔排序" class="headerlink" title="希尔排序"></a>希尔排序</h2><p>希尔排序是插入排序的一种更高效的改进版本。</p>
<p>在前面介绍的插入排序，我们知道1.它对有序数列排序的效率是非常高的 2.要排序的数向前移动是一步步进行的导致插入排序效率低。</p>
<p>希尔排序正是利用第一点，改善第二点，达到更理想的效果。</p>
<p>原理：通过奇妙的步长，插入排序间隔步长的元素，随后逐渐缩短步长至1，实现数列的插入排序。 <a target="_blank" rel="noopener" href="http://zh.wikipedia.org/wiki/%E5%B8%8C%E5%B0%94%E6%8E%92%E5%BA%8F">维基入口</a></p>
<p>疑问：可以想象到排序间隔步长的数，会逐渐让数列变得有序，提升最后步长为1时标准插入排序的效率。在维基上看到这么</p>
<p>一句话“可能<strong>希尔排序</strong>最重要的地方在于当用较小步长排序后，以前用的较大步长仍然是有序的”注意用词是‘可能’。我的疑问是</p>
<p>这是个正确的命题吗？如何证明呢？看维基上也是由果推因，说是如果不是这样，就不会排序那么快了。可这我感觉还是太牵强了，</p>
<p>哪位大哥发现相关资料，希望能分享出来，不胜感激。</p>
<p>实现如下：</p>
<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt; 1&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; ShellSort(IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt; data)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt;&lt;span&gt; temp;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; gap = data.Count / &lt;span&gt;2&lt;/span&gt;; gap &amp;gt; &lt;span&gt;0&lt;/span&gt;; gap /= &lt;span&gt;2&lt;/span&gt;&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;                 &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = gap; i &amp;lt; data.Count; i +=&lt;span&gt; gap)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;                &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;                     temp =&lt;span&gt; data[i];</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;                     &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; j = i - gap; j &amp;gt;= &lt;span&gt;0&lt;/span&gt;; j -=&lt;span&gt; gap)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; &lt;span&gt;                    &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;                         &lt;span&gt;if&lt;/span&gt; (data[j] &amp;gt;&lt;span&gt; temp)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; &lt;span&gt;                        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;                             data[j + gap] =&lt;span&gt; data[j];</span><br><span class="line">&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;                             &lt;span&gt;if&lt;/span&gt; (j == &lt;span&gt;0&lt;/span&gt;&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; &lt;span&gt;                            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;16&lt;/span&gt;                                 data[j] =&lt;span&gt; temp;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;                                 &lt;span&gt;break&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;18&lt;/span&gt; &lt;span&gt;                            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;19&lt;/span&gt; &lt;span&gt;                        &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;20&lt;/span&gt;                         &lt;span&gt;else&lt;/span&gt;</span><br><span class="line">&lt;span&gt;21&lt;/span&gt; &lt;span&gt;                        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;22&lt;/span&gt;                             data[j + gap] =&lt;span&gt; temp;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;23&lt;/span&gt;                             &lt;span&gt;break&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;24&lt;/span&gt; &lt;span&gt;                        &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;25&lt;/span&gt; &lt;span&gt;                    &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;26&lt;/span&gt; &lt;span&gt;                &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;27&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;28&lt;/span&gt;         &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<p>过程解析：采用的步长是N&#x2F;2，每次取半，直至1。循环内部就是标准的插入排序。</p>
<p>——————</p>
<p>修正：修正后希尔排序才是真正牛叉的希尔啊！感谢@390218462的提出  </p>
<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt; 1&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; ShellSortCorrect(IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt; data)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt;&lt;span&gt; temp;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; gap = data.Count / &lt;span&gt;2&lt;/span&gt;; gap &amp;gt; &lt;span&gt;0&lt;/span&gt;; gap /= &lt;span&gt;2&lt;/span&gt;&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;                 &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = gap; i &amp;lt; data.Count; &lt;span&gt;i++&lt;/span&gt;&lt;span&gt;)      // &lt;span&gt;i+ = gap 改为了 i++</span><br><span class="line">&lt;/span&gt;&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;                &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;                     temp =&lt;span&gt; data[i];</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;                     &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; j = i - gap; j &amp;gt;= &lt;span&gt;0&lt;/span&gt;; j -=&lt;span&gt; gap)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; &lt;span&gt;                    &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;                         &lt;span&gt;if&lt;/span&gt; (data[j] &amp;gt;&lt;span&gt; temp)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;12&lt;/span&gt; &lt;span&gt;                        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;                             data[j + gap] =&lt;span&gt; data[j];</span><br><span class="line">&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;                             &lt;span&gt;if&lt;/span&gt; (j == &lt;span&gt;0&lt;/span&gt;&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; &lt;span&gt;                            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;16&lt;/span&gt;                                 data[j] =&lt;span&gt; temp;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;                                 &lt;span&gt;break&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;18&lt;/span&gt; &lt;span&gt;                            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;19&lt;/span&gt; &lt;span&gt;                        &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;20&lt;/span&gt;                         &lt;span&gt;else&lt;/span&gt;</span><br><span class="line">&lt;span&gt;21&lt;/span&gt; &lt;span&gt;                        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;22&lt;/span&gt;                             data[j + gap] =&lt;span&gt; temp;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;23&lt;/span&gt;                             &lt;span&gt;break&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;24&lt;/span&gt; &lt;span&gt;                        &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;25&lt;/span&gt; &lt;span&gt;                    &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;26&lt;/span&gt; &lt;span&gt;                &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;27&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;28&lt;/span&gt;         &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625206.jpg"><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625286.jpg"></p>
<p>——————</p>
<p>这里实现的貌似是最差的希尔排序。主要源于步长的选择。维基上有各种牛叉的“凌波微步”，极限在哪里，</p>
<p>喜欢挑战的同学可以去学习学习。看维基<a target="_blank" rel="noopener" href="http://zh.wikipedia.org/wiki/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95">排序算法</a>里六种排序的测试，希尔最快，比快速排序还快！！我没实现啊！</p>
<p>只是对于神奇的步长更充满了敬畏。</p>
<h2 id="基数排序"><a href="#基数排序" class="headerlink" title="基数排序"></a>基数排序</h2><p>基数排序是一种非比较型整数排序。</p>
<p>“非比较型”是什么意思呢？因为它内部使用的是桶排序，而桶排序是非比较型排序。</p>
<p>这里就要说说桶排序了。一个非常有意思的排序。</p>
<h4 id="桶排序"><a href="#桶排序" class="headerlink" title="桶排序"></a>桶排序</h4><p>原理：取一定数量（数列中的最大值）的编好序号的桶，将数列每个数放进编号为它的桶里，然后将不是空的桶依次倒出来，</p>
<p>就组成有序数列了。  <a target="_blank" rel="noopener" href="http://zh.wikipedia.org/wiki/%E6%A1%B6%E6%8E%92%E5%BA%8F">维基入口</a></p>
<p>好吧！聪明的人一眼就看出桶排序的破绽了。假设只有两个数1,10000，岂不是要一万个桶！？这确实是个问题啊！我也</p>
<p>没想出解决办法。我起初也以为桶排序就是一个通过牺牲空间来换取时间的排序算法，它不需要比较，所以是非比较型算法。</p>
<p>但看了<a target="_blank" rel="noopener" href="http://www.cs.usfca.edu/~galles/visualization/Algorithms.html">有趣的演示</a>的<a target="_blank" rel="noopener" href="http://www.cs.usfca.edu/~galles/visualization/BucketSort.html">桶排序</a>后，发现世界之大，你没有解决，不代表别人没解决，睿智的人总是很多。</p>
<p>1，9999的桶排序实现：new Int[2];总共有两个数，得出最大数9999的位数4，取10的4次幂即10000作为分母，</p>
<p>要排序的数（1或9999）作为分子，并乘以数列总数2，即1*2&#x2F;10000,9999*2&#x2F;10000得到各自的位置0,1，完成排序。</p>
<p>如果是1,10000进行排序的话，上面的做法就需要稍微加一些处理——发现最大数是10的n次幂，就将它作为分母，并</p>
<p>放在数列末尾就好了。</p>
<p>如果是9999,10000进行排序的话，那就需要二维数组了，两个都在位置1，位置0没数。这个时候就需要在放</p>
<p>入每个位置时采用其它排序（比如插入排序）办法对这个位置的多个数排序了。</p>
<h4 id="为基数排序做个过渡，我这里实现了一个个位数桶排序"><a href="#为基数排序做个过渡，我这里实现了一个个位数桶排序" class="headerlink" title="为基数排序做个过渡，我这里实现了一个个位数桶排序"></a>为基数排序做个过渡，我这里实现了一个个位数桶排序</h4><p>涉及到了当重复的数出现的处理。</p>
<p>实现如下：</p>
<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt; 1&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; BucketSortOnlyUnitDigit(IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt; data)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt;[] indexCounter = &lt;span&gt;new&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;[&lt;span&gt;10&lt;/span&gt;&lt;span&gt;];</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = &lt;span&gt;0&lt;/span&gt;; i &amp;lt; data.Count; i++&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;                 indexCounter[data[i]]++&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt;[] indexBegin = &lt;span&gt;new&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;[&lt;span&gt;10&lt;/span&gt;&lt;span&gt;];</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = &lt;span&gt;1&lt;/span&gt;; i &amp;lt; &lt;span&gt;10&lt;/span&gt;; i++&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;                 indexBegin[i] = indexBegin[i-1]+&lt;span&gt; indexCounter[i-1];</span><br><span class="line">&lt;/span&gt;&lt;span&gt;15&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;16&lt;/span&gt;             IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt; tempList =&lt;span&gt; NewInstance(data, data.Count);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = &lt;span&gt;0&lt;/span&gt;; i &amp;lt; data.Count; i++&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;18&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;                 &lt;span&gt;int&lt;/span&gt; number =&lt;span&gt; data[i];</span><br><span class="line">&lt;/span&gt;&lt;span&gt;20&lt;/span&gt;                 tempList[indexBegin[number]++] =&lt;span&gt; data[i];</span><br><span class="line">&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;22&lt;/span&gt;             data =&lt;span&gt; tempList;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;23&lt;/span&gt;         &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<p>过程解析：indexCounter进行对每个数出现的频率的统计。indexBegin存储每个数的起始索引。</p>
<p>比如 1 1 2，indexCounter统计到0个0,2个1,1个2。indexBegin计算出0,1,2的起始索引分别为</p>
<p>0,0,2。当1个1已取出排序，那索引将+1,变为0,1,2。这样就通过提前给重复的数空出位置，解决了</p>
<p>重复的数出现的问题。当然，你也可以考虑用二维数组来解决重复。</p>
<p>下面继续基数排序。</p>
<p>基数排序原理：将整数按位数切割成不同的数字，然后按每个位数分别比较。</p>
<p>取得最大数的位数，从低位开始，每个位上进行桶排序。</p>
<p>实现如下：</p>
<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt; 1&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt; RadixSort(IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt; data)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt; max = data[&lt;span&gt;0&lt;/span&gt;&lt;span&gt;];</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = &lt;span&gt;1&lt;/span&gt;; i &amp;lt; data.Count; i++&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (data[i] &amp;gt;&lt;span&gt; max)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;                     max =&lt;span&gt; data[i];</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt; digit = &lt;span&gt;1&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;             &lt;span&gt;while&lt;/span&gt; (max / &lt;span&gt;10&lt;/span&gt; != &lt;span&gt;0&lt;/span&gt;&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;                 digit++&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;                 max /= &lt;span&gt;10&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;14&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;15&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = &lt;span&gt;0&lt;/span&gt;; i &amp;lt; digit; i++&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;                 &lt;span&gt;int&lt;/span&gt;[] indexCounter = &lt;span&gt;new&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;[&lt;span&gt;10&lt;/span&gt;&lt;span&gt;];</span><br><span class="line">&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;                 IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt; tempList =&lt;span&gt; NewInstance(data, data.Count);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;                 &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; j = &lt;span&gt;0&lt;/span&gt;; j &amp;lt; data.Count; j++&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; &lt;span&gt;                &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;21&lt;/span&gt;                     &lt;span&gt;int&lt;/span&gt; number = (data[j] % Convert.ToInt32(Math.Pow(&lt;span&gt;10&lt;/span&gt;, i + &lt;span&gt;1&lt;/span&gt;))) / Convert.ToInt32(Math.Pow(&lt;span&gt;10&lt;/span&gt;, i));  &lt;span&gt;//&lt;/span&gt;&lt;span&gt;得出i+1位上的数&lt;/span&gt;</span><br><span class="line">&lt;span&gt;22&lt;/span&gt;                     indexCounter[number]++&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;23&lt;/span&gt; &lt;span&gt;                &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;24&lt;/span&gt;                 &lt;span&gt;int&lt;/span&gt;[] indexBegin = &lt;span&gt;new&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;[&lt;span&gt;10&lt;/span&gt;&lt;span&gt;];</span><br><span class="line">&lt;/span&gt;&lt;span&gt;25&lt;/span&gt;                 &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; k = &lt;span&gt;1&lt;/span&gt;; k &amp;lt; &lt;span&gt;10&lt;/span&gt;; k++&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;26&lt;/span&gt; &lt;span&gt;                &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;27&lt;/span&gt;                     indexBegin[k] = indexBegin[k - &lt;span&gt;1&lt;/span&gt;] + indexCounter[k - &lt;span&gt;1&lt;/span&gt;&lt;span&gt;];</span><br><span class="line">&lt;/span&gt;&lt;span&gt;28&lt;/span&gt; &lt;span&gt;                &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;29&lt;/span&gt;                 &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; k = &lt;span&gt;0&lt;/span&gt;; k &amp;lt; data.Count; k++&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;30&lt;/span&gt; &lt;span&gt;                &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;31&lt;/span&gt;                     &lt;span&gt;int&lt;/span&gt; number = (data[k] % Convert.ToInt32(Math.Pow(&lt;span&gt;10&lt;/span&gt;, i + &lt;span&gt;1&lt;/span&gt;))) / Convert.ToInt32(Math.Pow(&lt;span&gt;10&lt;/span&gt;&lt;span&gt;, i));</span><br><span class="line">&lt;/span&gt;&lt;span&gt;32&lt;/span&gt;                     tempList[indexBegin[number]++] =&lt;span&gt; data[k];</span><br><span class="line">&lt;/span&gt;&lt;span&gt;33&lt;/span&gt; &lt;span&gt;                &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;34&lt;/span&gt;                 data =&lt;span&gt; tempList;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;35&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;36&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt;&lt;span&gt; data;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;37&lt;/span&gt;         &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<p>过程解析：得出最大数的位数，从低位开始桶排序。我写的这个实现代码并不简洁，但逻辑更清晰。</p>
<p>后面测试的时候我们就会发现，按理来说这个实现也还行吧！ 但并不如想象的那么快！</p>
<p>循环的次数太多？（统计频率n次+9次计算+n次放到新的数组）*位数。</p>
<p>创建的新实例太多？(new int[10]两次+NewInstance is反射判断创建实例+new int[n])*位数</p>
<h2 id="测试比较"><a href="#测试比较" class="headerlink" title="测试比较"></a>测试比较</h2><p>添加随机数组，数组有序校验，微软Linq排序</p>
<p>代码如下：</p>
<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt; 1&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;[] RandomSet(&lt;span&gt;int&lt;/span&gt; length, &lt;span&gt;int&lt;/span&gt;&lt;span&gt; max)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt;[] result = &lt;span&gt;new&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt;[length];</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;             Random rand = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; Random();</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = &lt;span&gt;0&lt;/span&gt;; i &amp;lt; result.Length; i++&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;                 result[i] =&lt;span&gt; rand.Next(max);</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt;&lt;span&gt; result;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;10&lt;/span&gt; &lt;span&gt;        &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;11&lt;/span&gt; </span><br><span class="line">&lt;span&gt;12&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;bool&lt;/span&gt; IsAscOrdered(IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt; data)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;13&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;             &lt;span&gt;bool&lt;/span&gt; flag = &lt;span&gt;true&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;15&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = &lt;span&gt;0&lt;/span&gt;; i &amp;lt; data.Count - &lt;span&gt;1&lt;/span&gt;; i++&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;16&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;                 &lt;span&gt;if&lt;/span&gt; (data[i] &amp;gt; data[i + &lt;span&gt;1&lt;/span&gt;&lt;span&gt;])</span><br><span class="line">&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;                     flag = &lt;span&gt;false&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;19&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;20&lt;/span&gt;             &lt;span&gt;return&lt;/span&gt;&lt;span&gt; flag;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; &lt;span&gt;        &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;22&lt;/span&gt; </span><br><span class="line">&lt;span&gt;23&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; TestMicrosoft(IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt; data)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;24&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;25&lt;/span&gt;             Stopwatch stopwatch = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; Stopwatch();</span><br><span class="line">&lt;/span&gt;&lt;span&gt;26&lt;/span&gt; &lt;span&gt;            stopwatch.Start();</span><br><span class="line">&lt;/span&gt;&lt;span&gt;27&lt;/span&gt;             List&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt; result = data.OrderBy(a =&amp;gt;&lt;span&gt; a).ToList();</span><br><span class="line">&lt;/span&gt;&lt;span&gt;28&lt;/span&gt; &lt;span&gt;            stopwatch.Stop();</span><br><span class="line">&lt;/span&gt;&lt;span&gt;29&lt;/span&gt;             &lt;span&gt;string&lt;/span&gt; methodName = &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;TestMicrosoft&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;30&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt; length =&lt;span&gt; methodName.Length;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;31&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = &lt;span&gt;0&lt;/span&gt;; i &amp;lt; &lt;span&gt;40&lt;/span&gt; - length; i++&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;32&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;33&lt;/span&gt;                 methodName += &lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;34&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;35&lt;/span&gt;             Console.WriteLine(methodName +</span><br><span class="line">&lt;span&gt;36&lt;/span&gt;                 &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;  IsAscOrdered:&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; + IsAscOrdered(result) + &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;  Time:&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; +&lt;span&gt; stopwatch.Elapsed.TotalSeconds);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;37&lt;/span&gt; </span><br><span class="line">&lt;span&gt;38&lt;/span&gt;         &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<p>测试主体如下：</p>
<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt; 1&lt;/span&gt;         &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; Main(&lt;span&gt;string&lt;/span&gt;&lt;span&gt;[] args)</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 2&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 3&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt;[] aa = RandomSet(&lt;span&gt;50000&lt;/span&gt;, &lt;span&gt;99999&lt;/span&gt;&lt;span&gt;);</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 4&lt;/span&gt;             &lt;span&gt;//&lt;/span&gt;&lt;span&gt;int[] aa = OrderedSet(5000);&lt;/span&gt;</span><br><span class="line">&lt;span&gt; 5&lt;/span&gt;             Console.WriteLine(&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;Array Length:&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; +&lt;span&gt; aa.Length);</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 6&lt;/span&gt;             RunTheMethod((Action&amp;lt;IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&amp;gt;)SelectSort, aa.Clone() &lt;span&gt;as&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt;[]);</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;             RunTheMethod((Action&amp;lt;IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&amp;gt;)BubbleSort, aa.Clone() &lt;span&gt;as&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt;[]);</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;             RunTheMethod((Action&amp;lt;IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&amp;gt;)BubbleSortImprovedWithFlag, aa.Clone() &lt;span&gt;as&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt;[]);</span><br><span class="line">&lt;/span&gt;&lt;span&gt; 9&lt;/span&gt;             RunTheMethod((Action&amp;lt;IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&amp;gt;)BubbleCocktailSort, aa.Clone() &lt;span&gt;as&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt;[]);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;10&lt;/span&gt;             RunTheMethod((Action&amp;lt;IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&amp;gt;)InsertSort, aa.Clone() &lt;span&gt;as&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt;[]);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;11&lt;/span&gt;             RunTheMethod((Action&amp;lt;IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&amp;gt;)InsertSortImprovedWithBinarySearch, aa.Clone() &lt;span&gt;as&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt;[]);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;12&lt;/span&gt;             RunTheMethod((Action&amp;lt;IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&amp;gt;)QuickSortStrict, aa.Clone() &lt;span&gt;as&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt;[]);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;             RunTheMethod((Action&amp;lt;IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&amp;gt;)QuickSortRelax, aa.Clone() &lt;span&gt;as&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt;[]);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;14&lt;/span&gt;             RunTheMethod((Action&amp;lt;IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&amp;gt;)QuickSortRelaxImproved, aa.Clone() &lt;span&gt;as&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt;[]);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;15&lt;/span&gt;             RunTheMethod((Func&amp;lt;IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;, IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&amp;gt;)MergeSort, aa.Clone() &lt;span&gt;as&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt;[]);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;16&lt;/span&gt;             RunTheMethod((Action&amp;lt;IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&amp;gt;)ShellSort, aa.Clone() &lt;span&gt;as&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt;[]);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;17&lt;/span&gt;             RunTheMethod((Func&amp;lt;IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;, IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&amp;gt;)RadixSort, aa.Clone() &lt;span&gt;as&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt;[]);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;18&lt;/span&gt;             RunTheMethod((Action&amp;lt;IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&amp;gt;)HeapSort, aa.Clone() &lt;span&gt;as&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt;[]);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;19&lt;/span&gt;             TestMicrosoft(aa.Clone() &lt;span&gt;as&lt;/span&gt; &lt;span&gt;int&lt;/span&gt;&lt;span&gt;[]);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;20&lt;/span&gt; &lt;span&gt;            Console.Read();</span><br><span class="line">&lt;/span&gt;&lt;span&gt;21&lt;/span&gt; &lt;span&gt;        &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;22&lt;/span&gt; </span><br><span class="line">&lt;span&gt;23&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; RunTheMethod(Func&amp;lt;IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;, IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&amp;gt; method, IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt; data)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;24&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;25&lt;/span&gt;             Stopwatch stopwatch = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; Stopwatch();</span><br><span class="line">&lt;/span&gt;&lt;span&gt;26&lt;/span&gt; &lt;span&gt;            stopwatch.Start();</span><br><span class="line">&lt;/span&gt;&lt;span&gt;27&lt;/span&gt;             IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt; result =&lt;span&gt; method(data);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;28&lt;/span&gt; &lt;span&gt;            stopwatch.Stop();</span><br><span class="line">&lt;/span&gt;&lt;span&gt;29&lt;/span&gt;             &lt;span&gt;string&lt;/span&gt; methodName =&lt;span&gt; method.Method.Name;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;30&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt; length =&lt;span&gt; methodName.Length;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;31&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = &lt;span&gt;0&lt;/span&gt;; i &amp;lt; &lt;span&gt;40&lt;/span&gt; - length; i++&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;32&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;33&lt;/span&gt;                 methodName += &lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;34&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;35&lt;/span&gt;             Console.WriteLine(methodName +</span><br><span class="line">&lt;span&gt;36&lt;/span&gt;                 &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;  IsAscOrdered:&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; + IsAscOrdered(result) + &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;  Time:&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; +&lt;span&gt; stopwatch.Elapsed.TotalSeconds);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;37&lt;/span&gt; &lt;span&gt;        &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;38&lt;/span&gt; </span><br><span class="line">&lt;span&gt;39&lt;/span&gt;         &lt;span&gt;public&lt;/span&gt; &lt;span&gt;static&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; RunTheMethod(Action&amp;lt;IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&amp;gt; method, IList&amp;lt;&lt;span&gt;int&lt;/span&gt;&amp;gt;&lt;span&gt; data)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;40&lt;/span&gt; &lt;span&gt;        &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;41&lt;/span&gt;             Stopwatch stopwatch = &lt;span&gt;new&lt;/span&gt;&lt;span&gt; Stopwatch();</span><br><span class="line">&lt;/span&gt;&lt;span&gt;42&lt;/span&gt; &lt;span&gt;            stopwatch.Start();</span><br><span class="line">&lt;/span&gt;&lt;span&gt;43&lt;/span&gt; &lt;span&gt;            method(data);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;44&lt;/span&gt; &lt;span&gt;            stopwatch.Stop();</span><br><span class="line">&lt;/span&gt;&lt;span&gt;45&lt;/span&gt;             &lt;span&gt;string&lt;/span&gt; methodName =&lt;span&gt; method.Method.Name;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;46&lt;/span&gt;             &lt;span&gt;int&lt;/span&gt; length =&lt;span&gt; methodName.Length;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;47&lt;/span&gt;             &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; i = &lt;span&gt;0&lt;/span&gt;; i &amp;lt; &lt;span&gt;40&lt;/span&gt; - length; i++&lt;span&gt;)</span><br><span class="line">&lt;/span&gt;&lt;span&gt;48&lt;/span&gt; &lt;span&gt;            &#123;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;49&lt;/span&gt;                 methodName += &lt;span&gt;&quot;&lt;/span&gt; &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;50&lt;/span&gt; &lt;span&gt;            &#125;</span><br><span class="line">&lt;/span&gt;&lt;span&gt;51&lt;/span&gt;             Console.WriteLine(methodName +</span><br><span class="line">&lt;span&gt;52&lt;/span&gt;                 &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;  IsAscOrdered:&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; + IsAscOrdered(data) + &lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;  Time:&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt; +&lt;span&gt; stopwatch.Elapsed.TotalSeconds);</span><br><span class="line">&lt;/span&gt;&lt;span&gt;53&lt;/span&gt;         &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625066.gif" alt="复制代码"></p>
<p>剩余代码折叠在此处</p>
<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625323.gif"> View Code</p>
<p>测试设备：win8(64位)，i7-3630QM,8G内存，vs2012</p>
<p>测试结果：</p>
<p>100000,50000,10000,5000,1000,100依次是：</p>
<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625384.jpg"></p>
<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625426.jpg"><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625487.jpg"><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625541.jpg"><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625607.jpg"><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625659.jpg"></p>
<p>结果分析：可以看出在大数组的时候，微软自带排序更接近快速排序。而当数组变小时，速度却没有明显提升，甚至变得更慢，</p>
<p>比如1000和100。可以推断出在数组足够小的时候，比较已经不是影响这个方法主要因素。而根据它对大数组的表现。我们可以</p>
<p>推断出它应该用的是快速排序。反编译验证下：</p>
<p><img src="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/8%E7%A7%8D%E4%B8%BB%E8%A6%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84C%E5%AE%9E%E7%8E%B0/IMG-20250704185625705.jpg"></p>
<p>在System.Linq.EnumerableSorter下。有兴趣的同学可以去看下详细实现。</p>
<p>维基上也有个测试。硬件没我的好。时间是我测试结果时间的几百倍。有兴趣的同学可以比较下。</p>
<p>在上面的测试中，我们可以看到快速最快，归并其次，冒泡最慢（维基上是希尔最快，估计使用的是某种神奇的步长）。</p>
<p>在我这里，以前实现的希尔还不如二分查找优化版的快，修正后希尔快了相当多，上面测试的希尔排序是以前错误的实现。</p>
<p>修正后的实现测试效果请点击右侧导航到希尔排序查看。希尔排序是一种神奇又有潜力的算法。步长不好会很挫！</p>
<p>而基数排序却是比平均时间复杂度为o(nlogn)的堆排序，归并排序，快速排序还要慢的，虽然它的平均时间复杂度为o(n)。</p>
<p>冒泡标识优化版对随机数列结果优化不明显，鸡尾酒版优化可以看到，但也不是很厉害。</p>
<p>插入排序二分查找优化版优化比较明显。我优化的快速排序QuickSortRelaxImproved优化也不明显。</p>
<p>以上是随机数列的测试结果，最大值为99999。</p>
<p>而对于有序数列，这些方法表现又会如何呢？</p>
<p>我这里就不演示了。<a target="_blank" rel="noopener" href="http://www.cnblogs.com/fatbird/p/SortAlgorithm.html">本文</a>末尾会附上demo，大家可以自行测试。</p>
<p>有意思的是:</p>
<p>我在测试有序数列的时候，QuickSortStrict方法栈溢出了（stack overflow exception）。这个异常</p>
<p>是让我去stackoverflow搜寻答案吗？哈哈！我确信我的方法不是无限循环。跳过一堆链接。。。我是</p>
<p>在测试10000个数排序的时候发生的错误。我跟踪后发现大约在9400多次递归的时候，栈溢出。找啊找</p>
<p>终于找见了一个类似的<a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/4106708/runtime-exception-recursion-too-deep">问题</a>。上面说如果一个递归9000多次而没有返回值，也会报栈溢出的。而这个方法</p>
<p>对于10000个有序数列，确实每次减少一个数地递归，次数会超过限制。</p>
<p>我的算法理论不怎么好，对于时间复杂度和空间复杂度，还有稳定度，搞得也不怎么清楚，只知道个大致的  </p>
<p>意思。各位要笔试面试的朋友可以去<a target="_blank" rel="noopener" href="http://zh.wikipedia.org/wiki/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95#.E7.AE.80.E8.A6.81.E6.AF.94.E8.BE.83">维基百科这个表</a>来了解学习。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>我觉得使用IList<int>更贴近数列，更能展现基本的操作。所以我的实现中都没有将它强制转化为List<int></p>
<p>或者int[]来调用微软封装的方法。这样说来，题目说C#实现倒快有点名不副实了。不过这样却也方便了其它语言</p>
<p>朋友。比如将我这篇博文里的实现随便改改，就可以说是另一个语言版本的8种排序算法了。哈哈！在这里，</p>
<p>我想说下这次学习排序对我的意义：老久不怎么动脑了，突然动起来，磨磨唧唧地得出结果，最后倒也有点成就感！</p>
<p>在学习过程中，经常会脑子转不过弯，想不通的，只是走在路上或者睡觉前突然灵感一现，有点小惊喜的感觉！</p>
<p>这大概就是进步的特征吧！哈哈！这次写demo+写博客花费了不少时间，倒也收获颇多，尤其在我将8种</p>
<p>排序都实现之前，没进行过一次测试，全部实现完成后，测试时各种索引越界+无限循环+各种问题，没几个</p>
<p>能跑通的，到后来的几乎都没有问题，也算是锻炼了思维，找出错原因的能力。本篇是自我学习的一个总结，</p>
<p>要学习及锻炼的园友，还望一定自己实现一下，可以和我的比较一下，解除疑惑或者提出改进。</p>
<h4 id="主要参考：维基百科，有趣的演示"><a href="#主要参考：维基百科，有趣的演示" class="headerlink" title="主要参考：维基百科，有趣的演示"></a>主要参考：<a target="_blank" rel="noopener" href="http://zh.wikipedia.org/wiki/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95">维基百科</a>，<a target="_blank" rel="noopener" href="http://www.cs.usfca.edu/~galles/visualization/Algorithms.html">有趣的演示</a></h4><h4 id="Demo源码"><a href="#Demo源码" class="headerlink" title="Demo源码"></a><a target="_blank" rel="noopener" href="https://files.cnblogs.com/fatbird/SortAlgorithmDemo.zip">Demo源码</a></h4><p>PS:我打算三月份去广州发展，主要会Asp.net mvc+jquery（不介意学习新的技术[除了webform]及语言[除了java]）。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chengming0916.github.io/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/CSharp%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E5%B0%8F%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Chemmy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/CSharp%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E5%B0%8F%E7%BB%93/" class="post-title-link" itemprop="url">CSharp排序算法小结</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-11-30 00:01:26" itemprop="dateCreated datePublished" datetime="2019-11-30T00:01:26+08:00">2019-11-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-04 16:58:11" itemprop="dateModified" datetime="2025-12-04T16:58:11+08:00">2025-12-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">排序算法</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><strong>前言</strong></p>
<p>算法这个东西其实在开发中很少用到，特别是web开发中，但是算法也很重要，因为任何的程序，任何的软件，都是由很多的算法和数据结构组成的。但是这不意味着算法对于每个软件设计人员的实际工作都是很重要的。每个项目特点和需求特殊也导致算法运用场景上不同。但是个人觉得算法运用的好的话会给自己在程序设计的时候提供比较好的思路。下面就对一些排序算法小结一下，就当做自己的一个笔记吧。</p>
<p><strong>插入排序</strong></p>
<p> <strong>1.简介</strong></p>
<p>插入排序（Insertion Sort）的算法描述是一种简单直观的排序算法。它的工作原理是通过构建有序序列，对于未排序数据，在已排序序列中从后向前扫描，找到相应位置并插入。插入排序在实现上，通常采用in-place排序（即只需用到O(1)的额外空间的排序），因而在从后向前扫描过程中，需要反复把已排序元素逐步向后挪位，为最新元素提供插入空间。</p>
<p><strong>2.算法描述</strong></p>
<p>一般来说，插入排序都采用in-place在数组上实现。具体算法描述如下：<br>1.从第一个元素开始，该元素可以认为已经被排序<br>2.取出下一个元素，在已经排序的元素序列中从后向前扫描<br>3.如果该元素（已排序）大于新元素，将该元素移到下一位置<br>4.重复步骤3，直到找到已排序的元素小于或者等于新元素的位置<br>5.将新元素插入到该位置后<br>6.重复步骤2~5<br>如果比较操作的代价比交换操作大的话，可以采用二分查找法来减少比较操作的数目。该算法可以认为是插入排序的一个变种，称为二分查找排序。</p>
<p><strong>3.使用插入排序为一列数字进行排序的过程</strong> </p>
<p><img src="https://images0.cnblogs.com/blog/373130/201402/181030498429191.gif"></p>
<p><img src="https://images0.cnblogs.com/blog/373130/201402/181031003601771.gif"></p>
<p><strong>最差时间复杂度 <img src="http://upload.wikimedia.org/math/c/d/6/cd641c6cabc83e0f7ff510bf812feca1.png" alt="O(n^{2})"></strong> </p>
<p>最优时间复杂度 <img src="http://upload.wikimedia.org/math/7/b/a/7ba55e7c64a9405a0b39a1107e90ca94.png" alt="O(n)"></p>
<p>平均时间复杂度<img src="http://upload.wikimedia.org/math/c/d/6/cd641c6cabc83e0f7ff510bf812feca1.png" alt="O(n^{2})"></p>
<p><strong>4.C#实现</strong></p>
<p><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></p>
<pre><code>    /// &lt;summary&gt;
    /// 插入排序 /// &lt;/summary&gt;
    public class InsertionSorter
    &#123; public void Sort(int\[\] list)
        &#123; for (int i = 1; i &lt; list.Length; ++i)
            &#123; int t = list\[i\]; int j = i; while ((j &gt; 0) &amp;&amp; (list\[j - 1\] &gt; t))
                &#123;
                    list\[j\] \= list\[j - 1\]; \--j;
                &#125;
                list\[j\] \= t;
            &#125;

        &#125;
    &#125;
</code></pre>
<p><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></p>
<p>数组</p>
<p>int[] iArrary &#x3D; new int[] { 1, 5, 3, 6, 10, 55, 9, 2, 87, 12, 34, 75, 33, 47 };</p>
<p><strong>希尔排序</strong></p>
<p> <strong>1.简介</strong></p>
<p>希尔排序，也称递减增量排序算法，是插入排序的一种更高效的改进版本。希尔排序是非稳定排序算法。</p>
<p><strong>2.算法实现</strong></p>
<p>原始的算法实现在最坏的情况下需要进行O(n2)的比较和交换。V. Pratt的书[1] 对算法进行了少量修改，可以使得性能提升至O(n log2 n)。这比最好的比较算法的O(n log n)要差一些。<br>希尔排序通过将比较的全部元素分为几个区域来提升插入排序的性能。这样可以让一个元素可以一次性地朝最终位置前进一大步。然后算法再取越来越小的步长进行排序，算法的最后一步就是普通的插入排序，但是到了这步，需排序的数据几乎是已排好的了（此时插入排序较快）。<br>假设有一个很小的数据在一个已按升序排好序的数组的末端。如果用复杂度为O(n2)的排序（冒泡排序或插入排序），可能会进行n次的比较和交换才能将该数据移至正确位置。而希尔排序会用较大的步长移动数据，所以小数据只需进行少数比较和交换即可到正确位置。<br>一个更好理解的希尔排序实现：将数组列在一个表中并对列排序（用插入排序）。重复这过程，不过每次用更长的列来进行。最后整个表就只有一列了。将数组转换至表是为了更好地理解这算法，算法本身仅仅对原数组进行排序（通过增加索引的步长，例如是用i +&#x3D; step_size而不是i++）。</p>
<p><strong>3.排序过程</strong></p>
<p><img src="https://images0.cnblogs.com/blog/373130/201402/181058308243697.gif"></p>
<p>最差时间复杂度 根据步长串行的不同而不同。<img src="http://upload.wikimedia.org/math/2/0/0/20062c989c6b1067c07dfdeb30efbfb7.png" alt="O(n\log^2 n)"></p>
<p>最优时间复杂度 O(<em>n</em>)</p>
<p>平均时间复杂度  根据步长串行的不同而不同。</p>
<p><strong>4.C#实现</strong></p>
<p><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></p>
<pre><code>    /// &lt;summary&gt;
    /// 希尔排序 /// &lt;/summary&gt;
    public class ShellSorter
    &#123; public void Sort(int\[\] list)
        &#123; int inc; for (inc = 1; inc &lt;= list.Length / 9; inc = 3 \* inc + 1) ; for (; inc &gt; 0; inc /= 3)
            &#123; for (int i = inc + 1; i &lt;= list.Length; i += inc)
                &#123; int t = list\[i - 1\]; int j = i; while ((j &gt; inc) &amp;&amp; (list\[j - inc - 1\] &gt; t))
                    &#123;
                        list\[j \- 1\] = list\[j - inc - 1\];
                        j \-= inc;
                    &#125;
                    list\[j \- 1\] = t;
                &#125;
            &#125;
        &#125;
    &#125;
</code></pre>
<p><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></p>
<p><strong>选择排序</strong></p>
<p> 1.简介</p>
<p>选择排序(Selection sort)是一种简单直观的排序算法。它的工作原理如下。首先在未排序序列中找到最小（大）元素，存放到排序序列的起始位置，然后，再从剩余未排序元素中继续寻找最小（大）元素，然后放到已排序序列的末尾。以此类推，直到所有元素均排序完毕。<br>选择排序的主要优点与数据移动有关。如果某个元素位于正确的最终位置上，则它不会被移动。选择排序每次交换一对元素，它们当中至少有一个将被移到其最终位置上，因此对n个元素的表进行排序总共进行至多n-1次交换。在所有的完全依靠交换去移动元素的排序方法中，选择排序属于非常好的一种。</p>
<p>2.实现过程</p>
<p><img src="https://images0.cnblogs.com/blog/373130/201402/181110130383862.gif"></p>
<p>最差时间复杂度 <em>О(n²)</em></p>
<p><em>最优时间复杂度 <em>О(n²)</em></em></p>
<p>平均时间复杂度 <em>О(n²)</em></p>
<p><strong>3.C#实现</strong></p>
<p><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></p>
<pre><code>    /// &lt;summary&gt;
    /// 选择排序 /// &lt;/summary&gt;
    public class SelectionSorter
    &#123; // public enum comp &#123;COMP\_LESS,COMP\_EQUAL,COMP\_GRTR&#125;;
        private int min; // private int m=0;
        public void Sort(int\[\] list)
        &#123; for (int i = 0; i &lt; list.Length - 1; ++i)
            &#123;
                min \= i; for (int j = i + 1; j &lt; list.Length; ++j)
                &#123; if (list\[j\] &lt; list\[min\])
                        min \= j;
                &#125; int t = list\[min\];
                list\[min\] \= list\[i\];
                list\[i\] \= t; // Console.WriteLine(&quot;&#123;0&#125;&quot;,list\[i\]);
</code></pre>
<p> }</p>
<pre><code>        &#125;
    &#125;
</code></pre>
<p><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></p>
<p><strong>冒泡排序</strong></p>
<p> <strong>1.简介</strong></p>
<p>冒泡排序（Bubble Sort，台湾译为：泡沫排序或气泡排序）是一种简单的排序算法。它重复地走访过要排序的数列，一次比较两个元素，如果他们的顺序错误就把他们交换过来。走访数列的工作是重复地进行直到没有再需要交换，也就是说该数列已经排序完成。这个算法的名字由来是因为越小的元素会经由交换慢慢“浮”到数列的顶端。<br>冒泡排序对n个项目需要O(n^{2})的比较次数，且可以原地排序。尽管这个算法是最简单了解和实作的排序算法之一，但它对于少数元素之外的数列排序是很没有效率的。<br>冒泡排序是与插入排序拥有相等的执行时间，但是两种法在需要的交换次数却很大地不同。在最坏的情况，冒泡排序需要O(n^{2})次交换，而插入排序只要最多O(n)交换。冒泡排序的实现（类似下面）通常会对已经排序好的数列拙劣地执行（O(n^{2})），而插入排序在这个例子只需要O(n)个运算。因此很多现代的算法教科书避免使用冒泡排序，而用插入排序取代之。冒泡排序如果能在内部循环第一次执行时，使用一个旗标来表示有无需要交换的可能，也有可能把最好的复杂度降低到O(n)。在这个情况，在已经排序好的数列就无交换的需要。若在每次走访数列时，把走访顺序和比较大小反过来，也可以稍微地改进效率。有时候称为往返排序，因为算法会从数列的一端到另一端之间穿梭往返。</p>
<p><strong>2.算法实现</strong><br>1.比较相邻的元素。如果第一个比第二个大，就交换他们两个。<br>2.对每一对相邻元素作同样的工作，从开始第一对到结尾的最后一对。在这一点，最后的元素应该会是最大的数。<br>3.针对所有的元素重复以上的步骤，除了最后一个。<br>4.持续每次对越来越少的元素重复上面的步骤，直到没有任何一对数字需要比较。 </p>
<p><strong>3.实现过程</strong></p>
<p><img src="https://images0.cnblogs.com/blog/373130/201402/181136161673239.gif"></p>
<p>最差时间复杂度 <img src="http://upload.wikimedia.org/math/c/d/6/cd641c6cabc83e0f7ff510bf812feca1.png" alt="O(n^{2})"></p>
<p>最优时间复杂度 <img src="http://upload.wikimedia.org/math/7/b/a/7ba55e7c64a9405a0b39a1107e90ca94.png" alt="O(n)"></p>
<p>平均时间复杂度 <img src="http://upload.wikimedia.org/math/c/d/6/cd641c6cabc83e0f7ff510bf812feca1.png" alt="O(n^{2})"></p>
<p><strong>4.C#实现</strong></p>
<p><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></p>
<pre><code>   /// &lt;summary&gt;
    /// 冒泡排序 /// &lt;/summary&gt;
    public class bubblesort
    &#123; public void BubbleSort(int\[\] R)
        &#123; int i, j, temp; //交换标志 
            bool exchange; for (i = 0; i &lt; R.Length; i++) //最多做R.Length-1趟排序 
</code></pre>
<p> {<br>                    exchange = false; &#x2F;&#x2F;本趟排序开始前，交换标志应为假<br>                    for (j &#x3D; R.Length - 2; j &gt;&#x3D; i; j–)<br>                    { if (R[j + 1] &lt; R[j])　&#x2F;&#x2F;交换条件<br> {<br>                            temp = R[j + 1];<br>                            R[j + 1] &#x3D; R[j];<br>                            R[j] = temp;<br>                            exchange = true; &#x2F;&#x2F;发生了交换，故将交换标志置为真<br> }<br>                    } if (!exchange) &#x2F;&#x2F;本趟排序未发生交换，提前终止算法<br> { break;<br>                    }<br>                }<br>            }<br>        }</p>
<p><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://chengming0916.github.io/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%B3%BB%E5%88%97%E5%AF%BC%E8%88%AA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Chemmy">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Chemmy's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/11/30/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%B3%BB%E5%88%97%E5%AF%BC%E8%88%AA/" class="post-title-link" itemprop="url">设计模式系列导航</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-11-30 00:00:43" itemprop="dateCreated datePublished" datetime="2019-11-30T00:00:43+08:00">2019-11-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-04 16:58:11" itemprop="dateModified" datetime="2025-12-04T16:58:11+08:00">2025-12-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">设计模式</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <a href="/2019/11/01/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/" title="面向对象的设计原则">面向对象的设计原则</a>
<h3 id="创建型"><a href="#创建型" class="headerlink" title="创建型"></a>创建型</h3><p>创建型模式抽象了实例化的过程。创建性模式隐藏了这些类的实例是如何被创建和放在一起，整个系统关于这些对象所知道的是由抽象类所定义的接口。这样，创建性模式在创建了什么、谁创建它、她是怎么被创建的、以及何时创建方面提供了灵活性。创建相应数目的原型并克隆她们通常比每次用适合的状态手工实例化该类更方便。</p>
<a href="/2015/11/02/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/" title="单例模式">单例模式</a> (Singleton) 保证一个类仅有一个实例，并提供一个访问它的全局访问点。

<p><strong>优点</strong>：对唯一实例的受控访问。</p>
<p><strong>缺点</strong>：饿汉式&#x2F;懒汉式  多线程同时访问时可能造成多个实例。</p>
<a href="/2019/11/03/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/" title="工厂方法模式">工厂方法模式</a> (Factory Method) 定义一个用于创建对象的接口，让子类决定实例化哪一个类，工厂方法使一个类的实例化延迟到其子类。

<p><strong>优点</strong>：是简单工厂模式的进一步抽象和推广，既保持了简单工厂模式的优点（工厂类中包含了必要的逻辑判断，根据客户端的选择条件动态实例化相关的类。对于客户端来说，去除了与具体产品的依赖），而且克服了简单工厂的缺点（违背了开放封闭原则）。</p>
<p><strong>缺点</strong>：每增加一个产品，就需要增加一个产品工厂的类，增加了额外的开发。（用反射可以解决）。</p>
<a href="/2019/11/04/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/" title="抽象工厂模式">抽象工厂模式</a> (Abstract Factory) 提供一个创建一系列相关或互相依赖对象的接口，而无需指定它们具体的类。

<p><strong>优点</strong>：</p>
<p>a)   改变具体工厂即可使用不同的产品配置，使改变一个应用的具体工厂变得很容易。</p>
<p>b)   让具体的创建实例过程与客户端分离，客户端通过抽象接口操作实例，产品的具体类名也被具体工厂的实现分离。</p>
<p><strong>缺点</strong>：如果要新增方法，改动极大。</p>
<a href="/2019/11/05/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F/" title="建造者模式">建造者模式</a> (Builder) 将一个复杂对象的构建与它的表示分离，使得同样的构建过程可以创建不同的表示。

<p><strong>优点</strong>：使得建造代码与表示代码分离。</p>
<p><strong>缺点</strong>：1、增加代码量；2、Builder只是一个替代构造器的选择，不能直接用于降低非构造函数方法的参数数量。</p>
<a href="/2019/11/06/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/" title="原型模式">原型模式</a> (Prototype) 用原型实例指定创建对象的种类，并且通过拷贝这些原型创建新的对象。

<p><strong>优点</strong>：隐藏了对象创建的细节，大大提升了性能。不用重新初始化对象，而是动态的获得对象运行时的状态。</p>
<p><strong>缺点</strong>：深复制 or 浅复制 。</p>
<h3 id="结构型"><a href="#结构型" class="headerlink" title="结构型"></a>结构型</h3><a href="/2019/11/07/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/" title="适配器模式">适配器模式</a> (Adapter) 将一个类的接口转换成客户希望的另外一个接口。Adapter模式使得原本由于接口不兼容而不能一起工作的那些类可以一起工作。

<p>在GoF的设计模式中，适配器有两种类型，类适配器模式和对象适配器模式。</p>
<p>a)   类适配器模式：通过多重继承对一个接口与另一个接口进行匹配，而C#，Java等语言都不支持多重继承，也就是一个类只有一个父类。</p>
<p>b)   一般都指的是 对象适配器模式</p>
<p><strong>优点</strong>：能够复用现存的类，客户端统一调用同一接口，更简单、直接、紧凑。</p>
<p><strong>缺点</strong>：适配器模式有点儿“亡羊补牢”的感觉，设计阶段要避免使用。</p>
<a href="/2019/11/08/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/" title="桥接模式">桥接模式</a> (Bridge) 将抽象部分与它的实现部分分离，使它们都可以独立的变化。

<p><strong>优点</strong>：减少各部分的耦合。 分离抽象和实现部分，更好的扩展性，可动态地切换实现、可减少子类的个数。</p>
<p><strong>缺点</strong>：1、<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E6%A1%A5%E6%8E%A5&spm=1001.2101.3001.7020">桥接</a>模式的引入会增加系统的理解与设计难度，由于聚合关联关系建立在抽象层，要求开发者针对抽象进行设计与编程。 2、桥接模式要求正确识别出系统中两个独立变化的维度，因此其使用范围具有一定的局限性</p>
<a href="/2019/11/09/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F/" title="装饰模式">装饰模式</a> (Decorator) 动态地给一个对象添加一些额外的职责，就增加功能来说，装饰模式比生成子类更灵活。

<p><strong>优点</strong>：把类中的装饰功能从类中搬移出去，简化原有的类。有效的把类的核心职责和装饰功能区分开，去除相关类中重复的装饰逻辑。</p>
<p><strong>缺点</strong>：利用装饰器模式,常常造成设计中有大量的小类,数量实在太多,可能会造成使用此API程序员的困扰。</p>
<a href="/2019/11/10/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F/" title="组合模式">组合模式</a> (Composite) 将对象组合成树形结构以表示“部分-整体”的层次结构。

<p><strong>优点</strong>：组合模式让客户可以一致的使用组合结构和单个对象。</p>
<p><strong>缺点</strong>：使设计变得更加抽象，对象的业务规则如果很复杂，则实现组合模式具有很大挑战性，而且不是所有的方法都与叶子对象子类都有关联。</p>
<a href="/2019/11/11/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F/" title="外观模式">外观模式</a> (Facade) 为子系统中的一组接口提供一个一致的界面，此模式定义了一个高层接口，这个接口使得这一子系统更加容易使用。

<p><strong>优点</strong>：1、客户对子系统的使用变得简单了，减少了与子系统的关联对象，实现了子系统与客户之间的松耦合关系。 2、只是提供了一个访问子系统的统一入口，并不影响用户直接使用子系统类 3、降低了大型软件系统中的编译依赖性，并简化了系统在不同平台之间的移植过程。</p>
<p><strong>缺点</strong>：1、不能很好地限制客户使用子系统类，如果对客户访问子系统类做太多的限制则减少了可变性和灵活性   2、在不引入抽象外观类的情况下，增加新的子系统可能需要修改外观类或客户端的源代码，违背了“开闭原则”。</p>
<a href="/2019/11/12/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F/" title="享元模式">享元模式</a> (Flyweight) 运用共享技术有效的支持大量细粒度的对象。

<p><strong>优点</strong>：享元模式可以避免大量非常相似类的开销。程序中，大量细粒度的类实例来表示数据，如果它们除了几个参数外基本相同，那么把它们转移到类实例的外面，在方法调用时将它们传递进来，就可以通过共享大幅度减少单个实例的数目。</p>
<p><strong>缺点</strong>：1、由于享元模式需要区分外部状态和内部状态，使得应用程序在某种程度上来说更加复杂化了。2、为了使对象可以共享，享元模式需要将享元对象的状态外部化，而读取外部状态使得运行时间变长。</p>
<a href="/2019/11/13/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/" title="代理模式">代理模式</a> (Proxy) 为其他对象提供一种代理以控制对这个对象的访问。

<p><strong>优点</strong>：1）代理模式能将代理对象与真正被调用的对象分离，在一定程度上降低了系统的耦合度。2）代理模式在客户端和目标对象之间起到一个中介作用，这样可以起到保护目标对象的作用。代理对象也可以对目标对象调用之前进行其他操作。</p>
<p><strong>缺点</strong>：1）在客户端和目标对象增加一个代理对象，会造成请求处理速度变慢。2）增加了系统的复杂度。</p>
<h3 id="行为型"><a href="#行为型" class="headerlink" title="行为型"></a>行为型</h3><a href="/2019/11/14/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95/" title="模板方法">模板方法</a> (Template Method)  定义一个操作中的算法的骨架，而将一些步骤延迟到子类中。

<p><strong>优点</strong>：模板方法模式是通过把不变行为搬移到超类，去除子类中重复代码来实现它的优势，提供了一个代码复用平台，帮助子类摆脱重复的不变行为的纠缠。</p>
<p><strong>缺点</strong>：如果父类中可变的基本方法太多,将会导致类的个数增加,系统更加庞大。</p>
<a href="/2019/11/15/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/" title="命令模式">命令模式</a> (Command) 将一个请求封装为一个对象，从而使你可用不同的请求对客户进行参数化；对请求排队或记录请求日志，以及支持可撤销的操作。
<p><strong>优点</strong>：</p>
<p>a)      命令模式把请求一个操作的对象与知道怎么执行一个操作的对象分割开。</p>
<p>b)      它能较容易的设计一个命令队列。</p>
<p>c)       在需要的情况下，可以较容易的将命令记入日志。</p>
<p>d)      允许接收请求的一方决定是否要否决请求。</p>
<p>e)      可以容易的实现对请求的撤销和重做。</p>
<p>f)        由于加进新的具体命令类不影响其他类，因此增加新的具体命令类很容易。</p>
<p><strong>缺点</strong>：会增加系统的复杂性，这里的复杂性应该主要指的是类的数量。</p>
<a href="/2019/11/16/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F/" title="迭代器模式">迭代器模式</a> (Iterator) 提供一种方法顺序访问一个聚合对象中各个元素，而又不暴露该对象的内部表示。

<p><strong>优点</strong>：迭代器模式就是分离了集合对象的遍历行为，抽象出一个迭代器来负责，这样既可以做到不暴露集合的内部结构，又可以让外部代码透明的访问集合内部的数据。</p>
<p><strong>缺点</strong>：由于迭代器模式将存储数据和遍历数据的职责分离，增加新的聚合类需要对应增加新的迭代器类，类的个数成对增加，这在一定程度上增加了系统的复杂性。</p>
<a href="/2019/11/17/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/" title="观察者模式">观察者模式</a> (Publish/Subscribe) 定义了一种一对多的依赖关系，让多个观察者对象同时监听某一个主题对象。这个主题对象在状态发生变化时，会通知所有观察者对象，让它们能够自动更新自己。

<p><strong>优点</strong>：解耦。</p>
<p><strong>缺点</strong>：如果在被观察者之间有循环依赖的话，被观察者会触发它们之间进行循环调用，导致系统崩溃。在使用观察者模式是要特别注意这一点。</p>
<a href="/2019/11/18/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F/" title="中介者模式">中介者模式</a> (mediator) 用一个中介对象来封装一系列的对象交互。中介者使各对象不需要显示的相互引用，从而使其耦合松散，而且可以独立的改变它们之间的交互。

<p><strong>优点</strong>：</p>
<p>a)   抽象中介者类（Mediator）减少了抽象同事类（colleague）之间的耦合，是的可以独立的改变和复用各个类。</p>
<p>b)   由于把对象如何协作进行了抽象，将中介作为一个独立的概念并将其封装在一个对象中，这样关注的对象就从对象各自本身的行为转移到它们之间的交互上来，也就是站在一个更宏观的角度去看待系统。</p>
<p><strong>缺点</strong>：控制集中化导致了中介者的复杂化。</p>
<a href="/2019/11/19/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F/" title="状态模式">状态模式</a> (State)  当一个对象的内在状态改变时，允许改变其行为，这个对象看起来像是改变了其类。

<p><strong>优点</strong>：状态模式主要解决的是当控制一个对象状态转换的条件表达式过于复杂的情况。把状态的判断逻辑转移到表示不同状态的一系列类当中，可以把复杂的判断逻辑简化。【消除庞大的条件分支语句】。</p>
<p><strong>缺点</strong>：违背开放-封闭原则</p>
<a href="/2019/11/20/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/" title="策略模式">策略模式</a> (strategy) 它定义了算法家族，分别封装起来，让它们之间可以互相替换，此模式让算法的变化不会影响到使用算法的用户。

<p><strong>优点</strong>：策略模式的策略类为上下文定义了一系列可供重用的算法或行为，继承有助于析取出这些算法中的公共功能。另外，策略模式简化了单元测试，因为每一个算法都有自己的类，可以通过自己的接口单独测试。当不同的行为堆砌在一个类中，很难避免使用switch语句。但是将这些行为封装在一个一个独立的策略类中，可以在使用这些行为的类中消除条件语句</p>
<p><strong>缺点</strong>：基本的策略模式，选择权在客户端，具体实现转给策略模式的上下文对象。这并不好。使用策略模式和工厂类结合，可以减轻客户端的职责。但是还是不够完美，使用反射才能真正快乐。</p>
<a href="/2019/11/21/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F/" title="责任链模式">责任链模式</a> (chain of responsibility) 使多个对象都有机会处理请求，从而避免请求的发送者和接受者之间的耦合关系。将这个对象连成一条链，并沿着这条链传递该请求，直到有一个对象处理它为止。

<p><strong>优点</strong>：使得接收者和发送者都没有对方的明确信息，且链中对象自己也不知道链结构，结果是职责链可以简化对象的相互连接，它们只需要保持一个指向其后继者的引用，而不需要保持它所有的候选接收者的引用。<strong>开发者可以随时的增加或者修改处理一个请求的结构，增强了给对象指派职责的灵活性</strong>。</p>
<p><strong>缺点</strong>：一个请求极有可能到了链的末端都得不到处理，或者因为没有正确配置而得不到处理。</p>
<a href="/2019/11/22/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F/" title="访问者模式">访问者模式</a> (Vistor) 表示一个作用于某对象结构中的各元素的操作，它使你可以在不改变各元素的类的前提下定义作用于这些元素的新操作。

<p><strong>优点</strong>：增加新的操作很容易。新的操作就是新的访问者。</p>
<p><strong>缺点</strong>：很难增加新的数据结构。</p>
<a href="/2019/11/23/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F/" title="备忘录模式">备忘录模式</a> (Memento) 在不破坏封装性的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态，这样以后就可将该对象恢复到原先保存的状态。

<p><strong>优点</strong>：使用备忘录模式可以把复杂的发起人内部信息对其他的对象屏蔽起来，从而可以恰当地保持封装的边界。</p>
<p><strong>缺点</strong>：如果发起人角色的状态需要完整地存储到备忘录对象中，那么在资源消耗上面备忘录对象会很昂贵。</p>
<a href="/2019/11/24/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A7%A3%E9%87%8A%E5%99%A8%E6%A8%A1%E5%BC%8F/" title="解释器模式">解释器模式</a> (interpreter) 给定一个语言，定义它的文法的一种表示，并定义一个解释器，这个解释器使用该表示来解释语言中的句子。

<p><strong>优点</strong>：解释器很容易改变和扩展文法，因为该模式使用类来表示文法规则，可以使用继承来改变或扩展文法，也比较容易实现文法。因为定义抽象语法树中各个节点的类的实现大体类似，这些类都易于直接编写。</p>
<p><strong>缺点</strong>：解释器模式为文法中的每一条规则至少定义了一个类，因此包含许多规则的文法可能难以管理和维护，建议当文法非常复杂时，使用其他技术（语法分析程序、编译器生成器）。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="上一页" aria-label="上一页" href="/page/10/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><span class="page-number current">11</span><a class="page-number" href="/page/12/">12</a><span class="space">&hellip;</span><a class="page-number" href="/page/20/">20</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="/page/12/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2015 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Chemmy</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>
<script class="next-config" data-name="giscus" type="application/json">{"enable":true,"repo":"chengming0916/chengming0916.github.io","repo_id":"R_kgDOLemcag","category":"Announcements","category_id":"DIC_kwDOLemcas4CupMn","mapping":"title","strict":0,"reactions_enabled":1,"emit_metadata":1,"theme":"light","lang":"zh-CN","crossorigin":"anonymous","input_position":"bottom","loading":"lazy"}</script>

<script>
document.addEventListener('page:loaded', () => {
  if (!CONFIG.page.comments) return;

  NexT.utils.loadComments('.giscus-container')
    .then(() => NexT.utils.getScript('https://giscus.app/client.js', {
      attributes: {
        async                   : true,
        crossOrigin             : 'anonymous',
        'data-repo'             : CONFIG.giscus.repo,
        'data-repo-id'          : CONFIG.giscus.repo_id,
        'data-category'         : CONFIG.giscus.category,
        'data-category-id'      : CONFIG.giscus.category_id,
        'data-mapping'          : CONFIG.giscus.mapping,
        'data-strict'           : CONFIG.giscus.strict,
        'data-reactions-enabled': CONFIG.giscus.reactions_enabled,
        'data-emit-metadata'    : CONFIG.giscus.emit_metadata,
        'data-theme'            : CONFIG.giscus.theme,
        'data-lang'             : CONFIG.giscus.lang,
        'data-input-position'   : CONFIG.giscus.input_position,
        'data-loading'          : CONFIG.giscus.loading
      },
      parentNode: document.querySelector('.giscus-container')
    }));
});
</script>

</body>
</html>
